<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>forms.zig - source view</title>
    <link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAPNJREFUeNpi/P//PwMlgOXHUjly9E0G4hwgZmQiQZMqEK8H4v9QzUEgQSaoADK+zhH9iAGL+C0gDoAaNg9mGLoLfgA1awK9hS9gzgJxA9RQBmQDrgMxJzRMGKE4HYj/Ial5A8QmQLwCJoBsgBYW2+TR1ChDaWt4LOBxKsi/VUh8XiD+gq4IVyzwQAMJBoKwacZlAB8Qf0bi96IZhtOAe1D6LpqaEiz6rmEzQAeIzwGxCJpieFqApo/vQKyJboAaEBsAsSEupwI1MwKjGBTVHOhegMX5UajYRqiBjMgYmj400cVh0XgTiKdC0zhJgJHS7AwQYABm9EAdCKrEfAAAAABJRU5ErkJggg=="/>
    <style>
      body{
        font-family: system-ui, -apple-system, Roboto, "Segoe UI", sans-serif;
        margin: 0;
        line-height: 1.5;
      }

      pre > code {
        display: block;
        overflow: auto;
        line-height: normal;
        margin: 0em;
      }
      .tok-kw {
          color: #333;
          font-weight: bold;
      }
      .tok-str {
          color: #d14;
      }
      .tok-builtin {
          color: #005C7A;
      }
      .tok-comment {
          color: #545454;
          font-style: italic;
      }
      .tok-fn {
          color: #900;
          font-weight: bold;
      }
      .tok-null {
          color: #005C5C;
      }
      .tok-number {
          color: #005C5C;
      }
      .tok-type {
          color: #458;
          font-weight: bold;
      }
      pre {
        counter-reset: line;
      }
      pre .line:before {
        counter-increment: line;
        content: counter(line);
        display: inline-block;
        padding-right: 1em;
        width: 2em;
        text-align: right;
        color: #999;
      }
      
      .line {
        width: 100%;
        display: inline-block;
      }
      .line:target {
        border-top: 1px solid #ccc;
        border-bottom: 1px solid #ccc;
        background: #fafafa;
      }

      @media (prefers-color-scheme: dark) {
        body{
            background:#222;
            color: #ccc;
        }
        pre > code {
            color: #ccc;
            background: #222;
            border: unset;
        }
        .line:target {
            border-top: 1px solid #444;
            border-bottom: 1px solid #444;
            background: #333;
        }
        .tok-kw {
            color: #eee;
        }
        .tok-str {
            color: #2e5;
        }
        .tok-builtin {
            color: #ff894c;
        }
        .tok-comment {
            color: #aa7;
        }
        .tok-fn {
            color: #B1A0F8;
        }
        .tok-null {
            color: #ff8080;
        }
        .tok-number {
            color: #ff8080;
        }
        .tok-type {
            color: #68f;
        }
      }
    </style>
</head>
<body>
<pre><code><span class="line" id="L1"><span class="tok-kw">const</span> std = <span class="tok-builtin">@import</span>(<span class="tok-str">&quot;std&quot;</span>);</span>
<span class="line" id="L2"><span class="tok-kw">const</span> utf = <span class="tok-builtin">@import</span>(<span class="tok-str">&quot;std&quot;</span>).unicode;</span>
<span class="line" id="L3"></span>
<span class="line" id="L4"><span class="tok-kw">const</span> dds = <span class="tok-builtin">@import</span>(<span class="tok-str">&quot;dds&quot;</span>);</span>
<span class="line" id="L5"><span class="tok-kw">const</span> kbd = <span class="tok-builtin">@import</span>(<span class="tok-str">&quot;cursed&quot;</span>).kbd;</span>
<span class="line" id="L6"><span class="tok-kw">const</span> term= <span class="tok-builtin">@import</span>(<span class="tok-str">&quot;cursed&quot;</span>);</span>
<span class="line" id="L7"><span class="tok-kw">const</span> utl = <span class="tok-builtin">@import</span>(<span class="tok-str">&quot;utils&quot;</span>);</span>
<span class="line" id="L8"><span class="tok-kw">const</span> reg = <span class="tok-builtin">@import</span>(<span class="tok-str">&quot;match&quot;</span>);</span>
<span class="line" id="L9"></span>
<span class="line" id="L10"><span class="tok-kw">const</span> os = std.os;</span>
<span class="line" id="L11"><span class="tok-kw">const</span> io = std.io;</span>
<span class="line" id="L12"></span>
<span class="line" id="L13"><span class="tok-comment">///-------------------------------</span></span>
<span class="line" id="L14"><span class="tok-comment">/// FORMS</span></span>
<span class="line" id="L15"><span class="tok-comment">///-------------------------------</span></span>
<span class="line" id="L16"></span>
<span class="line" id="L17"></span>
<span class="line" id="L18"></span>
<span class="line" id="L19"><span class="tok-comment">// function special for developpeur</span>
</span>
<span class="line" id="L20"><span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">debeug</span>(vline : <span class="tok-type">usize</span>, buf: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>) <span class="tok-type">void</span> {</span>
<span class="line" id="L21">  </span>
<span class="line" id="L22">  <span class="tok-kw">const</span> AtrDebug : dds.ZONATRB = .{</span>
<span class="line" id="L23">      .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L24">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L25">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L26">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L27">      .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L28">      .foregr = dds.ForegroundColor.fgYellow</span>
<span class="line" id="L29">  };</span>
<span class="line" id="L30"></span>
<span class="line" id="L31">  term.getCursor();</span>
<span class="line" id="L32">  <span class="tok-kw">var</span> Xterm = term.getSize();</span>
<span class="line" id="L33">  term.gotoXY(Xterm.height,<span class="tok-number">1</span>) ;</span>
<span class="line" id="L34">  <span class="tok-kw">const</span> allocator = std.heap.page_allocator;</span>
<span class="line" id="L35">  <span class="tok-kw">var</span> msg =std.fmt.allocPrint(allocator,<span class="tok-str">&quot;linsrc:{d}  {s} &quot;</span>,.{vline, buf}) </span>
<span class="line" id="L36">                  <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L37">  term.writeStyled(msg,AtrDebug);</span>
<span class="line" id="L38">  _=term.kbd.getKEY();</span>
<span class="line" id="L39">  term.gotoXY(term.posCurs.x,term.posCurs.y);</span>
<span class="line" id="L40">  allocator.free(msg);</span>
<span class="line" id="L41">            </span>
<span class="line" id="L42">}</span>
<span class="line" id="L43"></span>
<span class="line" id="L44"></span>
<span class="line" id="L45">  </span>
<span class="line" id="L46"></span>
<span class="line" id="L47"></span>
<span class="line" id="L48"></span>
<span class="line" id="L49"><span class="tok-comment">/// Errors that may occur when using String</span></span>
<span class="line" id="L50"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> ErrForms = <span class="tok-kw">error</span>{</span>
<span class="line" id="L51"></span>
<span class="line" id="L52">        lbl_getIndex_Name_Label_Invalide,</span>
<span class="line" id="L53">        lbl_getName_Index_invalide,</span>
<span class="line" id="L54">        lbl_getPosx_Index_invalide,</span>
<span class="line" id="L55">        lbl_getPosy_Index_invalide,</span>
<span class="line" id="L56">        lbl_getText_Index_invalide,</span>
<span class="line" id="L57">        lbl_getActif_Index_invalide,</span>
<span class="line" id="L58"></span>
<span class="line" id="L59">        lbl_setText_Index_invalide,</span>
<span class="line" id="L60">        lbl_setActif_Index_invalide,</span>
<span class="line" id="L61">        lbl_updateText_Index_invalide,</span>
<span class="line" id="L62"></span>
<span class="line" id="L63">        lbl_dltRows_Index_invalide,</span>
<span class="line" id="L64"></span>
<span class="line" id="L65">        btn_getIndex_Key_Button_Invalide,</span>
<span class="line" id="L66">        btn_getName_Index_invalide,</span>
<span class="line" id="L67">        btn_getKey_Index_invalide,</span>
<span class="line" id="L68">        btn_getShow_Index_invalide,</span>
<span class="line" id="L69">        btn_getText_Index_invalide,</span>
<span class="line" id="L70">        btn_getCheck_Index_invalide,</span>
<span class="line" id="L71">        btn_getActif_Index_invalide,</span>
<span class="line" id="L72"></span>
<span class="line" id="L73">        btn_setShow_Index_invalide,</span>
<span class="line" id="L74">        btn_setText_Index_invalide,</span>
<span class="line" id="L75">        btn_setCheck_Index_invalide,  </span>
<span class="line" id="L76">        btn_setActif_Index_invalide,</span>
<span class="line" id="L77"></span>
<span class="line" id="L78"></span>
<span class="line" id="L79">        btn_dltRows_Index_invalide,</span>
<span class="line" id="L80"></span>
<span class="line" id="L81">        mnu_getIndex_Name_Menu_Invalide,</span>
<span class="line" id="L82">        mnu_getName_Index_invalide,</span>
<span class="line" id="L83">        mnu_getPosx_Index_invalide,</span>
<span class="line" id="L84">        mnu_getPosy_Index_invalide,</span>
<span class="line" id="L85">        mnu_getText_Index_invalide,</span>
<span class="line" id="L86">        mnu_getActif_Index_invalide,</span>
<span class="line" id="L87"></span>
<span class="line" id="L88">        mnu_dltRows_Index_invalide,</span>
<span class="line" id="L89"></span>
<span class="line" id="L90"></span>
<span class="line" id="L91">        fld_getIndex_Name_Field_Invalide,</span>
<span class="line" id="L92">        fld_getName_Index_invalide,</span>
<span class="line" id="L93">        fld_getPosx_Index_invalide,</span>
<span class="line" id="L94">        fld_getPosy_Index_invalide,</span>
<span class="line" id="L95">        fld_getRefType_Index_invalide,</span>
<span class="line" id="L96">        fld_getWidth_Index_invalide,</span>
<span class="line" id="L97">        fld_getScal_Index_invalide,</span>
<span class="line" id="L98">        fld_getNbrCar_Index_invalide,</span>
<span class="line" id="L99">        fld_getRequier_Index_invalide,</span>
<span class="line" id="L100">        fld_getProtect_Index_invalide,</span>
<span class="line" id="L101">        fld_getPading_Index_invalide,</span>
<span class="line" id="L102">        fld_getEdtcar_Index_invalide,</span>
<span class="line" id="L103">        fld_getRegex_Index_invalide,</span>
<span class="line" id="L104">        fld_getErrMsg_Index_invalide,</span>
<span class="line" id="L105">        fld_getHelp_Index_invalide,</span>
<span class="line" id="L106">        fld_getText_Index_invalide,</span>
<span class="line" id="L107">        fld_getSwitch_Index_invalide,</span>
<span class="line" id="L108">        fld_getErr_Index_invalide,</span>
<span class="line" id="L109">        fld_getFunc_Index_invalide,</span>
<span class="line" id="L110">        fld_getTask_Index_invalide,</span>
<span class="line" id="L111">        fld_getAttribut_Index_invalide,</span>
<span class="line" id="L112">        fld_getAtrProtect_Index_invalide,</span>
<span class="line" id="L113">        fld_getActif_Index_invalide,</span>
<span class="line" id="L114"></span>
<span class="line" id="L115">        fld_setText_Index_invalide,</span>
<span class="line" id="L116">        fld_setSwitch_Index_invalide,</span>
<span class="line" id="L117">        fld_setProtect_Index_invalide,</span>
<span class="line" id="L118">        fld_setEdtcar_Index_invalide,</span>
<span class="line" id="L119">        fld_setRegex_Index_invalide,</span>
<span class="line" id="L120">        fld_setActif_Index_invalide,</span>
<span class="line" id="L121"></span>
<span class="line" id="L122">        fld_dltRows_Index_invalide,</span>
<span class="line" id="L123"></span>
<span class="line" id="L124">        Invalide_subStr_Index,</span>
<span class="line" id="L125"></span>
<span class="line" id="L126">        char_not_digital,</span>
<span class="line" id="L127">    };</span>
<span class="line" id="L128"></span>
<span class="line" id="L129"></span>
<span class="line" id="L130"><span class="tok-comment">// Shows serious programming errors</span>
</span>
<span class="line" id="L131"><span class="tok-kw">pub</span> <span class="tok-kw">const</span>  dsperr = <span class="tok-kw">struct</span> {    </span>
<span class="line" id="L132">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">errorForms</span>(vpnl: *pnl.PANEL, errpgm :<span class="tok-type">anyerror</span> ) <span class="tok-type">void</span> { </span>
<span class="line" id="L133">    <span class="tok-comment">// define attribut default MSG Error</span>
</span>
<span class="line" id="L134">    <span class="tok-kw">const</span> MsgErr : dds.ZONATRB = .{</span>
<span class="line" id="L135">        .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.styleBlink),</span>
<span class="line" id="L136">                      <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L137">                      <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L138">                      <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L139">        .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L140">        .foregr = dds.ForegroundColor.fgYellow,</span>
<span class="line" id="L141">    };</span>
<span class="line" id="L142"></span>
<span class="line" id="L143">    <span class="tok-kw">const</span> allocator = std.heap.page_allocator;</span>
<span class="line" id="L144"></span>
<span class="line" id="L145">    <span class="tok-kw">var</span> errTxt:[]<span class="tok-kw">const</span> <span class="tok-type">u8</span> = std.fmt.allocPrint(allocator,<span class="tok-str">&quot;To report: {any} &quot;</span>,.{errpgm }) </span>
<span class="line" id="L146">                                    <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L147">    <span class="tok-kw">defer</span> allocator.free(errTxt);</span>
<span class="line" id="L148">    </span>
<span class="line" id="L149"></span>
<span class="line" id="L150">    <span class="tok-kw">var</span> x: <span class="tok-type">usize</span>  = vpnl.lines;</span>
<span class="line" id="L151">    <span class="tok-kw">var</span> n: <span class="tok-type">usize</span>  = vpnl.cols * (x - <span class="tok-number">2</span>) ;</span>
<span class="line" id="L152">    <span class="tok-kw">var</span> y: <span class="tok-type">usize</span>  = <span class="tok-number">1</span> ;</span>
<span class="line" id="L153"></span>
<span class="line" id="L154">    <span class="tok-kw">var</span> msgerr:[]<span class="tok-kw">const</span> <span class="tok-type">u8</span> = utl.concatStr(<span class="tok-str">&quot;Info : &quot;</span>, errTxt) ;</span>
<span class="line" id="L155">    <span class="tok-kw">var</span> boucle : <span class="tok-type">bool</span>= <span class="tok-null">true</span> ;</span>
<span class="line" id="L156"></span>
<span class="line" id="L157">    <span class="tok-kw">if</span> (vpnl.cols &lt; (msgerr.len) )  msgerr = subStr(vpnl, msgerr, <span class="tok-number">0</span>,  vpnl.cols - <span class="tok-number">2</span>);</span>
<span class="line" id="L158"></span>
<span class="line" id="L159">    <span class="tok-comment">// clear line button </span>
</span>
<span class="line" id="L160">    <span class="tok-kw">while</span> (y &lt;= (vpnl.cols - <span class="tok-number">2</span>) ) : (y += <span class="tok-number">1</span>) {</span>
<span class="line" id="L161">      term.gotoXY(vpnl.posx + x  - <span class="tok-number">2</span>   , y + vpnl.posy  );</span>
<span class="line" id="L162">      term.writeStyled(<span class="tok-str">&quot; &quot;</span>,vpnl.attribut);</span>
<span class="line" id="L163">    }</span>
<span class="line" id="L164">    <span class="tok-comment">// display msgerr</span>
</span>
<span class="line" id="L165">    y = <span class="tok-number">1</span> ;</span>
<span class="line" id="L166">    term.gotoXY(vpnl.posx + x  - <span class="tok-number">2</span>, y + vpnl.posy   );</span>
<span class="line" id="L167">    term.writeStyled(msgerr,MsgErr);</span>
<span class="line" id="L168"></span>
<span class="line" id="L169">    <span class="tok-kw">while</span> (boucle) {</span>
<span class="line" id="L170">      <span class="tok-kw">var</span> e_key = kbd.getKEY();</span>
<span class="line" id="L171"></span>
<span class="line" id="L172">      <span class="tok-kw">switch</span> ( e_key.Key ) {</span>
<span class="line" id="L173">        .esc=&gt;boucle = <span class="tok-null">false</span>,</span>
<span class="line" id="L174">      <span class="tok-kw">else</span> =&gt;  {},</span>
<span class="line" id="L175">      }</span>
<span class="line" id="L176">    }</span>
<span class="line" id="L177"></span>
<span class="line" id="L178">    <span class="tok-comment">// restore line panel</span>
</span>
<span class="line" id="L179">    <span class="tok-kw">while</span> (y &lt;= (vpnl.cols - <span class="tok-number">2</span>)) : (y += <span class="tok-number">1</span>) {</span>
<span class="line" id="L180">      n += <span class="tok-number">1</span>;</span>
<span class="line" id="L181">      term.gotoXY( vpnl.posx + x  - <span class="tok-number">2</span>, y + vpnl.posy  );</span>
<span class="line" id="L182">      term.writeStyled(vpnl.buf.items[n].ch,vpnl.buf.items[n].attribut);</span>
<span class="line" id="L183">    } </span>
<span class="line" id="L184">  }</span>
<span class="line" id="L185">};</span>
<span class="line" id="L186"></span>
<span class="line" id="L187"></span>
<span class="line" id="L188"><span class="tok-comment">// buffer terminal MATRIX</span>
</span>
<span class="line" id="L189"><span class="tok-kw">const</span> TERMINAL_CHAR = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L190">  ch :   [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L191">  attribut:dds.ZONATRB,</span>
<span class="line" id="L192">  on:<span class="tok-type">bool</span></span>
<span class="line" id="L193">};</span>
<span class="line" id="L194"></span>
<span class="line" id="L195"><span class="tok-comment">//----------------------------</span>
</span>
<span class="line" id="L196"><span class="tok-comment">// OUTIL </span>
</span>
<span class="line" id="L197"><span class="tok-comment">//----------------------------</span>
</span>
<span class="line" id="L198"></span>
<span class="line" id="L199"></span>
<span class="line" id="L200"><span class="tok-comment">/// intern solution substring String</span></span>
<span class="line" id="L201"><span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">subStr</span>( vpnl: *pnl.PANEL, a: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,pos: <span class="tok-type">usize</span>, n:<span class="tok-type">usize</span>) []<span class="tok-kw">const</span> <span class="tok-type">u8</span> {</span>
<span class="line" id="L202">  <span class="tok-kw">if</span> (n == <span class="tok-number">0</span> <span class="tok-kw">or</span> n &gt; a.len) {dsperr.errorForms(vpnl, ErrForms.Invalide_subStr_Index);<span class="tok-kw">return</span> <span class="tok-str">&quot; &quot;</span> ;}</span>
<span class="line" id="L203"></span>
<span class="line" id="L204">  <span class="tok-kw">if</span> (pos &gt; a.len) {dsperr.errorForms(vpnl, ErrForms.Invalide_subStr_Index);<span class="tok-kw">return</span> <span class="tok-str">&quot; &quot;</span> ;}</span>
<span class="line" id="L205"></span>
<span class="line" id="L206">  <span class="tok-kw">const</span> allocator = std.heap.page_allocator;</span>
<span class="line" id="L207">  <span class="tok-kw">const</span> result = allocator.alloc(<span class="tok-type">u8</span>, n - pos) </span>
<span class="line" id="L208">                <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L209">  <span class="tok-kw">defer</span> allocator.free(result);</span>
<span class="line" id="L210"></span>
<span class="line" id="L211">  std.mem.copy(<span class="tok-type">u8</span>, result, a[pos..n]);</span>
<span class="line" id="L212">  <span class="tok-kw">return</span> std.fmt.allocPrint(dds.allocatorUtils,<span class="tok-str">&quot;{s}&quot;</span>,.{result},)</span>
<span class="line" id="L213">                <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L214">}</span>
<span class="line" id="L215"></span>
<span class="line" id="L216"></span>
<span class="line" id="L217"><span class="tok-comment">// interne soltion</span>
</span>
<span class="line" id="L218"><span class="tok-kw">fn</span> <span class="tok-fn">strToUsize</span>( v : []<span class="tok-kw">const</span> <span class="tok-type">u8</span> ) <span class="tok-type">usize</span>{</span>
<span class="line" id="L219">  <span class="tok-kw">return</span> std.fmt.parseUnsigned(<span class="tok-type">u64</span>, v,<span class="tok-number">10</span>) </span>
<span class="line" id="L220">        <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L221">}</span>
<span class="line" id="L222"></span>
<span class="line" id="L223"><span class="tok-kw">fn</span> <span class="tok-fn">usizeToStr</span>( v : <span class="tok-type">usize</span> ) []<span class="tok-kw">const</span> <span class="tok-type">u8</span>{</span>
<span class="line" id="L224"></span>
<span class="line" id="L225">  <span class="tok-kw">return</span> std.fmt.allocPrint(dds.allocatorUtils,<span class="tok-str">&quot;{d}&quot;</span>, .{v})</span>
<span class="line" id="L226">  <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L227">}</span>
<span class="line" id="L228"></span>
<span class="line" id="L229"></span>
<span class="line" id="L230"></span>
<span class="line" id="L231"><span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">strToUint</span>( str : []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) <span class="tok-type">usize</span>{</span>
<span class="line" id="L232"></span>
<span class="line" id="L233"><span class="tok-kw">if</span>( str.len == <span class="tok-number">0</span>) <span class="tok-kw">return</span> <span class="tok-number">0</span> ;</span>
<span class="line" id="L234"></span>
<span class="line" id="L235"><span class="tok-kw">var</span> digit: [<span class="tok-number">1</span>][] <span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L236"><span class="tok-kw">var</span> buffer : [<span class="tok-number">100</span>] <span class="tok-type">u8</span> =  [_]<span class="tok-type">u8</span>{<span class="tok-number">0</span>} ** <span class="tok-number">100</span>;</span>
<span class="line" id="L237"></span>
<span class="line" id="L238">digit [<span class="tok-number">0</span>]  = std.fmt.bufPrint(buffer[<span class="tok-number">0</span>..], <span class="tok-str">&quot;{s}&quot;</span>,.{str}) </span>
<span class="line" id="L239">                  <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L240"></span>
<span class="line" id="L241">      <span class="tok-kw">for</span> ( digit, <span class="tok-number">0</span>..) |d, idx| {</span>
<span class="line" id="L242"></span>
<span class="line" id="L243">        <span class="tok-kw">if</span> ( !std.ascii.isDigit(d[idx])) {</span>
<span class="line" id="L244">            dsperr(ErrForms.char_not_digital_invalide);</span>
<span class="line" id="L245">            <span class="tok-kw">return</span> <span class="tok-number">0</span> ;</span>
<span class="line" id="L246">        }</span>
<span class="line" id="L247">      }</span>
<span class="line" id="L248"></span>
<span class="line" id="L249"><span class="tok-kw">return</span> std.fmt.parseUnsigned(<span class="tok-type">u64</span>, str,<span class="tok-number">10</span>) </span>
<span class="line" id="L250">        <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L251">}</span>
<span class="line" id="L252"></span>
<span class="line" id="L253"></span>
<span class="line" id="L254"><span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">UintToStr</span>(v: <span class="tok-type">usize</span> ) []<span class="tok-kw">const</span> <span class="tok-type">u8</span>{</span>
<span class="line" id="L255"></span>
<span class="line" id="L256">  <span class="tok-kw">return</span> std.fmt.allocPrint(dds.allocatorUtils,<span class="tok-str">&quot;{d}&quot;</span>, .{v})</span>
<span class="line" id="L257">  <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L258">}</span>
<span class="line" id="L259"></span>
<span class="line" id="L260"><span class="tok-comment">// function special for developpeur</span>
</span>
<span class="line" id="L261"><span class="tok-comment">// activat fld.myMouse = true</span>
</span>
<span class="line" id="L262"><span class="tok-comment">// read ioField -&gt; getKEY()</span>
</span>
<span class="line" id="L263"> <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">dspMouse</span>(vpnl: *pnl.PANEL) <span class="tok-type">void</span> {</span>
<span class="line" id="L264">    <span class="tok-kw">const</span> AtrDebug: dds.ZONATRB = .{</span>
<span class="line" id="L265">        .styled = [_]<span class="tok-type">u32</span>{ <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle), <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle), <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle), <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle) },</span>
<span class="line" id="L266">        .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L267">        .foregr = dds.ForegroundColor.fgRed,</span>
<span class="line" id="L268">    };</span>
<span class="line" id="L269">    <span class="tok-kw">const</span> allocator = std.heap.page_allocator;</span>
<span class="line" id="L270">    <span class="tok-kw">var</span> msg = std.fmt.allocPrint(allocator, <span class="tok-str">&quot;{d:0&gt;2}{s}{d:0&gt;3}&quot;</span>, .{ term.MouseInfo.x, <span class="tok-str">&quot;/&quot;</span>, term.MouseInfo.y }) </span>
<span class="line" id="L271">                      <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L272">    term.gotoXY(vpnl.posx + vpnl.lines - <span class="tok-number">1</span>, (vpnl.posy + vpnl.cols - <span class="tok-number">1</span>) - <span class="tok-number">7</span>);</span>
<span class="line" id="L273">    term.writeStyled(msg, AtrDebug);</span>
<span class="line" id="L274">    term.gotoXY(term.MouseInfo.x, term.MouseInfo.y);</span>
<span class="line" id="L275">    allocator.free(msg);</span>
<span class="line" id="L276">}</span>
<span class="line" id="L277"></span>
<span class="line" id="L278"><span class="tok-comment">// function special for developpeur</span>
</span>
<span class="line" id="L279"> <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">dspCursor</span>(vpnl: *pnl.PANEL, x_posx: <span class="tok-type">usize</span>, x_posy: <span class="tok-type">usize</span>) <span class="tok-type">void</span> {</span>
<span class="line" id="L280">    <span class="tok-kw">const</span> AtrDebug: dds.ZONATRB = .{</span>
<span class="line" id="L281">        .styled = [_]<span class="tok-type">u32</span>{ <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle), <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle), <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle), <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle) },</span>
<span class="line" id="L282">        .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L283">        .foregr = dds.ForegroundColor.fgRed,</span>
<span class="line" id="L284">    };</span>
<span class="line" id="L285">    <span class="tok-kw">const</span> allocator = std.heap.page_allocator;</span>
<span class="line" id="L286">    <span class="tok-kw">var</span> msg = std.fmt.allocPrint(allocator, <span class="tok-str">&quot;{d:0&gt;2}{s}{d:0&gt;3}&quot;</span>, .{ x_posx, <span class="tok-str">&quot;/&quot;</span>, x_posy }) </span>
<span class="line" id="L287">                      <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L288">    term.gotoXY(vpnl.posx + vpnl.lines - <span class="tok-number">1</span>, (vpnl.posy + vpnl.cols - <span class="tok-number">1</span>) - <span class="tok-number">7</span>);</span>
<span class="line" id="L289">    term.writeStyled(msg, AtrDebug);</span>
<span class="line" id="L290">    term.gotoXY(x_posx, x_posy);</span>
<span class="line" id="L291">    allocator.free(msg);</span>
<span class="line" id="L292">}</span>
<span class="line" id="L293"></span>
<span class="line" id="L294"></span>
<span class="line" id="L295"><span class="tok-comment">// defined Label</span>
</span>
<span class="line" id="L296"><span class="tok-kw">pub</span> <span class="tok-kw">const</span>  lbl = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L297"></span>
<span class="line" id="L298">  <span class="tok-comment">// define attribut default LABEL</span>
</span>
<span class="line" id="L299">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> AtrLabel : dds.ZONATRB = .{</span>
<span class="line" id="L300">      .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.styleDim),</span>
<span class="line" id="L301">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.styleItalic),</span>
<span class="line" id="L302">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L303">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L304">      .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L305">      .foregr = dds.ForegroundColor.fgGreen,</span>
<span class="line" id="L306">  };</span>
<span class="line" id="L307"></span>
<span class="line" id="L308">  <span class="tok-comment">// define attribut default TITLE</span>
</span>
<span class="line" id="L309">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> AtrTitle : dds.ZONATRB = .{</span>
<span class="line" id="L310">      .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.styleBold),</span>
<span class="line" id="L311">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L312">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L313">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L314">      .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L315">      .foregr = dds.ForegroundColor.fgGreen,</span>
<span class="line" id="L316">  };</span>
<span class="line" id="L317"></span>
<span class="line" id="L318">  <span class="tok-kw">pub</span> <span class="tok-kw">const</span> LABEL = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L319">    name :  []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L320">    posx:   <span class="tok-type">usize</span>,</span>
<span class="line" id="L321">    posy:   <span class="tok-type">usize</span>,</span>
<span class="line" id="L322">    attribut:dds.ZONATRB,</span>
<span class="line" id="L323">    text:   []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L324">    title:  <span class="tok-type">bool</span>,</span>
<span class="line" id="L325">    actif:  <span class="tok-type">bool</span></span>
<span class="line" id="L326">    };</span>
<span class="line" id="L327"></span>
<span class="line" id="L328"></span>
<span class="line" id="L329">  <span class="tok-comment">// New LABEL</span>
</span>
<span class="line" id="L330">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newLabel</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>, vposx:<span class="tok-type">usize</span>, vposy:<span class="tok-type">usize</span>,</span>
<span class="line" id="L331">              vtext: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>) LABEL {</span>
<span class="line" id="L332"></span>
<span class="line" id="L333">        <span class="tok-kw">const</span> xlabel = LABEL {</span>
<span class="line" id="L334">            .name = vname,</span>
<span class="line" id="L335">            .posx = vposx ,</span>
<span class="line" id="L336">            .posy = vposy,</span>
<span class="line" id="L337">            .attribut = AtrLabel,</span>
<span class="line" id="L338">            .text = vtext,</span>
<span class="line" id="L339">            .title = <span class="tok-null">true</span>,</span>
<span class="line" id="L340">            .actif = <span class="tok-null">true</span>,</span>
<span class="line" id="L341">        };</span>
<span class="line" id="L342"></span>
<span class="line" id="L343">        <span class="tok-kw">return</span> xlabel;</span>
<span class="line" id="L344">  }</span>
<span class="line" id="L345"></span>
<span class="line" id="L346"></span>
<span class="line" id="L347">  <span class="tok-comment">// New LABEL-TITLE</span>
</span>
<span class="line" id="L348">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newTitle</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>, vposx:<span class="tok-type">usize</span>, vposy:<span class="tok-type">usize</span>,</span>
<span class="line" id="L349">              vtext: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>) LABEL {</span>
<span class="line" id="L350"></span>
<span class="line" id="L351">        <span class="tok-kw">const</span> xlabel = LABEL {</span>
<span class="line" id="L352">            .name = vname,</span>
<span class="line" id="L353">            .posx = vposx ,</span>
<span class="line" id="L354">            .posy = vposy,</span>
<span class="line" id="L355">            .attribut = AtrTitle,</span>
<span class="line" id="L356">            .text = vtext,</span>
<span class="line" id="L357">            .title = <span class="tok-null">true</span>,</span>
<span class="line" id="L358">            .actif = <span class="tok-null">true</span>,</span>
<span class="line" id="L359">        };</span>
<span class="line" id="L360"></span>
<span class="line" id="L361">        <span class="tok-kw">return</span> xlabel;</span>
<span class="line" id="L362">  }</span>
<span class="line" id="L363"></span>
<span class="line" id="L364"></span>
<span class="line" id="L365">  <span class="tok-comment">// return index-label  ---&gt; arraylist panel-label</span>
</span>
<span class="line" id="L366">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getIndex</span>(vpnl: *pnl.PANEL , name: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> )  ErrForms ! <span class="tok-type">usize</span> {</span>
<span class="line" id="L367"></span>
<span class="line" id="L368">    <span class="tok-kw">for</span> (vpnl.label.items, <span class="tok-number">0</span>..) |l, idx| {</span>
<span class="line" id="L369">      <span class="tok-kw">if</span> (std.mem.eql(<span class="tok-type">u8</span>, l.name, name)) <span class="tok-kw">return</span> idx ;</span>
<span class="line" id="L370">    }</span>
<span class="line" id="L371">    <span class="tok-kw">return</span> ErrForms.lbl_getIndex_Name_Label_Invalide;</span>
<span class="line" id="L372">  }</span>
<span class="line" id="L373"></span>
<span class="line" id="L374">  <span class="tok-comment">// return name-label ---&gt; arraylist panel-label</span>
</span>
<span class="line" id="L375">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getName</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>) ErrForms ! [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> {</span>
<span class="line" id="L376">    <span class="tok-kw">if</span> ( n &lt; vpnl.label.items.len) <span class="tok-kw">return</span> vpnl.label.items[n].name;</span>
<span class="line" id="L377">    <span class="tok-kw">return</span> ErrForms.lbl_getName_Index_invalide ;</span>
<span class="line" id="L378"></span>
<span class="line" id="L379">  }</span>
<span class="line" id="L380"></span>
<span class="line" id="L381">  <span class="tok-comment">// return posx-label ---&gt; arraylist panel-label</span>
</span>
<span class="line" id="L382">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getPosx</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">usize</span> {</span>
<span class="line" id="L383">    <span class="tok-kw">if</span> ( n &lt; vpnl.label.items.len) <span class="tok-kw">return</span> vpnl.label.items[n].posx;</span>
<span class="line" id="L384">    <span class="tok-kw">return</span> ErrForms.lbl_getPosx_Index_invalide ;</span>
<span class="line" id="L385">  }</span>
<span class="line" id="L386"></span>
<span class="line" id="L387">  <span class="tok-comment">// return posy-label ---&gt; arraylist panel-label</span>
</span>
<span class="line" id="L388">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getPosy</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">usize</span> {</span>
<span class="line" id="L389">    <span class="tok-kw">if</span> ( n &lt; vpnl.label.items.len) <span class="tok-kw">return</span> vpnl.label.items[n].posy;</span>
<span class="line" id="L390">    <span class="tok-kw">return</span> ErrForms.lbl_getPosy_Index_invalide ;</span>
<span class="line" id="L391">  }</span>
<span class="line" id="L392"></span>
<span class="line" id="L393">  <span class="tok-comment">// return Text-label ---&gt; arraylist panel-label</span>
</span>
<span class="line" id="L394">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getText</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">usize</span> {</span>
<span class="line" id="L395">    <span class="tok-kw">if</span> ( n &lt; vpnl.label.items.len) <span class="tok-kw">return</span> vpnl.label.items[n].text;</span>
<span class="line" id="L396">    <span class="tok-kw">return</span> ErrForms.lbl_getText_Index_invalide ;</span>
<span class="line" id="L397">  }</span>
<span class="line" id="L398"></span>
<span class="line" id="L399">  <span class="tok-comment">// return ON/OFF-label ---&gt; arraylist panel-label</span>
</span>
<span class="line" id="L400">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getActif</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">bool</span> {</span>
<span class="line" id="L401">    <span class="tok-kw">if</span> ( n &lt; vpnl.label.items.len) <span class="tok-kw">return</span> vpnl.label.items[n].actif;</span>
<span class="line" id="L402">    <span class="tok-kw">return</span> ErrForms.lbl_getActif_Index_invalide ;</span>
<span class="line" id="L403">  }</span>
<span class="line" id="L404"></span>
<span class="line" id="L405">  <span class="tok-comment">// Set TEXT -label ---&gt; arraylist panel-label</span>
</span>
<span class="line" id="L406">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setText</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>, val:[] <span class="tok-kw">const</span> <span class="tok-type">u8</span>) ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L407">    <span class="tok-kw">if</span> ( n &lt; vpnl.label.items.len)  vpnl.label.items[n].text = val</span>
<span class="line" id="L408">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.lbl_setText_Index_invalide;</span>
<span class="line" id="L409">  }</span>
<span class="line" id="L410"></span>
<span class="line" id="L411">  <span class="tok-comment">// Set ON/OFF -label ---&gt; arraylist panel-label</span>
</span>
<span class="line" id="L412">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setActif</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>, val :<span class="tok-type">bool</span>) ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L413">    <span class="tok-kw">if</span> ( n &lt; vpnl.label.items.len) vpnl.label.items[n].actif = val</span>
<span class="line" id="L414">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.lbl_setActif_Index_invalide;</span>
<span class="line" id="L415">  }</span>
<span class="line" id="L416"></span>
<span class="line" id="L417">  <span class="tok-comment">// delete -label ---&gt; arraylist panel-label</span>
</span>
<span class="line" id="L418">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">dltRows</span>(vpnl: *pnl.PANEL,  n :<span class="tok-type">usize</span> ) ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L419">    <span class="tok-kw">if</span> ( n &lt; vpnl.label.items.len)  _= vpnl.label.orderedRemove(n)</span>
<span class="line" id="L420">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.lbl_dltRows_Index_invalide;</span>
<span class="line" id="L421">  }</span>
<span class="line" id="L422"></span>
<span class="line" id="L423">  <span class="tok-comment">// update Label and Display  ---&gt; arraylist panel-label</span>
</span>
<span class="line" id="L424">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">updateText</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>, val:[] <span class="tok-kw">const</span> <span class="tok-type">u8</span>) ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L425">    <span class="tok-kw">if</span> ( n &lt; vpnl.label.items.len) {</span>
<span class="line" id="L426">      clsLabel(vpnl, vpnl.label.items[n]);</span>
<span class="line" id="L427">      vpnl.label.items[n].text = val;</span>
<span class="line" id="L428">      printLabel(vpnl, vpnl.label.items[n]);</span>
<span class="line" id="L429">      displayLabel(vpnl, vpnl.label.items[n]);</span>
<span class="line" id="L430">    } <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.lbl_updateText_Index_invalide;</span>
<span class="line" id="L431">  }</span>
<span class="line" id="L432"></span>
<span class="line" id="L433">  <span class="tok-comment">// assign -label MATRIX TERMINAL  ---&gt; arraylist panel-label</span>
</span>
<span class="line" id="L434">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">printLabel</span>(vpnl: *pnl.PANEL, vlbl : LABEL ) <span class="tok-type">void</span> {</span>
<span class="line" id="L435">    <span class="tok-kw">var</span> n  = (vpnl.cols * (vlbl.posx - <span class="tok-number">1</span>)) + vlbl.posy - <span class="tok-number">1</span>;</span>
<span class="line" id="L436">    <span class="tok-kw">var</span> iter = utl.iteratStr.iterator(vlbl.text);</span>
<span class="line" id="L437">    <span class="tok-kw">defer</span> iter.deinit();</span>
<span class="line" id="L438"></span>
<span class="line" id="L439">    <span class="tok-kw">while</span> (iter.next()) |ch| {</span>
<span class="line" id="L440">      <span class="tok-kw">if</span> (vlbl.actif == <span class="tok-null">true</span>) {</span>
<span class="line" id="L441">        vpnl.buf.items[n].ch = ch ;</span>
<span class="line" id="L442">        vpnl.buf.items[n].attribut = vlbl.attribut;</span>
<span class="line" id="L443">        vpnl.buf.items[n].on = <span class="tok-null">true</span>;</span>
<span class="line" id="L444">      }</span>
<span class="line" id="L445">      <span class="tok-kw">else</span> {</span>
<span class="line" id="L446">        vpnl.buf.items[n].ch = <span class="tok-str">&quot;&quot;</span>;</span>
<span class="line" id="L447">        vpnl.buf.items[n].attribut  = vpnl.attribut;</span>
<span class="line" id="L448">        vpnl.buf.items[n].on = <span class="tok-null">false</span>;</span>
<span class="line" id="L449">      }</span>
<span class="line" id="L450">      n += <span class="tok-number">1</span>;</span>
<span class="line" id="L451">    }</span>
<span class="line" id="L452">  }</span>
<span class="line" id="L453"></span>
<span class="line" id="L454"></span>
<span class="line" id="L455">  <span class="tok-comment">// matrix cleaning from label</span>
</span>
<span class="line" id="L456">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">clsLabel</span>(vpnl: *pnl.PANEL, vlbl : LABEL )  <span class="tok-type">void</span> {</span>
<span class="line" id="L457">    <span class="tok-comment">// display matrice PANEL</span>
</span>
<span class="line" id="L458">    <span class="tok-kw">if</span> (vpnl.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span> ;</span>
<span class="line" id="L459">    <span class="tok-kw">if</span> (vlbl.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span> ;</span>
<span class="line" id="L460">      <span class="tok-kw">var</span> x :<span class="tok-type">usize</span> = vlbl.posx - <span class="tok-number">1</span>;</span>
<span class="line" id="L461">      <span class="tok-kw">var</span> y :<span class="tok-type">usize</span> = vlbl.posy - <span class="tok-number">1</span>;</span>
<span class="line" id="L462">      <span class="tok-kw">var</span> vlen = utl.nbrCharStr(vlbl.text);</span>
<span class="line" id="L463">      <span class="tok-kw">var</span> n :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L464">      <span class="tok-kw">var</span> npos :<span class="tok-type">usize</span> = (vpnl.cols * (vlbl.posx - <span class="tok-number">1</span>)) + vlbl.posy - <span class="tok-number">1</span> ;</span>
<span class="line" id="L465">      <span class="tok-kw">while</span> (n &lt; vlen) : (n += <span class="tok-number">1</span>) {</span>
<span class="line" id="L466">        vpnl.buf.items[npos].ch = <span class="tok-str">&quot; &quot;</span>;</span>
<span class="line" id="L467">        vpnl.buf.items[npos].attribut  = vpnl.attribut;</span>
<span class="line" id="L468">        vpnl.buf.items[npos].on = <span class="tok-null">false</span>;</span>
<span class="line" id="L469">        term.gotoXY(x + vpnl.posx   , y + vpnl.posy + n  );</span>
<span class="line" id="L470">        term.writeStyled(vpnl.buf.items[npos].ch,vpnl.buf.items[npos].attribut);</span>
<span class="line" id="L471">        npos += <span class="tok-number">1</span>;</span>
<span class="line" id="L472">      }</span>
<span class="line" id="L473">  }</span>
<span class="line" id="L474"></span>
<span class="line" id="L475"></span>
<span class="line" id="L476">  <span class="tok-comment">// display  MATRIX to terminal ---&gt; arraylist panel-label</span>
</span>
<span class="line" id="L477">  <span class="tok-kw">fn</span> <span class="tok-fn">displayLabel</span>(vpnl: *pnl.PANEL, vlbl : LABEL )  <span class="tok-type">void</span> {</span>
<span class="line" id="L478">    <span class="tok-comment">// display matrice PANEL</span>
</span>
<span class="line" id="L479">    <span class="tok-kw">if</span> (vpnl.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span> ;</span>
<span class="line" id="L480">      <span class="tok-kw">var</span> x :<span class="tok-type">usize</span> = vlbl.posx - <span class="tok-number">1</span> ;</span>
<span class="line" id="L481">      <span class="tok-kw">var</span> y :<span class="tok-type">usize</span> = vlbl.posy - <span class="tok-number">1</span>;</span>
<span class="line" id="L482">      <span class="tok-kw">var</span> vlen = utl.nbrCharStr(vlbl.text);</span>
<span class="line" id="L483">      <span class="tok-kw">var</span> n :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L484">      <span class="tok-kw">var</span> npos :<span class="tok-type">usize</span> = (vpnl.cols * vlbl.posx) + vlbl.posy - <span class="tok-number">1</span> ;</span>
<span class="line" id="L485">      <span class="tok-kw">while</span> (n &lt; vlen) : (n += <span class="tok-number">1</span>) {</span>
<span class="line" id="L486">        term.gotoXY(x + vpnl.posx   , y + vpnl.posy + n  );</span>
<span class="line" id="L487">        term.writeStyled(vpnl.buf.items[npos].ch,vpnl.buf.items[npos].attribut);</span>
<span class="line" id="L488">        npos += <span class="tok-number">1</span>;</span>
<span class="line" id="L489">      }</span>
<span class="line" id="L490">  }</span>
<span class="line" id="L491">};</span>
<span class="line" id="L492"></span>
<span class="line" id="L493"></span>
<span class="line" id="L494"><span class="tok-comment">// defined Trait and Frame for Panel</span>
</span>
<span class="line" id="L495"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> frm = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L496"></span>
<span class="line" id="L497">  <span class="tok-comment">// define attribut default FRAME</span>
</span>
<span class="line" id="L498">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> AtrFrame : dds.ZONATRB = .{</span>
<span class="line" id="L499">      .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.styleDim),</span>
<span class="line" id="L500">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L501">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L502">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L503">      .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L504">      .foregr = dds.ForegroundColor.fgRed</span>
<span class="line" id="L505"></span>
<span class="line" id="L506">  };</span>
<span class="line" id="L507"></span>
<span class="line" id="L508">  <span class="tok-comment">// define attribut default TITLE FRAME</span>
</span>
<span class="line" id="L509">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> AtrTitle : dds.ZONATRB = .{</span>
<span class="line" id="L510">      .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.styleBold),</span>
<span class="line" id="L511">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L512">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L513">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L514">      .backgr = dds.BackgroundColor.bgWhite,</span>
<span class="line" id="L515">      .foregr = dds.ForegroundColor.fgBlue</span>
<span class="line" id="L516">  };</span>
<span class="line" id="L517"></span>
<span class="line" id="L518"></span>
<span class="line" id="L519">  <span class="tok-comment">/// FRAME</span></span>
<span class="line" id="L520"></span>
<span class="line" id="L521">  <span class="tok-kw">pub</span> <span class="tok-kw">const</span> FRAME = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L522">    name :  []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L523">    posx:   <span class="tok-type">usize</span>,</span>
<span class="line" id="L524">    posy:   <span class="tok-type">usize</span>,</span>
<span class="line" id="L525">    lines:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L526">    cols:   <span class="tok-type">usize</span>,</span>
<span class="line" id="L527">    cadre:  dds.CADRE,</span>
<span class="line" id="L528">    attribut:dds.ZONATRB,</span>
<span class="line" id="L529">    title:  []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L530">    titleAttribut: dds.ZONATRB,</span>
<span class="line" id="L531">    actif:  <span class="tok-type">bool</span></span>
<span class="line" id="L532">    };</span>
<span class="line" id="L533"></span>
<span class="line" id="L534">    <span class="tok-comment">// define Fram </span>
</span>
<span class="line" id="L535">    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFrame</span>(vname:[]<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L536">                    vposx:<span class="tok-type">usize</span>, vposy:<span class="tok-type">usize</span>,</span>
<span class="line" id="L537">                    vlines:<span class="tok-type">usize</span>,</span>
<span class="line" id="L538">                    vcols:<span class="tok-type">usize</span>,</span>
<span class="line" id="L539">                    vcadre:dds.CADRE,</span>
<span class="line" id="L540">                    vattribut:dds.ZONATRB,</span>
<span class="line" id="L541">                    vtitle:[]<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L542">                    vtitleAttribut:dds.ZONATRB,</span>
<span class="line" id="L543">                    ) FRAME {</span>
<span class="line" id="L544"></span>
<span class="line" id="L545">          <span class="tok-kw">const</span> xframe = FRAME {</span>
<span class="line" id="L546">              .name = vname,</span>
<span class="line" id="L547">              .posx = vposx,</span>
<span class="line" id="L548">              .posy = vposy,</span>
<span class="line" id="L549">              .lines = vlines,</span>
<span class="line" id="L550">              .cols = vcols,</span>
<span class="line" id="L551">              .cadre = vcadre,</span>
<span class="line" id="L552">              .attribut = vattribut,</span>
<span class="line" id="L553">              .title = vtitle,</span>
<span class="line" id="L554">              .titleAttribut = vtitleAttribut,</span>
<span class="line" id="L555">              .actif = <span class="tok-null">true</span></span>
<span class="line" id="L556">          };</span>
<span class="line" id="L557">      <span class="tok-kw">return</span> xframe;</span>
<span class="line" id="L558"></span>
<span class="line" id="L559">    }</span>
<span class="line" id="L560"></span>
<span class="line" id="L561"></span>
<span class="line" id="L562">    <span class="tok-comment">// write MATRIX TERMINAL  ---&gt; arraylist panel-fram</span>
</span>
<span class="line" id="L563">    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">printFrame</span>(vpnl : *pnl.PANEL , vfram: FRAME) <span class="tok-type">void</span> {</span>
<span class="line" id="L564"></span>
<span class="line" id="L565">      <span class="tok-comment">// assigne FRAME to init matrice for display</span>
</span>
<span class="line" id="L566">      <span class="tok-kw">if</span> (dds.CADRE.line0 == vfram.cadre ) <span class="tok-kw">return</span> ;</span>
<span class="line" id="L567"></span>
<span class="line" id="L568">      <span class="tok-kw">const</span> ACS_Hlines  = <span class="tok-str">&quot;─&quot;</span>;</span>
<span class="line" id="L569">      <span class="tok-kw">const</span> ACS_Vlines  = <span class="tok-str">&quot;│&quot;</span>;</span>
<span class="line" id="L570">      <span class="tok-kw">const</span> ACS_UCLEFT  = <span class="tok-str">&quot;┌&quot;</span>;</span>
<span class="line" id="L571">      <span class="tok-kw">const</span> ACS_UCRIGHT = <span class="tok-str">&quot;┐&quot;</span>;</span>
<span class="line" id="L572">      <span class="tok-kw">const</span> ACS_LCLEFT  = <span class="tok-str">&quot;└&quot;</span>;</span>
<span class="line" id="L573">      <span class="tok-kw">const</span> ACS_LCRIGHT = <span class="tok-str">&quot;┘&quot;</span>;</span>
<span class="line" id="L574"></span>
<span class="line" id="L575">      <span class="tok-kw">const</span> ACS_Hline2    = <span class="tok-str">&quot;═&quot;</span>;</span>
<span class="line" id="L576">      <span class="tok-kw">const</span> ACS_Vline2    = <span class="tok-str">&quot;║&quot;</span>;</span>
<span class="line" id="L577">      <span class="tok-kw">const</span> ACS_UCLEFT2   = <span class="tok-str">&quot;╔&quot;</span>;</span>
<span class="line" id="L578">      <span class="tok-kw">const</span> ACS_UCRIGHT2  = <span class="tok-str">&quot;╗&quot;</span>;</span>
<span class="line" id="L579">      <span class="tok-kw">const</span> ACS_LCLEFT2   = <span class="tok-str">&quot;╚&quot;</span>;</span>
<span class="line" id="L580">      <span class="tok-kw">const</span> ACS_LCRIGHT2  = <span class="tok-str">&quot;╝&quot;</span>;</span>
<span class="line" id="L581"></span>
<span class="line" id="L582">      <span class="tok-kw">var</span> trait: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;&quot;</span>;</span>
<span class="line" id="L583">      <span class="tok-kw">var</span> edt :<span class="tok-type">bool</span>   = <span class="tok-null">undefined</span> ;</span>
<span class="line" id="L584"></span>
<span class="line" id="L585">      <span class="tok-kw">var</span> row:  <span class="tok-type">usize</span> = <span class="tok-number">1</span> ;</span>
<span class="line" id="L586">      <span class="tok-kw">var</span> y:    <span class="tok-type">usize</span> = <span class="tok-number">0</span> ;</span>
<span class="line" id="L587">      <span class="tok-kw">var</span> col:  <span class="tok-type">usize</span> = <span class="tok-number">0</span> ;</span>
<span class="line" id="L588">      <span class="tok-kw">var</span> npos: <span class="tok-type">usize</span> = <span class="tok-number">0</span> ;</span>
<span class="line" id="L589"></span>
<span class="line" id="L590">      <span class="tok-kw">var</span> wlen : <span class="tok-type">usize</span> = utl.nbrCharStr(vfram.title);</span>
<span class="line" id="L591"></span>
<span class="line" id="L592">      <span class="tok-kw">var</span> n:    <span class="tok-type">usize</span> = <span class="tok-number">0</span> ;</span>
<span class="line" id="L593">      <span class="tok-kw">var</span> x:<span class="tok-type">usize</span> = vfram.posx - <span class="tok-number">1</span> ;</span>
<span class="line" id="L594"></span>
<span class="line" id="L595">      <span class="tok-kw">while</span> (row &lt;= vfram.lines) {</span>
<span class="line" id="L596">        y = vfram.posy - <span class="tok-number">1</span>;</span>
<span class="line" id="L597">        col = <span class="tok-number">1</span>;</span>
<span class="line" id="L598">        <span class="tok-kw">while</span> ( col &lt;= vfram.cols ){</span>
<span class="line" id="L599">          edt = <span class="tok-null">false</span>;</span>
<span class="line" id="L600">          <span class="tok-kw">if</span> (row == <span class="tok-number">1</span>) {</span>
<span class="line" id="L601">              <span class="tok-kw">if</span> (col == <span class="tok-number">1</span>) {</span>
<span class="line" id="L602">                <span class="tok-kw">if</span> ( dds.CADRE.line1 == vfram.cadre ) {</span>
<span class="line" id="L603">                    trait = ACS_UCLEFT;</span>
<span class="line" id="L604">                } <span class="tok-kw">else</span>  trait = ACS_UCLEFT2 ;</span>
<span class="line" id="L605">                edt = <span class="tok-null">true</span>;</span>
<span class="line" id="L606">              }</span>
<span class="line" id="L607">              <span class="tok-kw">if</span> ( col == vfram.cols ) {</span>
<span class="line" id="L608">                <span class="tok-kw">if</span> (dds.CADRE.line1 == vfram.cadre) {</span>
<span class="line" id="L609">                  trait = ACS_UCRIGHT;</span>
<span class="line" id="L610">                } <span class="tok-kw">else</span>  trait = ACS_UCRIGHT2 ;</span>
<span class="line" id="L611">                edt = <span class="tok-null">true</span>;</span>
<span class="line" id="L612">              }</span>
<span class="line" id="L613">              <span class="tok-kw">if</span> ( col &gt; <span class="tok-number">1</span> <span class="tok-kw">and</span> col &lt; vfram.cols ) {</span>
<span class="line" id="L614">                <span class="tok-kw">if</span> (dds.CADRE.line1 == vfram.cadre ) {</span>
<span class="line" id="L615">                  trait = ACS_Hlines;</span>
<span class="line" id="L616">                } <span class="tok-kw">else</span>  trait = ACS_Hline2;</span>
<span class="line" id="L617">                edt = <span class="tok-null">true</span>;</span>
<span class="line" id="L618">              }</span>
<span class="line" id="L619">          } <span class="tok-kw">else</span> <span class="tok-kw">if</span> ( row == vfram.lines ) {</span>
<span class="line" id="L620">              <span class="tok-kw">if</span> (col == <span class="tok-number">1</span>) {</span>
<span class="line" id="L621">                <span class="tok-kw">if</span> ( dds.CADRE.line1 == vfram.cadre ) {</span>
<span class="line" id="L622">                  trait = ACS_LCLEFT;</span>
<span class="line" id="L623">                } <span class="tok-kw">else</span>  trait = ACS_LCLEFT2;</span>
<span class="line" id="L624">                edt = <span class="tok-null">true</span>;</span>
<span class="line" id="L625">              }</span>
<span class="line" id="L626">              <span class="tok-kw">if</span> ( col == vfram.cols ) {</span>
<span class="line" id="L627">                <span class="tok-kw">if</span> ( dds.CADRE.line1 == vfram.cadre ) {</span>
<span class="line" id="L628">                  trait = ACS_LCRIGHT;</span>
<span class="line" id="L629">                } <span class="tok-kw">else</span>  trait = ACS_LCRIGHT2 ;</span>
<span class="line" id="L630">                edt = <span class="tok-null">true</span> ;</span>
<span class="line" id="L631">              }</span>
<span class="line" id="L632">              <span class="tok-kw">if</span> ( col &gt; <span class="tok-number">1</span> <span class="tok-kw">and</span> col &lt; vfram.cols ) {</span>
<span class="line" id="L633">                <span class="tok-kw">if</span> ( dds.CADRE.line1 == vfram.cadre ) {</span>
<span class="line" id="L634">                  trait = ACS_Hlines;</span>
<span class="line" id="L635">                } <span class="tok-kw">else</span>  trait = ACS_Hline2 ;</span>
<span class="line" id="L636">                edt = <span class="tok-null">true</span>;</span>
<span class="line" id="L637">              }</span>
<span class="line" id="L638">          } <span class="tok-kw">else</span> <span class="tok-kw">if</span> ( row &gt; <span class="tok-number">1</span> <span class="tok-kw">and</span> row &lt; vfram.lines ) {</span>
<span class="line" id="L639">            <span class="tok-kw">if</span> ( col == <span class="tok-number">1</span> <span class="tok-kw">or</span> col == vfram.cols ) {</span>
<span class="line" id="L640">              <span class="tok-kw">if</span> ( dds.CADRE.line1 == vfram.cadre ) {</span>
<span class="line" id="L641">                trait = ACS_Vlines;</span>
<span class="line" id="L642">              } <span class="tok-kw">else</span> trait = ACS_Vline2 ;</span>
<span class="line" id="L643">              edt = <span class="tok-null">true</span>;</span>
<span class="line" id="L644">            }</span>
<span class="line" id="L645">          }</span>
<span class="line" id="L646">          <span class="tok-kw">if</span>  ( edt ) {</span>
<span class="line" id="L647">              npos =  vfram.cols * x;</span>
<span class="line" id="L648">              n =  npos  + y;</span>
<span class="line" id="L649">              vpnl.buf.items[n].ch = trait ;</span>
<span class="line" id="L650">              vpnl.buf.items[n].attribut = vfram.attribut;</span>
<span class="line" id="L651">              vpnl.buf.items[n].on = <span class="tok-null">true</span>;</span>
<span class="line" id="L652">          }</span>
<span class="line" id="L653"></span>
<span class="line" id="L654">          y += <span class="tok-number">1</span>;</span>
<span class="line" id="L655">          col += <span class="tok-number">1</span>;</span>
<span class="line" id="L656">        }</span>
<span class="line" id="L657">        x += <span class="tok-number">1</span>;</span>
<span class="line" id="L658">        row +=<span class="tok-number">1</span> ;</span>
<span class="line" id="L659">      }</span>
<span class="line" id="L660"></span>
<span class="line" id="L661">      <span class="tok-kw">if</span> (wlen &gt; vfram.cols - <span class="tok-number">2</span> <span class="tok-kw">or</span> wlen == <span class="tok-number">0</span> )  <span class="tok-kw">return</span> ;</span>
<span class="line" id="L662">        npos = vfram.posx;</span>
<span class="line" id="L663">        n =  npos + (((vfram.cols - wlen ) / <span class="tok-number">2</span>)) - <span class="tok-number">1</span> ;</span>
<span class="line" id="L664">        <span class="tok-kw">var</span> iter = utl.iteratStr.iterator(vfram.title);</span>
<span class="line" id="L665">        <span class="tok-kw">defer</span> iter.deinit();</span>
<span class="line" id="L666">        <span class="tok-kw">while</span> (iter.next()) |ch| {</span>
<span class="line" id="L667">          vpnl.buf.items[n].ch = ch ;</span>
<span class="line" id="L668">          vpnl.buf.items[n].attribut = vfram.titleAttribut;</span>
<span class="line" id="L669">          vpnl.buf.items[n].on = <span class="tok-null">true</span>;</span>
<span class="line" id="L670">          n +=<span class="tok-number">1</span>;</span>
<span class="line" id="L671">        }</span>
<span class="line" id="L672">    }</span>
<span class="line" id="L673"></span>
<span class="line" id="L674">};</span>
<span class="line" id="L675"></span>
<span class="line" id="L676"></span>
<span class="line" id="L677"></span>
<span class="line" id="L678"><span class="tok-comment">// defined Line and vertical for Panel</span>
</span>
<span class="line" id="L679"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> lnv = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L680"></span>
<span class="line" id="L681">  <span class="tok-comment">// define attribut default FRAME</span>
</span>
<span class="line" id="L682">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> AtrLine : dds.ZONATRB = .{</span>
<span class="line" id="L683">      .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.styleDim),</span>
<span class="line" id="L684">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L685">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L686">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L687">      .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L688">      .foregr = dds.ForegroundColor.fgYellow</span>
<span class="line" id="L689"></span>
<span class="line" id="L690">  };</span>
<span class="line" id="L691"></span>
<span class="line" id="L692"></span>
<span class="line" id="L693"></span>
<span class="line" id="L694">  <span class="tok-comment">/// LINE VERTICAL</span></span>
<span class="line" id="L695"></span>
<span class="line" id="L696">  <span class="tok-kw">pub</span> <span class="tok-kw">const</span> LINE = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L697">    name :  []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L698">    posx:   <span class="tok-type">usize</span>,</span>
<span class="line" id="L699">    posy:   <span class="tok-type">usize</span>,</span>
<span class="line" id="L700">    lines:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L701">    cadre:  dds.LINE,</span>
<span class="line" id="L702">    attribut:dds.ZONATRB,</span>
<span class="line" id="L703">    actif:  <span class="tok-type">bool</span></span>
<span class="line" id="L704">    };</span>
<span class="line" id="L705"></span>
<span class="line" id="L706">    <span class="tok-comment">// define Fram </span>
</span>
<span class="line" id="L707">    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newLine</span>(vname:[]<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L708">                    vposx:<span class="tok-type">usize</span>, vposy:<span class="tok-type">usize</span>,</span>
<span class="line" id="L709">                    vlines:<span class="tok-type">usize</span>,</span>
<span class="line" id="L710">                    vcadre:dds.LINE,</span>
<span class="line" id="L711">                    ) LINE {</span>
<span class="line" id="L712"></span>
<span class="line" id="L713">          <span class="tok-kw">const</span> xframe = LINE {</span>
<span class="line" id="L714">              .name = vname,</span>
<span class="line" id="L715">              .posx = vposx,</span>
<span class="line" id="L716">              .posy = vposy,</span>
<span class="line" id="L717">              .lines = vlines,</span>
<span class="line" id="L718">              .cadre = vcadre,</span>
<span class="line" id="L719">              .attribut = AtrLine,</span>
<span class="line" id="L720">              .actif = <span class="tok-null">true</span></span>
<span class="line" id="L721">          };</span>
<span class="line" id="L722">      <span class="tok-kw">return</span> xframe;</span>
<span class="line" id="L723"></span>
<span class="line" id="L724">    }</span>
<span class="line" id="L725"></span>
<span class="line" id="L726"></span>
<span class="line" id="L727">    <span class="tok-comment">// write MATRIX TERMINAL  ---&gt; arraylist panel-line</span>
</span>
<span class="line" id="L728">    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">printLine</span>(vpnl : *pnl.PANEL , vline: LINE) <span class="tok-type">void</span> {</span>
<span class="line" id="L729">    <span class="tok-kw">if</span> (vpnl.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span> ;</span>
<span class="line" id="L730">    <span class="tok-kw">if</span> (vline.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span> ;</span>
<span class="line" id="L731"></span>
<span class="line" id="L732">      <span class="tok-comment">// assigne FRAMELINE VERTICAL</span>
</span>
<span class="line" id="L733"></span>
<span class="line" id="L734">      <span class="tok-kw">const</span> ACS_Vlines  = <span class="tok-str">&quot;│&quot;</span>;</span>
<span class="line" id="L735">      <span class="tok-kw">const</span> ACS_Vline2    = <span class="tok-str">&quot;║&quot;</span>;</span>
<span class="line" id="L736"></span>
<span class="line" id="L737">      <span class="tok-kw">var</span> row:  <span class="tok-type">usize</span> = <span class="tok-number">0</span> ;</span>
<span class="line" id="L738">      <span class="tok-kw">var</span> npos: <span class="tok-type">usize</span> = <span class="tok-number">0</span> ;</span>
<span class="line" id="L739"></span>
<span class="line" id="L740">      <span class="tok-kw">var</span> n: <span class="tok-type">usize</span> = <span class="tok-number">0</span> ;</span>
<span class="line" id="L741">      <span class="tok-kw">var</span> x: <span class="tok-type">usize</span> = vline.posx  ;</span>
<span class="line" id="L742"></span>
<span class="line" id="L743">      <span class="tok-kw">var</span> trait: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;&quot;</span>;</span>
<span class="line" id="L744"></span>
<span class="line" id="L745">      <span class="tok-kw">while</span> (row &lt; vline.lines) {</span>
<span class="line" id="L746"></span>
<span class="line" id="L747"></span>
<span class="line" id="L748">        <span class="tok-kw">if</span> ( dds.LINE.line1 == vline.cadre ) {</span>
<span class="line" id="L749">          trait = ACS_Vlines;</span>
<span class="line" id="L750">        } <span class="tok-kw">else</span> trait = ACS_Vline2 ;</span>
<span class="line" id="L751">        npos =  vpnl.cols * x;</span>
<span class="line" id="L752">        n =  npos + vline.posy;</span>
<span class="line" id="L753">        vpnl.buf.items[n].ch = trait ;</span>
<span class="line" id="L754">        vpnl.buf.items[n].attribut = vline.attribut;</span>
<span class="line" id="L755">        vpnl.buf.items[n].on = <span class="tok-null">true</span>;</span>
<span class="line" id="L756">      </span>
<span class="line" id="L757">        row +=<span class="tok-number">1</span> ;</span>
<span class="line" id="L758">        x += <span class="tok-number">1</span>;</span>
<span class="line" id="L759">      }</span>
<span class="line" id="L760">    }</span>
<span class="line" id="L761"></span>
<span class="line" id="L762">};</span>
<span class="line" id="L763"></span>
<span class="line" id="L764"></span>
<span class="line" id="L765"><span class="tok-comment">// defined Line and vertical for Panel</span>
</span>
<span class="line" id="L766"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> lnh = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L767"></span>
<span class="line" id="L768">  <span class="tok-comment">// define attribut default FRAME</span>
</span>
<span class="line" id="L769">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> AtrLine : dds.ZONATRB = .{</span>
<span class="line" id="L770">      .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.styleDim),</span>
<span class="line" id="L771">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L772">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L773">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L774">      .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L775">      .foregr = dds.ForegroundColor.fgYellow</span>
<span class="line" id="L776"></span>
<span class="line" id="L777">  };</span>
<span class="line" id="L778"></span>
<span class="line" id="L779"></span>
<span class="line" id="L780"></span>
<span class="line" id="L781">  <span class="tok-comment">/// LINE VERTICAL</span></span>
<span class="line" id="L782"></span>
<span class="line" id="L783">  <span class="tok-kw">pub</span> <span class="tok-kw">const</span> LINE = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L784">    name :  []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L785">    posx:   <span class="tok-type">usize</span>,</span>
<span class="line" id="L786">    posy:   <span class="tok-type">usize</span>,</span>
<span class="line" id="L787">    cols:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L788">    cadre:  dds.LINE,</span>
<span class="line" id="L789">    attribut:dds.ZONATRB,</span>
<span class="line" id="L790">    actif:  <span class="tok-type">bool</span></span>
<span class="line" id="L791">    };</span>
<span class="line" id="L792"></span>
<span class="line" id="L793">    <span class="tok-comment">// define Fram </span>
</span>
<span class="line" id="L794">    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newLine</span>(vname:[]<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L795">                    vposx:<span class="tok-type">usize</span>, vposy:<span class="tok-type">usize</span>,</span>
<span class="line" id="L796">                    vcols:<span class="tok-type">usize</span>,</span>
<span class="line" id="L797">                    vcadre:dds.LINE,</span>
<span class="line" id="L798">                    ) LINE {</span>
<span class="line" id="L799"></span>
<span class="line" id="L800">          <span class="tok-kw">const</span> xframe = LINE {</span>
<span class="line" id="L801">              .name = vname,</span>
<span class="line" id="L802">              .posx = vposx,</span>
<span class="line" id="L803">              .posy = vposy,</span>
<span class="line" id="L804">              .cols = vcols,</span>
<span class="line" id="L805">              .cadre = vcadre,</span>
<span class="line" id="L806">              .attribut = AtrLine,</span>
<span class="line" id="L807">              .actif = <span class="tok-null">true</span></span>
<span class="line" id="L808">          };</span>
<span class="line" id="L809">      <span class="tok-kw">return</span> xframe;</span>
<span class="line" id="L810"></span>
<span class="line" id="L811">    }</span>
<span class="line" id="L812"></span>
<span class="line" id="L813"></span>
<span class="line" id="L814">    <span class="tok-comment">// write MATRIX TERMINAL  ---&gt; arraylist panel-line</span>
</span>
<span class="line" id="L815">    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">printLine</span>(vpnl : *pnl.PANEL , vline: LINE) <span class="tok-type">void</span> {</span>
<span class="line" id="L816">    <span class="tok-kw">if</span> (vpnl.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span> ;</span>
<span class="line" id="L817">    <span class="tok-kw">if</span> (vline.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span> ;</span>
<span class="line" id="L818">      <span class="tok-comment">// assigne FRAMELINE VERTICAL</span>
</span>
<span class="line" id="L819"></span>
<span class="line" id="L820">      <span class="tok-kw">const</span> ACS_Hlines  = <span class="tok-str">&quot;─&quot;</span>;</span>
<span class="line" id="L821">      <span class="tok-kw">const</span> ACS_Hline2  = <span class="tok-str">&quot;═&quot;</span>;</span>
<span class="line" id="L822"></span>
<span class="line" id="L823">      <span class="tok-kw">var</span> coln:  <span class="tok-type">usize</span> = <span class="tok-number">0</span> ;</span>
<span class="line" id="L824">      <span class="tok-kw">var</span> npos: <span class="tok-type">usize</span> = <span class="tok-number">0</span> ;</span>
<span class="line" id="L825"></span>
<span class="line" id="L826">      <span class="tok-kw">var</span> n: <span class="tok-type">usize</span> = <span class="tok-number">0</span> ;</span>
<span class="line" id="L827">      <span class="tok-kw">var</span> y: <span class="tok-type">usize</span> = vline.posy  ;</span>
<span class="line" id="L828"></span>
<span class="line" id="L829">      <span class="tok-kw">var</span> trait: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;&quot;</span>;</span>
<span class="line" id="L830"></span>
<span class="line" id="L831">      npos =  vpnl.cols * vline.posx;</span>
<span class="line" id="L832"></span>
<span class="line" id="L833">      <span class="tok-kw">while</span> (coln &lt; vline.cols) {</span>
<span class="line" id="L834"></span>
<span class="line" id="L835"></span>
<span class="line" id="L836">        <span class="tok-kw">if</span> ( dds.LINE.line1 == vline.cadre ) {</span>
<span class="line" id="L837">          trait = ACS_Hlines;</span>
<span class="line" id="L838">        } <span class="tok-kw">else</span> trait = ACS_Hline2 ;</span>
<span class="line" id="L839"></span>
<span class="line" id="L840">        n =  npos + y;</span>
<span class="line" id="L841">        vpnl.buf.items[n].ch = trait ;</span>
<span class="line" id="L842">        vpnl.buf.items[n].attribut = vline.attribut;</span>
<span class="line" id="L843">        vpnl.buf.items[n].on = <span class="tok-null">true</span>;</span>
<span class="line" id="L844">      </span>
<span class="line" id="L845">        coln +=<span class="tok-number">1</span> ;</span>
<span class="line" id="L846">        y += <span class="tok-number">1</span>;</span>
<span class="line" id="L847">      }</span>
<span class="line" id="L848">    }</span>
<span class="line" id="L849"></span>
<span class="line" id="L850">};</span>
<span class="line" id="L851"></span>
<span class="line" id="L852"></span>
<span class="line" id="L853"></span>
<span class="line" id="L854"><span class="tok-comment">// defined button</span>
</span>
<span class="line" id="L855"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> btn = <span class="tok-kw">struct</span>{</span>
<span class="line" id="L856"></span>
<span class="line" id="L857">  <span class="tok-comment">// nbr espace intercaler</span>
</span>
<span class="line" id="L858">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> btnspc : <span class="tok-type">usize</span> =<span class="tok-number">3</span> ;</span>
<span class="line" id="L859">  <span class="tok-comment">// define attribut default PANEL</span>
</span>
<span class="line" id="L860">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> AtrButton : dds.ZONATRB = .{</span>
<span class="line" id="L861">      .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.styleDim),</span>
<span class="line" id="L862">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L863">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L864">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L865">      .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L866">      .foregr = dds.ForegroundColor.fgRed</span>
<span class="line" id="L867">  };</span>
<span class="line" id="L868">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> AtrTitle : dds.ZONATRB = .{</span>
<span class="line" id="L869">      .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.styleDim),</span>
<span class="line" id="L870">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.styleItalic),</span>
<span class="line" id="L871">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.styleUnderscore),</span>
<span class="line" id="L872">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L873">      .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L874">      .foregr = dds.ForegroundColor.fgdCyan,</span>
<span class="line" id="L875">  };</span>
<span class="line" id="L876"></span>
<span class="line" id="L877"></span>
<span class="line" id="L878"></span>
<span class="line" id="L879">  <span class="tok-comment">// define BUTTON</span>
</span>
<span class="line" id="L880">  <span class="tok-kw">pub</span> <span class="tok-kw">const</span> BUTTON = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L881">    name: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L882">    key : kbd,</span>
<span class="line" id="L883">    show: <span class="tok-type">bool</span>,</span>
<span class="line" id="L884">    check: <span class="tok-type">bool</span>,</span>
<span class="line" id="L885">    title: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L886">    attribut:dds.ZONATRB,</span>
<span class="line" id="L887">    titleAttribut: dds.ZONATRB,</span>
<span class="line" id="L888">    actif: <span class="tok-type">bool</span>,</span>
<span class="line" id="L889">  };</span>
<span class="line" id="L890"></span>
<span class="line" id="L891">  <span class="tok-comment">// func BUTTON</span>
</span>
<span class="line" id="L892">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newButton</span>(</span>
<span class="line" id="L893">              vkey : kbd,</span>
<span class="line" id="L894">              vshow : <span class="tok-type">bool</span>,</span>
<span class="line" id="L895">              vcheck:<span class="tok-type">bool</span>,</span>
<span class="line" id="L896">              vtitle: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>) BUTTON {</span>
<span class="line" id="L897"></span>
<span class="line" id="L898">        <span class="tok-kw">const</span> xbutton = BUTTON {</span>
<span class="line" id="L899">            .name = kbd.enumToStr(vkey),</span>
<span class="line" id="L900">            .key  = vkey,</span>
<span class="line" id="L901">            .show = vshow,</span>
<span class="line" id="L902">            .check = vcheck,</span>
<span class="line" id="L903">            .title = vtitle,</span>
<span class="line" id="L904">            .attribut = AtrButton,</span>
<span class="line" id="L905">            .titleAttribut = AtrTitle,</span>
<span class="line" id="L906">            .actif = <span class="tok-null">true</span></span>
<span class="line" id="L907">        };</span>
<span class="line" id="L908"></span>
<span class="line" id="L909">        <span class="tok-kw">return</span> xbutton;</span>
<span class="line" id="L910">  }</span>
<span class="line" id="L911"></span>
<span class="line" id="L912">  <span class="tok-comment">// return index-button  ---&gt; arraylist panel-button</span>
</span>
<span class="line" id="L913">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getIndex</span>(vpnl: *pnl.PANEL , key: kbd  ) ErrForms ! <span class="tok-type">usize</span> {</span>
<span class="line" id="L914"></span>
<span class="line" id="L915">    <span class="tok-kw">for</span> (vpnl.button.item, <span class="tok-number">0</span>..) |b ,idx  | {</span>
<span class="line" id="L916">      <span class="tok-kw">if</span> (b.button.key == key) <span class="tok-kw">return</span> idx;</span>
<span class="line" id="L917">    }</span>
<span class="line" id="L918">    <span class="tok-kw">return</span> ErrForms.btn_getIndex_Key_Button_Invalide;</span>
<span class="line" id="L919">  }</span>
<span class="line" id="L920"></span>
<span class="line" id="L921">  <span class="tok-comment">// return name-button  ---&gt; arraylist panel-button</span>
</span>
<span class="line" id="L922">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getName</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>) ErrForms ! [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> {</span>
<span class="line" id="L923">    <span class="tok-kw">if</span> ( n &lt; vpnl.button.items.len) <span class="tok-kw">return</span> vpnl.button.items[n].name;</span>
<span class="line" id="L924">    <span class="tok-kw">return</span> ErrForms.btn_getName_Index_invalide ;</span>
<span class="line" id="L925"></span>
<span class="line" id="L926">  }</span>
<span class="line" id="L927"></span>
<span class="line" id="L928">  <span class="tok-comment">// return key-button  ---&gt; arraylist panel-button</span>
</span>
<span class="line" id="L929">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getKey</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>) ErrForms ! kbd {</span>
<span class="line" id="L930">    <span class="tok-kw">if</span> ( n &lt; vpnl.button.items.len) <span class="tok-kw">return</span> vpnl.button.items[n].key;</span>
<span class="line" id="L931">    <span class="tok-kw">return</span> ErrForms.btn_getKey_Index_invalide ;</span>
<span class="line" id="L932"></span>
<span class="line" id="L933">  }</span>
<span class="line" id="L934"></span>
<span class="line" id="L935">  <span class="tok-comment">// return show-button  ---&gt; arraylist panel-button</span>
</span>
<span class="line" id="L936">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getShow</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>) ErrForms ! <span class="tok-type">bool</span> {</span>
<span class="line" id="L937">    <span class="tok-kw">if</span> ( n &lt; vpnl.button.items.len) <span class="tok-kw">return</span> vpnl.button.items[n].show;</span>
<span class="line" id="L938">    <span class="tok-kw">return</span> ErrForms.btn_getShow_Index_invalide ;</span>
<span class="line" id="L939">  }</span>
<span class="line" id="L940"></span>
<span class="line" id="L941">  <span class="tok-comment">// return text-button  ---&gt; arraylist panel-button</span>
</span>
<span class="line" id="L942">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getTitle</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>) ErrForms ! [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> {</span>
<span class="line" id="L943">    <span class="tok-kw">if</span> ( n &lt; vpnl.button.items.len) <span class="tok-kw">return</span> vpnl.button.items[n].title;</span>
<span class="line" id="L944">    <span class="tok-kw">return</span> ErrForms.btn_getText_Index_invalide ;</span>
<span class="line" id="L945">  }</span>
<span class="line" id="L946"></span>
<span class="line" id="L947">  <span class="tok-comment">// return check-button  ---&gt; arraylist panel-button</span>
</span>
<span class="line" id="L948">  <span class="tok-comment">// work for field input-field</span>
</span>
<span class="line" id="L949">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getCheck</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>) ErrForms ! <span class="tok-type">bool</span> {</span>
<span class="line" id="L950">    <span class="tok-kw">if</span> ( n &lt; vpnl.button.items.len) <span class="tok-kw">return</span> vpnl.button.items[n].check;</span>
<span class="line" id="L951">    <span class="tok-kw">return</span> ErrForms.btn_getCheck_Index_invalide ;</span>
<span class="line" id="L952">  }</span>
<span class="line" id="L953"></span>
<span class="line" id="L954">  <span class="tok-comment">// return ON/OFF-button  ---&gt; arraylist panel-button</span>
</span>
<span class="line" id="L955">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getActif</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>) ErrForms ! <span class="tok-type">bool</span> {</span>
<span class="line" id="L956">    <span class="tok-kw">if</span> ( n &lt; vpnl.button.items.len) <span class="tok-kw">return</span> vpnl.button.items[n].actif;</span>
<span class="line" id="L957">    <span class="tok-kw">return</span> ErrForms.btn_getActif_Index_invalide ;</span>
<span class="line" id="L958">  }</span>
<span class="line" id="L959"></span>
<span class="line" id="L960">  <span class="tok-comment">// set show-button  ---&gt; arraylist panel-button</span>
</span>
<span class="line" id="L961">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setShow</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>, val :<span class="tok-type">bool</span>) ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L962">    <span class="tok-kw">if</span> ( n &lt; vpnl.button.items.len)  vpnl.button.items[n].show = val</span>
<span class="line" id="L963">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.btn_setShow_Index_invalide ;</span>
<span class="line" id="L964">  }</span>
<span class="line" id="L965"></span>
<span class="line" id="L966">  <span class="tok-comment">// set text-button  ---&gt; arraylist panel-button</span>
</span>
<span class="line" id="L967">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setText</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>, val:[] <span class="tok-kw">const</span> <span class="tok-type">u8</span>) ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L968">    <span class="tok-kw">if</span> ( n &lt; vpnl.button.items.len) vpnl.button.items[n].text = val</span>
<span class="line" id="L969">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.btn_setText_Index_invalide ;</span>
<span class="line" id="L970">  }</span>
<span class="line" id="L971"></span>
<span class="line" id="L972">  <span class="tok-comment">// set chek-button  ---&gt; arraylist panel-button</span>
</span>
<span class="line" id="L973">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setCheck</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>, val :<span class="tok-type">bool</span>) ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L974">    <span class="tok-kw">if</span> ( n &lt; vpnl.button.items.len) vpnl.button.items[n].check = val</span>
<span class="line" id="L975">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.btn_setCheck_Index_invalide ;</span>
<span class="line" id="L976">  }</span>
<span class="line" id="L977"></span>
<span class="line" id="L978">  <span class="tok-comment">// set ON/OFF-button  ---&gt; arraylist panel-button</span>
</span>
<span class="line" id="L979">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setActif</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>, val :<span class="tok-type">bool</span>) ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L980">    <span class="tok-kw">if</span> ( n &lt; vpnl.button.items.len) vpnl.button.items[n].actif = val</span>
<span class="line" id="L981">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.btn_setActif_Index_invalide ;</span>
<span class="line" id="L982">  }</span>
<span class="line" id="L983"></span>
<span class="line" id="L984"></span>
<span class="line" id="L985"></span>
<span class="line" id="L986">  <span class="tok-comment">// delete -button  ---&gt; arraylist panel-button</span>
</span>
<span class="line" id="L987">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">dltRows</span>(vpnl:*pnl.PANEL,  n :<span class="tok-type">usize</span> ) ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L988">    <span class="tok-kw">if</span> ( n &lt; vpnl.button.items.len) _= vpnl.button.orderedRemove(n)</span>
<span class="line" id="L989">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.btn_dltRows_Index_invalide ;</span>
<span class="line" id="L990">  }</span>
<span class="line" id="L991"></span>
<span class="line" id="L992"></span>
<span class="line" id="L993">  <span class="tok-comment">// assign -button MATRIX TERMINAL  ---&gt; arraylist panel-button</span>
</span>
<span class="line" id="L994">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">printButton</span>(vpnl: *pnl.PANEL) <span class="tok-type">void</span> {</span>
<span class="line" id="L995">    <span class="tok-kw">if</span> (vpnl.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span> ;</span>
<span class="line" id="L996">  </span>
<span class="line" id="L997">    <span class="tok-kw">var</span> espace :<span class="tok-type">usize</span> = <span class="tok-number">3</span>;</span>
<span class="line" id="L998">    <span class="tok-kw">var</span> x :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L999">    <span class="tok-kw">var</span> y :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L1000"></span>
<span class="line" id="L1001">    <span class="tok-kw">if</span> (vpnl.frame.cadre == dds.CADRE.line0 ) {</span>
<span class="line" id="L1002">      x = vpnl.lines - <span class="tok-number">1</span>;</span>
<span class="line" id="L1003">      y = <span class="tok-number">1</span>;</span>
<span class="line" id="L1004">    }</span>
<span class="line" id="L1005">    <span class="tok-kw">else</span> {</span>
<span class="line" id="L1006">      x = vpnl.lines - <span class="tok-number">2</span>;</span>
<span class="line" id="L1007">      y = <span class="tok-number">2</span>;</span>
<span class="line" id="L1008">    }</span>
<span class="line" id="L1009"></span>
<span class="line" id="L1010">    <span class="tok-kw">var</span> npos : <span class="tok-type">usize</span> = vpnl.cols * x ;</span>
<span class="line" id="L1011">    <span class="tok-kw">var</span> n =  npos + y;</span>
<span class="line" id="L1012"></span>
<span class="line" id="L1013">    <span class="tok-kw">for</span> (vpnl.button.items) |button| {</span>
<span class="line" id="L1014"></span>
<span class="line" id="L1015">      <span class="tok-kw">if</span> (button.show == <span class="tok-null">true</span>) {</span>
<span class="line" id="L1016"></span>
<span class="line" id="L1017">        <span class="tok-comment">// text Function KEY</span>
</span>
<span class="line" id="L1018">        <span class="tok-kw">var</span> iter = utl.iteratStr.iterator(button.name);</span>
<span class="line" id="L1019">        <span class="tok-kw">defer</span> iter.deinit();</span>
<span class="line" id="L1020">        <span class="tok-kw">while</span> (iter.next()) |ch| {</span>
<span class="line" id="L1021">          <span class="tok-kw">if</span> (button.actif == <span class="tok-null">true</span>) {</span>
<span class="line" id="L1022">            vpnl.buf.items[n].ch = ch ;</span>
<span class="line" id="L1023">            vpnl.buf.items[n].attribut = button.attribut;</span>
<span class="line" id="L1024">            vpnl.buf.items[n].on = <span class="tok-null">true</span>;</span>
<span class="line" id="L1025">          }</span>
<span class="line" id="L1026">          <span class="tok-kw">else</span> {</span>
<span class="line" id="L1027">            vpnl.buf.items[n].ch = <span class="tok-str">&quot; &quot;</span>;</span>
<span class="line" id="L1028">            vpnl.buf.items[n].attribut  = vpnl.attribut;</span>
<span class="line" id="L1029">            vpnl.buf.items[n].on = <span class="tok-null">false</span>;</span>
<span class="line" id="L1030">          }</span>
<span class="line" id="L1031">          n += <span class="tok-number">1</span>;</span>
<span class="line" id="L1032">        }</span>
<span class="line" id="L1033">        n += <span class="tok-number">1</span>;</span>
<span class="line" id="L1034"></span>
<span class="line" id="L1035">        <span class="tok-comment">//text Title button</span>
</span>
<span class="line" id="L1036">        iter = utl.iteratStr.iterator(button.title);</span>
<span class="line" id="L1037"></span>
<span class="line" id="L1038">        <span class="tok-kw">while</span> (iter.next()) |ch| {</span>
<span class="line" id="L1039">          <span class="tok-kw">if</span> (button.actif == <span class="tok-null">true</span>) {</span>
<span class="line" id="L1040">            vpnl.buf.items[n].ch = ch ;</span>
<span class="line" id="L1041">            vpnl.buf.items[n].attribut = button.titleAttribut;</span>
<span class="line" id="L1042">            vpnl.buf.items[n].on = <span class="tok-null">true</span>;</span>
<span class="line" id="L1043">          }</span>
<span class="line" id="L1044">          <span class="tok-kw">else</span> {</span>
<span class="line" id="L1045">            vpnl.buf.items[n].ch = <span class="tok-str">&quot; &quot;</span>;</span>
<span class="line" id="L1046">            vpnl.buf.items[n].attribut  = vpnl.attribut;</span>
<span class="line" id="L1047">            vpnl.buf.items[n].on = <span class="tok-null">false</span>;</span>
<span class="line" id="L1048">          }</span>
<span class="line" id="L1049">          n += <span class="tok-number">1</span>;</span>
<span class="line" id="L1050">        }</span>
<span class="line" id="L1051">        n += espace;</span>
<span class="line" id="L1052">      }</span>
<span class="line" id="L1053">    }</span>
<span class="line" id="L1054">  }</span>
<span class="line" id="L1055"></span>
<span class="line" id="L1056">};</span>
<span class="line" id="L1057"></span>
<span class="line" id="L1058"></span>
<span class="line" id="L1059"><span class="tok-comment">// defined Menu</span>
</span>
<span class="line" id="L1060"><span class="tok-kw">pub</span> <span class="tok-kw">const</span>  mnu = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L1061"></span>
<span class="line" id="L1062">  <span class="tok-comment">// nbr espace intercaler</span>
</span>
<span class="line" id="L1063">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span>  mnuspc : <span class="tok-type">usize</span> =<span class="tok-number">3</span> ;</span>
<span class="line" id="L1064"></span>
<span class="line" id="L1065">  <span class="tok-comment">// define attribut default CADRE</span>
</span>
<span class="line" id="L1066">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> AtrMnu : dds.ZONATRB = .{</span>
<span class="line" id="L1067">    .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.styleDim),</span>
<span class="line" id="L1068">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1069">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1070">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L1071">    .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L1072">    .foregr = dds.ForegroundColor.fgRed</span>
<span class="line" id="L1073"></span>
<span class="line" id="L1074">  };</span>
<span class="line" id="L1075"></span>
<span class="line" id="L1076">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> AtrBar : dds.ZONATRB = .{</span>
<span class="line" id="L1077">    .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.styleReverse),</span>
<span class="line" id="L1078">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.styleItalic),</span>
<span class="line" id="L1079">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1080">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L1081">    .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L1082">    .foregr = dds.ForegroundColor.fgWhite</span>
<span class="line" id="L1083"></span>
<span class="line" id="L1084">  };</span>
<span class="line" id="L1085"></span>
<span class="line" id="L1086">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> AtrCell : dds.ZONATRB= .{</span>
<span class="line" id="L1087">    .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.styleItalic),</span>
<span class="line" id="L1088">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1089">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1090">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L1091">    .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L1092">    .foregr = dds.ForegroundColor.fgWhite,</span>
<span class="line" id="L1093">  };</span>
<span class="line" id="L1094"></span>
<span class="line" id="L1095">  <span class="tok-comment">// define MENU</span>
</span>
<span class="line" id="L1096">  <span class="tok-kw">pub</span> <span class="tok-kw">const</span> MENU = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L1097"></span>
<span class="line" id="L1098">    name : [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1099">    posx : <span class="tok-type">usize</span>,</span>
<span class="line" id="L1100">    posy : <span class="tok-type">usize</span>,</span>
<span class="line" id="L1101">    lines: <span class="tok-type">usize</span>,</span>
<span class="line" id="L1102">    cols : <span class="tok-type">usize</span>,</span>
<span class="line" id="L1103"></span>
<span class="line" id="L1104">    cadre: dds.CADRE,</span>
<span class="line" id="L1105">    mnuvh : dds.MNUVH,</span>
<span class="line" id="L1106"></span>
<span class="line" id="L1107">    attribut: dds.ZONATRB,</span>
<span class="line" id="L1108">    attrBar: dds.ZONATRB,</span>
<span class="line" id="L1109">    attrCell: dds.ZONATRB,</span>
<span class="line" id="L1110"></span>
<span class="line" id="L1111">    xitems: []<span class="tok-kw">const</span>[]<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1112">    nbr: <span class="tok-type">usize</span>,</span>
<span class="line" id="L1113">    actif: <span class="tok-type">bool</span></span>
<span class="line" id="L1114">  };</span>
<span class="line" id="L1115"></span>
<span class="line" id="L1116">  <span class="tok-comment">// NEW MENU</span>
</span>
<span class="line" id="L1117">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newMenu</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1118">                vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L1119">                vcadre : dds.CADRE,</span>
<span class="line" id="L1120">                vmnuvh : dds.MNUVH,</span>
<span class="line" id="L1121">                vitems: []<span class="tok-kw">const</span>[]<span class="tok-kw">const</span> <span class="tok-type">u8</span></span>
<span class="line" id="L1122">                ) MENU {</span>
<span class="line" id="L1123"></span>
<span class="line" id="L1124"></span>
<span class="line" id="L1125"></span>
<span class="line" id="L1126">    <span class="tok-kw">var</span> xmenu = MENU {</span>
<span class="line" id="L1127">            .name = vname,</span>
<span class="line" id="L1128">            .posx   = vposx,</span>
<span class="line" id="L1129">            .posy   = vposy,</span>
<span class="line" id="L1130">            .lines  = <span class="tok-number">0</span>,</span>
<span class="line" id="L1131">            .cols   = <span class="tok-number">0</span>,</span>
<span class="line" id="L1132">            .attribut =AtrMnu,</span>
<span class="line" id="L1133">            .attrBar = AtrBar,</span>
<span class="line" id="L1134">            .attrCell= AtrCell,</span>
<span class="line" id="L1135">            .cadre = vcadre,</span>
<span class="line" id="L1136">            .mnuvh = vmnuvh,</span>
<span class="line" id="L1137">            .xitems  = vitems,</span>
<span class="line" id="L1138">            .nbr = <span class="tok-number">0</span>,</span>
<span class="line" id="L1139">            .actif = <span class="tok-null">true</span></span>
<span class="line" id="L1140">        };</span>
<span class="line" id="L1141"></span>
<span class="line" id="L1142"></span>
<span class="line" id="L1143">        <span class="tok-kw">for</span> (xmenu.xitems) |txt| {</span>
<span class="line" id="L1144">          <span class="tok-kw">if</span> (xmenu.cols &lt; txt.len) xmenu.cols = txt.len;</span>
<span class="line" id="L1145">          xmenu.nbr +=<span class="tok-number">1</span>;</span>
<span class="line" id="L1146">        }</span>
<span class="line" id="L1147">        xmenu.lines += xmenu.nbr + <span class="tok-number">2</span>; <span class="tok-comment">//nbr ligne  + header =cadre</span>
</span>
<span class="line" id="L1148">        xmenu.cols  += <span class="tok-number">2</span>;</span>
<span class="line" id="L1149">    <span class="tok-kw">return</span> xmenu;</span>
<span class="line" id="L1150">  }</span>
<span class="line" id="L1151"></span>
<span class="line" id="L1152"></span>
<span class="line" id="L1153">  <span class="tok-comment">// return index-menu  ---&gt; arraylist panel-menu</span>
</span>
<span class="line" id="L1154">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getIndex</span>(vpnl: *pnl.PANEL , name: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> )  ErrForms ! <span class="tok-type">usize</span> {</span>
<span class="line" id="L1155"></span>
<span class="line" id="L1156">    <span class="tok-kw">for</span> (vpnl.menu.items, <span class="tok-number">0</span>..) |l, idx| {</span>
<span class="line" id="L1157">      <span class="tok-kw">if</span> (std.mem.eql(<span class="tok-type">u8</span>, l.name, name)) <span class="tok-kw">return</span> idx;</span>
<span class="line" id="L1158">    }</span>
<span class="line" id="L1159">    <span class="tok-kw">return</span> ErrForms.mnu_getIndex_Name_Menu_Invalide;</span>
<span class="line" id="L1160">  }</span>
<span class="line" id="L1161"></span>
<span class="line" id="L1162">  <span class="tok-comment">// return name-menu ---&gt; arraylist panel-menu</span>
</span>
<span class="line" id="L1163">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getName</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>) ErrForms ! [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> {</span>
<span class="line" id="L1164">    <span class="tok-kw">if</span> ( n &lt; vpnl.menu.items.len) <span class="tok-kw">return</span> vpnl.menu.items[n].name;</span>
<span class="line" id="L1165">    <span class="tok-kw">return</span> ErrForms.mnu_getName_Index_invalide ;</span>
<span class="line" id="L1166"></span>
<span class="line" id="L1167">  }</span>
<span class="line" id="L1168"></span>
<span class="line" id="L1169">  <span class="tok-comment">// return posx-menu ---&gt; arraylist panel-menu</span>
</span>
<span class="line" id="L1170">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getPosx</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">usize</span> {</span>
<span class="line" id="L1171">    <span class="tok-kw">if</span> ( n &lt; vpnl.menu.items.len) <span class="tok-kw">return</span> vpnl.menu.items[n].posx;</span>
<span class="line" id="L1172">    <span class="tok-kw">return</span> ErrForms.mnu_getPosx_Index_invalide ;</span>
<span class="line" id="L1173">  }</span>
<span class="line" id="L1174"></span>
<span class="line" id="L1175">  <span class="tok-comment">// return posy-menu ---&gt; arraylist panel-menu</span>
</span>
<span class="line" id="L1176">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getPosy</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">usize</span> {</span>
<span class="line" id="L1177">    <span class="tok-kw">if</span> ( n &lt; vpnl.menu.items.len) <span class="tok-kw">return</span> vpnl.menu.items[n].posy;</span>
<span class="line" id="L1178">    <span class="tok-kw">return</span> ErrForms.mnu_getPosy_Index_invalide ;</span>
<span class="line" id="L1179">  }</span>
<span class="line" id="L1180"></span>
<span class="line" id="L1181">  <span class="tok-comment">// return Text-menu ---&gt; arraylist panel-menu</span>
</span>
<span class="line" id="L1182">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getText</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">usize</span> {</span>
<span class="line" id="L1183">    <span class="tok-kw">if</span> ( n &lt; vpnl.menu.items.len) <span class="tok-kw">return</span> vpnl.menu.items[n].text;</span>
<span class="line" id="L1184">    <span class="tok-kw">return</span> ErrForms.mnu_getText_Index_invalide ;</span>
<span class="line" id="L1185">  }</span>
<span class="line" id="L1186"></span>
<span class="line" id="L1187">  <span class="tok-comment">// return ON/OFF-menu ---&gt; arraylist panel-menu</span>
</span>
<span class="line" id="L1188">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getActif</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">bool</span> {</span>
<span class="line" id="L1189">    <span class="tok-kw">if</span> ( n &lt; vpnl.menu.items.len) <span class="tok-kw">return</span> vpnl.menu.items[n].actif;</span>
<span class="line" id="L1190">    <span class="tok-kw">return</span> ErrForms.mnu_getActif_Index_invalide ;</span>
<span class="line" id="L1191">  }</span>
<span class="line" id="L1192"></span>
<span class="line" id="L1193"></span>
<span class="line" id="L1194">  <span class="tok-comment">// delete -menu ---&gt; arraylist panel-menu</span>
</span>
<span class="line" id="L1195">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">dltRows</span>(vpnl: *pnl.PANEL,  n :<span class="tok-type">usize</span> ) ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L1196">    <span class="tok-kw">if</span> ( n &lt; vpnl.button.items.len) _= vpnl.menu.orderedRemove(n)</span>
<span class="line" id="L1197">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.mnu_dltRows_Index_invalide ;</span>
<span class="line" id="L1198">  }</span>
<span class="line" id="L1199"></span>
<span class="line" id="L1200"></span>
<span class="line" id="L1201">  <span class="tok-comment">// assign -menu MATRIX TERMINAL  ---&gt; arraylist panel-menu</span>
</span>
<span class="line" id="L1202">  <span class="tok-kw">fn</span> <span class="tok-fn">printMenu</span>(vpnl: *pnl.PANEL, vmnu: MENU) <span class="tok-type">void</span> {</span>
<span class="line" id="L1203">    <span class="tok-kw">if</span> (vpnl.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span> ;</span>
<span class="line" id="L1204">    <span class="tok-kw">const</span> ACS_Hlines  = <span class="tok-str">&quot;─&quot;</span>;</span>
<span class="line" id="L1205">    <span class="tok-kw">const</span> ACS_Vlines  = <span class="tok-str">&quot;│&quot;</span>;</span>
<span class="line" id="L1206">    <span class="tok-kw">const</span> ACS_UCLEFT  = <span class="tok-str">&quot;┌&quot;</span>;</span>
<span class="line" id="L1207">    <span class="tok-kw">const</span> ACS_UCRIGHT = <span class="tok-str">&quot;┐&quot;</span>;</span>
<span class="line" id="L1208">    <span class="tok-kw">const</span> ACS_LCLEFT  = <span class="tok-str">&quot;└&quot;</span>;</span>
<span class="line" id="L1209">    <span class="tok-kw">const</span> ACS_LCRIGHT = <span class="tok-str">&quot;┘&quot;</span>;</span>
<span class="line" id="L1210"></span>
<span class="line" id="L1211">    <span class="tok-kw">const</span> ACS_Hline2    = <span class="tok-str">&quot;═&quot;</span>;</span>
<span class="line" id="L1212">    <span class="tok-kw">const</span> ACS_Vline2    = <span class="tok-str">&quot;║&quot;</span>;</span>
<span class="line" id="L1213">    <span class="tok-kw">const</span> ACS_UCLEFT2   = <span class="tok-str">&quot;╔&quot;</span>;</span>
<span class="line" id="L1214">    <span class="tok-kw">const</span> ACS_UCRIGHT2  = <span class="tok-str">&quot;╗&quot;</span>;</span>
<span class="line" id="L1215">    <span class="tok-kw">const</span> ACS_LCLEFT2   = <span class="tok-str">&quot;╚&quot;</span>;</span>
<span class="line" id="L1216">    <span class="tok-kw">const</span> ACS_LCRIGHT2  = <span class="tok-str">&quot;╝&quot;</span>;</span>
<span class="line" id="L1217"></span>
<span class="line" id="L1218">    <span class="tok-kw">var</span> trait: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;&quot;</span>;</span>
<span class="line" id="L1219">    <span class="tok-kw">var</span> edt :<span class="tok-type">bool</span>   = <span class="tok-null">undefined</span> ;</span>
<span class="line" id="L1220"></span>
<span class="line" id="L1221">    <span class="tok-kw">var</span> row:  <span class="tok-type">usize</span> = <span class="tok-number">1</span> ;</span>
<span class="line" id="L1222">    <span class="tok-kw">var</span> y:    <span class="tok-type">usize</span> = <span class="tok-number">0</span> ;</span>
<span class="line" id="L1223">    <span class="tok-kw">var</span> col:  <span class="tok-type">usize</span> = <span class="tok-number">0</span> ;</span>
<span class="line" id="L1224"></span>
<span class="line" id="L1225">    <span class="tok-kw">var</span> x :<span class="tok-type">usize</span> =  vmnu.posx - <span class="tok-number">1</span> ;</span>
<span class="line" id="L1226"></span>
<span class="line" id="L1227">    <span class="tok-comment">// if line 0 ex: directory tab</span>
</span>
<span class="line" id="L1228">    <span class="tok-kw">if</span> (dds.CADRE.line0 != vmnu.cadre ) {</span>
<span class="line" id="L1229">      <span class="tok-kw">while</span> (row &lt;= vmnu.lines) : (row +=<span class="tok-number">1</span>) {</span>
<span class="line" id="L1230">        y = vmnu.posy - <span class="tok-number">1</span>;</span>
<span class="line" id="L1231">        col = <span class="tok-number">1</span>;</span>
<span class="line" id="L1232">        <span class="tok-kw">while</span> ( col &lt;= vmnu.cols ){</span>
<span class="line" id="L1233">          edt = <span class="tok-null">false</span>;</span>
<span class="line" id="L1234">          <span class="tok-kw">if</span> (row == <span class="tok-number">1</span>) {</span>
<span class="line" id="L1235">              <span class="tok-kw">if</span> (col == <span class="tok-number">1</span>) {</span>
<span class="line" id="L1236">                <span class="tok-kw">if</span> ( dds.CADRE.line1 == vmnu.cadre ) {</span>
<span class="line" id="L1237">                    trait = ACS_UCLEFT;</span>
<span class="line" id="L1238">                } <span class="tok-kw">else</span>  trait = ACS_UCLEFT2 ;</span>
<span class="line" id="L1239">                edt = <span class="tok-null">true</span>;</span>
<span class="line" id="L1240">              }</span>
<span class="line" id="L1241">              <span class="tok-kw">if</span> ( col == vmnu.cols ) {</span>
<span class="line" id="L1242">                <span class="tok-kw">if</span> (dds.CADRE.line1 == vmnu.cadre) {</span>
<span class="line" id="L1243">                  trait = ACS_UCRIGHT;</span>
<span class="line" id="L1244">                } <span class="tok-kw">else</span>  trait = ACS_UCRIGHT2 ;</span>
<span class="line" id="L1245">                edt = <span class="tok-null">true</span>;</span>
<span class="line" id="L1246">              }</span>
<span class="line" id="L1247">              <span class="tok-kw">if</span> ( col &gt; <span class="tok-number">1</span> <span class="tok-kw">and</span> col &lt; vmnu.cols ) {</span>
<span class="line" id="L1248">                <span class="tok-kw">if</span> (dds.CADRE.line1 == vmnu.cadre ) {</span>
<span class="line" id="L1249">                  trait = ACS_Hlines;</span>
<span class="line" id="L1250">                } <span class="tok-kw">else</span>  trait = ACS_Hline2;</span>
<span class="line" id="L1251">                edt = <span class="tok-null">true</span>;</span>
<span class="line" id="L1252">              }</span>
<span class="line" id="L1253">          } <span class="tok-kw">else</span> <span class="tok-kw">if</span> ( row == vmnu.lines ) {</span>
<span class="line" id="L1254">              <span class="tok-kw">if</span> (col == <span class="tok-number">1</span>) {</span>
<span class="line" id="L1255">                <span class="tok-kw">if</span> ( dds.CADRE.line1 == vmnu.cadre ) {</span>
<span class="line" id="L1256">                  trait = ACS_LCLEFT;</span>
<span class="line" id="L1257">                } <span class="tok-kw">else</span>  trait = ACS_LCLEFT2;</span>
<span class="line" id="L1258">                edt = <span class="tok-null">true</span>;</span>
<span class="line" id="L1259">              }</span>
<span class="line" id="L1260">              <span class="tok-kw">if</span> ( col == vmnu.cols ) {</span>
<span class="line" id="L1261">                <span class="tok-kw">if</span> ( dds.CADRE.line1 == vmnu.cadre ) {</span>
<span class="line" id="L1262">                  trait = ACS_LCRIGHT;</span>
<span class="line" id="L1263">                } <span class="tok-kw">else</span>  trait = ACS_LCRIGHT2 ;</span>
<span class="line" id="L1264">                edt = <span class="tok-null">true</span> ;</span>
<span class="line" id="L1265">              }</span>
<span class="line" id="L1266">              <span class="tok-kw">if</span> ( col &gt; <span class="tok-number">1</span> <span class="tok-kw">and</span> col &lt; vmnu.cols ) {</span>
<span class="line" id="L1267">                <span class="tok-kw">if</span> ( dds.CADRE.line1 == vmnu.cadre ) {</span>
<span class="line" id="L1268">                  trait = ACS_Hlines;</span>
<span class="line" id="L1269">                } <span class="tok-kw">else</span>  trait = ACS_Hline2 ;</span>
<span class="line" id="L1270">                edt = <span class="tok-null">true</span>;</span>
<span class="line" id="L1271">              }</span>
<span class="line" id="L1272">          } <span class="tok-kw">else</span> <span class="tok-kw">if</span> ( row &gt; <span class="tok-number">1</span> <span class="tok-kw">and</span> row &lt; vmnu.lines ) {</span>
<span class="line" id="L1273">            <span class="tok-kw">if</span> ( col == <span class="tok-number">1</span> <span class="tok-kw">or</span> col == vmnu.cols ) {</span>
<span class="line" id="L1274">              <span class="tok-kw">if</span> ( dds.CADRE.line1 == vmnu.cadre ) {</span>
<span class="line" id="L1275">                trait = ACS_Vlines;</span>
<span class="line" id="L1276">              } <span class="tok-kw">else</span> trait = ACS_Vline2 ;</span>
<span class="line" id="L1277">              edt = <span class="tok-null">true</span>;</span>
<span class="line" id="L1278">            }</span>
<span class="line" id="L1279">          }</span>
<span class="line" id="L1280">          <span class="tok-kw">if</span>  ( edt ) {</span>
<span class="line" id="L1281">            term.gotoXY(row + vmnu.posx + vpnl.posx - <span class="tok-number">2</span>  , col + vmnu.posy + vpnl.posy - <span class="tok-number">2</span>);</span>
<span class="line" id="L1282">            term.writeStyled(trait,vmnu.attribut);</span>
<span class="line" id="L1283">          }</span>
<span class="line" id="L1284">          <span class="tok-kw">else</span> {</span>
<span class="line" id="L1285">            term.gotoXY(row + vmnu.posx + vpnl.posx - <span class="tok-number">2</span>  , col + vmnu.posy + vpnl.posy - <span class="tok-number">2</span>);</span>
<span class="line" id="L1286">            term.writeStyled(<span class="tok-str">&quot; &quot;</span>,vmnu.attribut);</span>
<span class="line" id="L1287">          }</span>
<span class="line" id="L1288"></span>
<span class="line" id="L1289">          y += <span class="tok-number">1</span>;</span>
<span class="line" id="L1290">          col += <span class="tok-number">1</span>;</span>
<span class="line" id="L1291">        }</span>
<span class="line" id="L1292">        x += <span class="tok-number">1</span>;</span>
<span class="line" id="L1293">      }</span>
<span class="line" id="L1294">    }</span>
<span class="line" id="L1295"></span>
<span class="line" id="L1296"></span>
<span class="line" id="L1297">  }</span>
<span class="line" id="L1298"></span>
<span class="line" id="L1299">  <span class="tok-comment">// display  MATRIX to terminal ---&gt; arraylist panel-menu</span>
</span>
<span class="line" id="L1300">  <span class="tok-kw">fn</span> <span class="tok-fn">displayMenu</span>(vpnl: *pnl.PANEL, vmnu:MENU, npos: <span class="tok-type">usize</span>) <span class="tok-type">void</span> {</span>
<span class="line" id="L1301">    <span class="tok-kw">var</span> pos : <span class="tok-type">usize</span> = npos;</span>
<span class="line" id="L1302">    <span class="tok-kw">var</span> n : <span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L1303">    <span class="tok-kw">var</span> h : <span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L1304"></span>
<span class="line" id="L1305">    <span class="tok-kw">var</span> x :<span class="tok-type">usize</span> = vmnu.posx - <span class="tok-number">1</span>;</span>
<span class="line" id="L1306">    <span class="tok-kw">var</span> y :<span class="tok-type">usize</span> = vmnu.posy - <span class="tok-number">1</span>;</span>
<span class="line" id="L1307"></span>
<span class="line" id="L1308">    printMenu(vpnl, vmnu);</span>
<span class="line" id="L1309"></span>
<span class="line" id="L1310">    term.onMouse();</span>
<span class="line" id="L1311">    term.cursHide();</span>
<span class="line" id="L1312"></span>
<span class="line" id="L1313"></span>
<span class="line" id="L1314">    <span class="tok-kw">if</span> (npos &gt; vmnu.nbr <span class="tok-kw">or</span> npos == <span class="tok-number">0</span> )  pos = <span class="tok-number">0</span>  ;</span>
<span class="line" id="L1315"></span>
<span class="line" id="L1316">    n = <span class="tok-number">0</span>;</span>
<span class="line" id="L1317">    h = <span class="tok-number">0</span>;</span>
<span class="line" id="L1318">    <span class="tok-kw">for</span> (vmnu.xitems) | cell |  {</span>
<span class="line" id="L1319">      <span class="tok-kw">if</span> (vmnu.mnuvh == dds.MNUVH.vertical) {</span>
<span class="line" id="L1320">        <span class="tok-kw">if</span> (vmnu.cadre == dds.CADRE.line0)</span>
<span class="line" id="L1321">          term.gotoXY(vpnl.posx + x + n  ,    vpnl.posy + y  )</span>
<span class="line" id="L1322">        <span class="tok-kw">else</span></span>
<span class="line" id="L1323">          term.gotoXY(vpnl.posx + x + n + <span class="tok-number">1</span> , vpnl.posy + y  + <span class="tok-number">1</span>);</span>
<span class="line" id="L1324">      }</span>
<span class="line" id="L1325">      <span class="tok-kw">if</span> (vmnu.mnuvh == dds.MNUVH.horizontal) {</span>
<span class="line" id="L1326">        <span class="tok-kw">if</span> (vmnu.cadre == dds.CADRE.line0 )</span>
<span class="line" id="L1327">          term.gotoXY(vpnl.posx + x  ,    h   + vpnl.posy + y   )</span>
<span class="line" id="L1328">        <span class="tok-kw">else</span></span>
<span class="line" id="L1329">          term.gotoXY(vpnl.posx + x + <span class="tok-number">1</span>  , h  + vpnl.posy + y  + <span class="tok-number">1</span>);</span>
<span class="line" id="L1330">      }</span>
<span class="line" id="L1331">      <span class="tok-comment">//var xcell = utl.Trim(cell);</span>
</span>
<span class="line" id="L1332">      <span class="tok-kw">if</span> (pos == n)</span>
<span class="line" id="L1333">        term.writeStyled(cell,vmnu.attrBar)</span>
<span class="line" id="L1334">      <span class="tok-kw">else</span></span>
<span class="line" id="L1335">        term.writeStyled(cell,vmnu.attrCell);</span>
<span class="line" id="L1336"></span>
<span class="line" id="L1337">      n += <span class="tok-number">1</span>;</span>
<span class="line" id="L1338">      h += utl.nbrCharStr(cell);</span>
<span class="line" id="L1339">      <span class="tok-kw">if</span> (vmnu.mnuvh == dds.MNUVH.horizontal) h += mnuspc;</span>
<span class="line" id="L1340">    }</span>
<span class="line" id="L1341">  }</span>
<span class="line" id="L1342"></span>
<span class="line" id="L1343">  <span class="tok-comment">// restor -panel  MATRIX to terminal ---&gt; arraylist panel-menu </span>
</span>
<span class="line" id="L1344">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">rstPanel</span>( vsrc : *MENU , vdst : *pnl.PANEL) <span class="tok-type">void</span> {</span>
<span class="line" id="L1345">    <span class="tok-kw">if</span> (vdst.actif == <span class="tok-null">false</span>)  <span class="tok-kw">return</span> ;</span>
<span class="line" id="L1346">    <span class="tok-kw">if</span> (vsrc.posx + vsrc.lines &gt; vdst.posx + vdst.lines  )  <span class="tok-kw">return</span> ;</span>
<span class="line" id="L1347">    <span class="tok-kw">if</span> (vsrc.posy + vsrc.cols  &gt; vdst.posy + vdst.cols  )  <span class="tok-kw">return</span> ;</span>
<span class="line" id="L1348">    <span class="tok-kw">var</span> x :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L1349">    <span class="tok-kw">var</span> y :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L1350">    <span class="tok-kw">var</span> n :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L1351">    <span class="tok-kw">var</span> npos : <span class="tok-type">usize</span> =  vsrc.posx - vdst.posx;</span>
<span class="line" id="L1352">    <span class="tok-kw">while</span> (x &lt;= vsrc.lines) : (x += <span class="tok-number">1</span>) {</span>
<span class="line" id="L1353">        n = vdst.cols * npos + vsrc.posy - vdst.posy  ;</span>
<span class="line" id="L1354">        y = <span class="tok-number">0</span>;</span>
<span class="line" id="L1355">        <span class="tok-kw">while</span> (y &lt;= vsrc.cols) : (y += <span class="tok-number">1</span>) {</span>
<span class="line" id="L1356">          term.gotoXY(x + vsrc.posx   , y + vsrc.posy  );</span>
<span class="line" id="L1357">          term.writeStyled(vdst.buf.items[n].ch,vdst.buf.items[n].attribut);</span>
<span class="line" id="L1358">          n += <span class="tok-number">1</span>;</span>
<span class="line" id="L1359">        }</span>
<span class="line" id="L1360">      npos += <span class="tok-number">1</span>;</span>
<span class="line" id="L1361">    }</span>
<span class="line" id="L1362">  }</span>
<span class="line" id="L1363">  <span class="tok-comment">//----------------------------------------------------------------</span>
</span>
<span class="line" id="L1364">  <span class="tok-comment">// menu  enter = select  1..n 0 = abort (Escape)</span>
</span>
<span class="line" id="L1365">  <span class="tok-comment">// Turning on the mouse</span>
</span>
<span class="line" id="L1366">  <span class="tok-comment">// UP DOWN LEFT RIGHT</span>
</span>
<span class="line" id="L1367">  <span class="tok-comment">// movement width the wheel and validation width the clik</span>
</span>
<span class="line" id="L1368">  <span class="tok-comment">//----------------------------------------------------------------</span>
</span>
<span class="line" id="L1369">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">ioMenu</span>(vpnl: *pnl.PANEL, vmnu: MENU, npos: <span class="tok-type">usize</span>) <span class="tok-type">usize</span> {</span>
<span class="line" id="L1370">    <span class="tok-kw">if</span> (vpnl.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span> <span class="tok-number">999</span> ;</span>
<span class="line" id="L1371">    <span class="tok-kw">if</span> (vmnu.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span> <span class="tok-number">999</span> ;</span>
<span class="line" id="L1372">    <span class="tok-kw">var</span> pos : <span class="tok-type">usize</span> = npos;</span>
<span class="line" id="L1373">    <span class="tok-kw">var</span> n   : <span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L1374">    <span class="tok-kw">var</span> h   : <span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L1375">    <span class="tok-kw">var</span> x :<span class="tok-type">usize</span> = vmnu.posx - <span class="tok-number">1</span>;</span>
<span class="line" id="L1376">    <span class="tok-kw">var</span> y :<span class="tok-type">usize</span> = vmnu.posy - <span class="tok-number">1</span>;</span>
<span class="line" id="L1377"></span>
<span class="line" id="L1378">    term.onMouse();</span>
<span class="line" id="L1379">    term.cursHide();</span>
<span class="line" id="L1380"></span>
<span class="line" id="L1381"></span>
<span class="line" id="L1382"></span>
<span class="line" id="L1383">    <span class="tok-kw">if</span> (npos &gt; vmnu.nbr <span class="tok-kw">or</span> npos == <span class="tok-number">0</span> )  pos = <span class="tok-number">0</span>;</span>
<span class="line" id="L1384"></span>
<span class="line" id="L1385"></span>
<span class="line" id="L1386">    displayMenu(vpnl,vmnu,pos);</span>
<span class="line" id="L1387"></span>
<span class="line" id="L1388"></span>
<span class="line" id="L1389">    term.flushIO();</span>
<span class="line" id="L1390">    <span class="tok-kw">while</span> (<span class="tok-null">true</span>) {</span>
<span class="line" id="L1391">      n = <span class="tok-number">0</span>;</span>
<span class="line" id="L1392">      h = <span class="tok-number">0</span>;</span>
<span class="line" id="L1393">      <span class="tok-kw">for</span> (vmnu.xitems) | cell |  {</span>
<span class="line" id="L1394"></span>
<span class="line" id="L1395">        <span class="tok-kw">if</span> (vmnu.mnuvh == dds.MNUVH.vertical) {</span>
<span class="line" id="L1396">          <span class="tok-kw">if</span> (vmnu.cadre == dds.CADRE.line0 )</span>
<span class="line" id="L1397">            term.gotoXY(vpnl.posx + x  + n  ,   vpnl.posy + y )</span>
<span class="line" id="L1398">          <span class="tok-kw">else</span></span>
<span class="line" id="L1399">            term.gotoXY(vpnl.posx + x  + n + <span class="tok-number">1</span>, vpnl.posy + y + <span class="tok-number">1</span>);</span>
<span class="line" id="L1400">          }</span>
<span class="line" id="L1401">        <span class="tok-kw">if</span> (vmnu.mnuvh == dds.MNUVH.horizontal) {</span>
<span class="line" id="L1402">          <span class="tok-kw">if</span> (vmnu.cadre == dds.CADRE.line0)</span>
<span class="line" id="L1403">            term.gotoXY(vpnl.posx + x   ,   h + vpnl.posy + y )</span>
<span class="line" id="L1404">          <span class="tok-kw">else</span></span>
<span class="line" id="L1405">            term.gotoXY(vpnl.posx + x  + <span class="tok-number">1</span>, h + vpnl.posy + y + <span class="tok-number">1</span>);</span>
<span class="line" id="L1406">        }</span>
<span class="line" id="L1407">        <span class="tok-kw">if</span> (pos == n)</span>
<span class="line" id="L1408">          term.writeStyled(cell,vmnu.attrBar)</span>
<span class="line" id="L1409">        <span class="tok-kw">else</span></span>
<span class="line" id="L1410">          term.writeStyled(cell,vmnu.attrCell);</span>
<span class="line" id="L1411"></span>
<span class="line" id="L1412">        n += <span class="tok-number">1</span>;</span>
<span class="line" id="L1413">        h += utl.nbrCharStr(cell);</span>
<span class="line" id="L1414">        <span class="tok-kw">if</span> (vmnu.mnuvh == dds.MNUVH.horizontal) h += mnuspc;</span>
<span class="line" id="L1415">      }</span>
<span class="line" id="L1416"></span>
<span class="line" id="L1417">      <span class="tok-kw">var</span> Tkey  = kbd.getKEY();</span>
<span class="line" id="L1418"></span>
<span class="line" id="L1419">      <span class="tok-kw">if</span> (Tkey.Key == kbd.char <span class="tok-kw">and</span></span>
<span class="line" id="L1420">          std.mem.eql(<span class="tok-type">u8</span>,Tkey.Char,<span class="tok-str">&quot; &quot;</span> ) ) {Tkey.Key = kbd.enter; Tkey.Char =<span class="tok-str">&quot;&quot;</span>;}</span>
<span class="line" id="L1421"></span>
<span class="line" id="L1422"></span>
<span class="line" id="L1423">      <span class="tok-kw">if</span> (Tkey.Key == kbd.mouse) {</span>
<span class="line" id="L1424">        Tkey.Key = kbd.none;</span>
<span class="line" id="L1425">        <span class="tok-kw">if</span> (term.MouseInfo.scroll ) {</span>
<span class="line" id="L1426">          <span class="tok-kw">if</span> ( term.MouseInfo.scrollDir == term.ScrollDirection.msUp ) {</span>
<span class="line" id="L1427">            <span class="tok-kw">if</span> (vmnu.mnuvh == dds.MNUVH.vertical)    Tkey.Key = kbd.up;</span>
<span class="line" id="L1428">            <span class="tok-kw">if</span> (vmnu.mnuvh == dds.MNUVH.horizontal)  Tkey.Key = kbd.left;</span>
<span class="line" id="L1429">          }</span>
<span class="line" id="L1430"></span>
<span class="line" id="L1431">          <span class="tok-kw">if</span> (term.MouseInfo.scrollDir == term.ScrollDirection.msDown) {</span>
<span class="line" id="L1432">            <span class="tok-kw">if</span> (vmnu.mnuvh == dds.MNUVH.vertical)    Tkey.Key = kbd.down;</span>
<span class="line" id="L1433">            <span class="tok-kw">if</span> (vmnu.mnuvh == dds.MNUVH.horizontal)  Tkey.Key = kbd.right;</span>
<span class="line" id="L1434">          }</span>
<span class="line" id="L1435">        }</span>
<span class="line" id="L1436">        <span class="tok-kw">else</span> {</span>
<span class="line" id="L1437">          <span class="tok-kw">if</span> (term.MouseInfo.action == term.MouseAction.maReleased ) <span class="tok-kw">continue</span>;</span>
<span class="line" id="L1438">          <span class="tok-kw">switch</span> (term.MouseInfo.button) {</span>
<span class="line" id="L1439">            term.MouseButton.mbLeft    =&gt;  Tkey.Key = kbd.enter,</span>
<span class="line" id="L1440">            term.MouseButton.mbMiddle  =&gt;  Tkey.Key = kbd.enter,</span>
<span class="line" id="L1441">            term.MouseButton.mbRight   =&gt;  Tkey.Key = kbd.enter,</span>
<span class="line" id="L1442">            <span class="tok-kw">else</span> =&gt; {}</span>
<span class="line" id="L1443">          }</span>
<span class="line" id="L1444">        }</span>
<span class="line" id="L1445">      }</span>
<span class="line" id="L1446"></span>
<span class="line" id="L1447">      <span class="tok-kw">switch</span> (Tkey.Key) {</span>
<span class="line" id="L1448">        .none =&gt; <span class="tok-kw">continue</span>,</span>
<span class="line" id="L1449">        .esc  =&gt; {</span>
<span class="line" id="L1450">          term.offMouse();</span>
<span class="line" id="L1451">          <span class="tok-kw">return</span> <span class="tok-number">9999</span>;</span>
<span class="line" id="L1452">        },</span>
<span class="line" id="L1453">        .enter =&gt; {</span>
<span class="line" id="L1454">          term.offMouse();</span>
<span class="line" id="L1455">          <span class="tok-kw">return</span> pos ;</span>
<span class="line" id="L1456">        },</span>
<span class="line" id="L1457">        .down  =&gt; { <span class="tok-kw">if</span> (pos &lt; vmnu.nbr - <span class="tok-number">1</span> )  pos +=<span class="tok-number">1</span>; } ,</span>
<span class="line" id="L1458">        .up    =&gt; { <span class="tok-kw">if</span> (pos &gt; <span class="tok-number">0</span> ) pos -=<span class="tok-number">1</span>; },</span>
<span class="line" id="L1459">        .right =&gt; { <span class="tok-kw">if</span> (pos &lt; vmnu.nbr - <span class="tok-number">1</span> )  pos +=<span class="tok-number">1</span>; },</span>
<span class="line" id="L1460">        .left  =&gt; { <span class="tok-kw">if</span> (pos &gt; <span class="tok-number">0</span> ) pos -=<span class="tok-number">1</span>; },</span>
<span class="line" id="L1461">        <span class="tok-kw">else</span> =&gt; {},</span>
<span class="line" id="L1462">      }</span>
<span class="line" id="L1463">    }</span>
<span class="line" id="L1464">  }</span>
<span class="line" id="L1465"></span>
<span class="line" id="L1466">};</span>
<span class="line" id="L1467"></span>
<span class="line" id="L1468"></span>
<span class="line" id="L1469"></span>
<span class="line" id="L1470"></span>
<span class="line" id="L1471"><span class="tok-comment">// defined INPUT_FIELD</span>
</span>
<span class="line" id="L1472"><span class="tok-kw">pub</span> <span class="tok-kw">const</span>  fld = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L1473"></span>
<span class="line" id="L1474"></span>
<span class="line" id="L1475">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">ToStr</span>(text : [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> ) []<span class="tok-kw">const</span> <span class="tok-type">u8</span> {</span>
<span class="line" id="L1476">    <span class="tok-kw">return</span> std.fmt.allocPrint(dds.allocatorStr,<span class="tok-str">&quot;{s}&quot;</span>,.{text}) </span>
<span class="line" id="L1477">                  <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L1478">  }</span>
<span class="line" id="L1479"></span>
<span class="line" id="L1480">  <span class="tok-comment">// define attribut default Fiel</span>
</span>
<span class="line" id="L1481">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> AtrField : dds.ZONATRB = .{</span>
<span class="line" id="L1482">      .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1483">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1484">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1485">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L1486">      .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L1487">      .foregr = dds.ForegroundColor.fgWhite</span>
<span class="line" id="L1488">  };</span>
<span class="line" id="L1489"></span>
<span class="line" id="L1490">  <span class="tok-comment">// field not input</span>
</span>
<span class="line" id="L1491">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> AtrNil : dds.ZONATRB = .{</span>
<span class="line" id="L1492">      .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.styleDim),</span>
<span class="line" id="L1493">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1494">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1495">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L1496">      .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L1497">      .foregr = dds.ForegroundColor.fgdWhite</span>
<span class="line" id="L1498">  };</span>
<span class="line" id="L1499"></span>
<span class="line" id="L1500">  <span class="tok-comment">// define attribut default func ioField</span>
</span>
<span class="line" id="L1501">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> AtrIO : dds.ZONATRB = .{</span>
<span class="line" id="L1502">      .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.styleReverse),</span>
<span class="line" id="L1503">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1504">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1505">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L1506">      .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L1507">      .foregr = dds.ForegroundColor.fgWhite,</span>
<span class="line" id="L1508">  };</span>
<span class="line" id="L1509"></span>
<span class="line" id="L1510">  <span class="tok-comment">// define attribut default Field protect</span>
</span>
<span class="line" id="L1511">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> AtrProtect : dds.ZONATRB = .{</span>
<span class="line" id="L1512">      .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.styleItalic),</span>
<span class="line" id="L1513">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1514">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1515">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L1516">      .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L1517">      .foregr = dds.ForegroundColor.fgCyan,</span>
<span class="line" id="L1518">  };</span>
<span class="line" id="L1519"></span>
<span class="line" id="L1520">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> AtrCursor : dds.ZONATRB = .{</span>
<span class="line" id="L1521">      .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1522">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1523">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1524">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L1525">      .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L1526">      .foregr = dds.ForegroundColor.fgCyan,</span>
<span class="line" id="L1527">  };</span>
<span class="line" id="L1528"></span>
<span class="line" id="L1529"></span>
<span class="line" id="L1530">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> MsgErr : dds.ZONATRB = .{</span>
<span class="line" id="L1531">      .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1532">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1533">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L1534">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L1535">      .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L1536">      .foregr = dds.ForegroundColor.fgRed</span>
<span class="line" id="L1537">  };</span>
<span class="line" id="L1538"></span>
<span class="line" id="L1539"></span>
<span class="line" id="L1540">  <span class="tok-comment">/// define FIELD</span></span>
<span class="line" id="L1541">  <span class="tok-kw">pub</span> <span class="tok-kw">const</span> FIELD = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L1542">    name :  []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1543">    posx:   <span class="tok-type">usize</span>,</span>
<span class="line" id="L1544">    posy:   <span class="tok-type">usize</span>,</span>
<span class="line" id="L1545">    attribut:dds.ZONATRB,</span>
<span class="line" id="L1546">    atrProtect:dds.ZONATRB,</span>
<span class="line" id="L1547">    reftyp: dds.REFTYP,</span>
<span class="line" id="L1548">    width:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L1549">    scal:   <span class="tok-type">usize</span>,</span>
<span class="line" id="L1550">    nbrcar: <span class="tok-type">usize</span>,        <span class="tok-comment">// nbrcar DECIMAL = (precision+scale + 1'.' ) + 1 this signed || other nbrcar =  ALPA..DIGIT..</span>
</span>
<span class="line" id="L1551"></span>
<span class="line" id="L1552">    requier: <span class="tok-type">bool</span>,          <span class="tok-comment">// requier or FULL</span>
</span>
<span class="line" id="L1553">    protect: <span class="tok-type">bool</span>,        <span class="tok-comment">// only display</span>
</span>
<span class="line" id="L1554"></span>
<span class="line" id="L1555">    pading: <span class="tok-type">bool</span>,         <span class="tok-comment">// pading blank</span>
</span>
<span class="line" id="L1556">    edtcar: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,   <span class="tok-comment">// edtcar for monnaie		€ $ ¥ ₪ £ or %</span>
</span>
<span class="line" id="L1557"></span>
<span class="line" id="L1558">    regex: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,    <span class="tok-comment">//contrôle regex</span>
</span>
<span class="line" id="L1559">    errmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,   <span class="tok-comment">//message this field</span>
</span>
<span class="line" id="L1560"></span>
<span class="line" id="L1561">    help: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,     <span class="tok-comment">//help this field</span>
</span>
<span class="line" id="L1562"></span>
<span class="line" id="L1563">    text: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1564">    zwitch: <span class="tok-type">bool</span>,         <span class="tok-comment">// CTRUE CFALSE</span>
</span>
<span class="line" id="L1565"></span>
<span class="line" id="L1566">    procfunc: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,  <span class="tok-comment">//name proc</span>
</span>
<span class="line" id="L1567"></span>
<span class="line" id="L1568">    proctask: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,  <span class="tok-comment">//name proc</span>
</span>
<span class="line" id="L1569"></span>
<span class="line" id="L1570">    actif:<span class="tok-type">bool</span>,</span>
<span class="line" id="L1571">  };</span>
<span class="line" id="L1572"></span>
<span class="line" id="L1573">  <span class="tok-comment">// for developpeur </span>
</span>
<span class="line" id="L1574">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> MouseDsp : <span class="tok-type">bool</span> = <span class="tok-null">false</span> ;</span>
<span class="line" id="L1575"></span>
<span class="line" id="L1576"></span>
<span class="line" id="L1577"></span>
<span class="line" id="L1578"></span>
<span class="line" id="L1579"></span>
<span class="line" id="L1580">  <span class="tok-comment">// New Field String ---&gt; arraylist panel-label</span>
</span>
<span class="line" id="L1581">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L1582">  <span class="tok-comment">// TEXT_FREE,</span>
</span>
<span class="line" id="L1583">  <span class="tok-comment">// ALPHA,</span>
</span>
<span class="line" id="L1584">  <span class="tok-comment">// ALPHA_UPPER,</span>
</span>
<span class="line" id="L1585">  <span class="tok-comment">// ALPHA_NUMERIC,</span>
</span>
<span class="line" id="L1586">  <span class="tok-comment">// ALPHA_NUMERIC_UPPER,</span>
</span>
<span class="line" id="L1587">  <span class="tok-comment">// ALPHA_FULL,</span>
</span>
<span class="line" id="L1588">  <span class="tok-comment">// PASSWORD,</span>
</span>
<span class="line" id="L1589">  <span class="tok-comment">// YES_NO,</span>
</span>
<span class="line" id="L1590">  <span class="tok-kw">fn</span> <span class="tok-fn">initFieldString</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1591">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L1592">                    vreftyp: dds.REFTYP,</span>
<span class="line" id="L1593">                    vwidth:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L1594">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1595">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L1596">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1597">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1598">                    vregex: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L1599"></span>
<span class="line" id="L1600">    <span class="tok-kw">var</span> xfield = FIELD {   </span>
<span class="line" id="L1601">        .name   = vname,</span>
<span class="line" id="L1602">        .posx   = vposx,</span>
<span class="line" id="L1603">        .posy   = vposy,</span>
<span class="line" id="L1604">        .reftyp = vreftyp,</span>
<span class="line" id="L1605">        .width  = vwidth,</span>
<span class="line" id="L1606">        .scal   = <span class="tok-number">0</span>,</span>
<span class="line" id="L1607">        .nbrcar = vwidth,</span>
<span class="line" id="L1608">        .requier  = vrequier,</span>
<span class="line" id="L1609">        .protect = <span class="tok-null">false</span>,</span>
<span class="line" id="L1610">        .pading  = <span class="tok-null">true</span>,</span>
<span class="line" id="L1611">        .edtcar =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1612">        .regex  = <span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1613">        .errmsg = verrmsg,</span>
<span class="line" id="L1614">        .help   = vhelp,</span>
<span class="line" id="L1615">        .text   = vtext,</span>
<span class="line" id="L1616">        .zwitch = <span class="tok-null">false</span>,</span>
<span class="line" id="L1617">        .procfunc  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1618">        .proctask  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1619">        .attribut  = AtrField,</span>
<span class="line" id="L1620">        .atrProtect = AtrProtect,</span>
<span class="line" id="L1621">        .actif  = <span class="tok-null">true</span></span>
<span class="line" id="L1622">    };</span>
<span class="line" id="L1623">    <span class="tok-kw">if</span> (vregex.len &gt; <span class="tok-number">0</span> ) xfield.regex = std.fmt.allocPrint(dds.allocatorPnl,</span>
<span class="line" id="L1624">      <span class="tok-str">&quot;{s}&quot;</span>,.{vregex}) <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L1625">    <span class="tok-kw">return</span> xfield;</span>
<span class="line" id="L1626"></span>
<span class="line" id="L1627">  }</span>
<span class="line" id="L1628"></span>
<span class="line" id="L1629">  <span class="tok-comment">// New Field String  ---&gt; arraylist panel-lfield</span>
</span>
<span class="line" id="L1630">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L1631">  <span class="tok-comment">// .TEXT_FREE</span>
</span>
<span class="line" id="L1632">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldTextFree</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1633">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L1634">                    vwidth:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L1635">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1636">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L1637">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1638">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1639">                    vregex: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L1640"></span>
<span class="line" id="L1641">    <span class="tok-kw">return</span> initFieldString(vname,  vposx, vposy,</span>
<span class="line" id="L1642">                          dds.REFTYP.TEXT_FREE,</span>
<span class="line" id="L1643">                          vwidth, vtext, vrequier, verrmsg, vhelp, vregex);</span>
<span class="line" id="L1644">  }</span>
<span class="line" id="L1645"></span>
<span class="line" id="L1646">  <span class="tok-comment">// New Field String  ---&gt; arraylist panel-lfield</span>
</span>
<span class="line" id="L1647">  <span class="tok-comment">// letter numeric punct </span>
</span>
<span class="line" id="L1648">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L1649">  <span class="tok-comment">// .TEXT_FULL</span>
</span>
<span class="line" id="L1650">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldTextFull</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1651">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L1652">                    vwidth:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L1653">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1654">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L1655">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1656">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1657">                    vregex: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L1658"></span>
<span class="line" id="L1659">    <span class="tok-kw">return</span> initFieldString(vname,  vposx, vposy,</span>
<span class="line" id="L1660">                          dds.REFTYP.TEXT_FULL,</span>
<span class="line" id="L1661">                          vwidth, vtext, vrequier, verrmsg, vhelp, vregex);</span>
<span class="line" id="L1662">  }</span>
<span class="line" id="L1663"></span>
<span class="line" id="L1664">  <span class="tok-comment">// New Field String  ---&gt; arraylist panel-lfield</span>
</span>
<span class="line" id="L1665">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L1666">  <span class="tok-comment">// .ALPHA</span>
</span>
<span class="line" id="L1667">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldAlpha</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1668">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L1669">                    vwidth:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L1670">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1671">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L1672">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1673">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1674">                    vregex: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L1675">    </span>
<span class="line" id="L1676">    <span class="tok-kw">return</span> initFieldString(vname,  vposx, vposy,</span>
<span class="line" id="L1677">                          dds.REFTYP.ALPHA,</span>
<span class="line" id="L1678">                          vwidth, vtext, vrequier, verrmsg, vhelp, vregex);</span>
<span class="line" id="L1679">  }</span>
<span class="line" id="L1680"></span>
<span class="line" id="L1681">  <span class="tok-comment">// New Field String  ---&gt; arraylist panel-lfield</span>
</span>
<span class="line" id="L1682">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L1683">  <span class="tok-comment">// .ALPHA_UPPER</span>
</span>
<span class="line" id="L1684">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldAlphaUpper</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1685">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L1686">                    vwidth:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L1687">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1688">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L1689">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1690">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1691">                    vregex: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L1692"></span>
<span class="line" id="L1693">    <span class="tok-kw">return</span> initFieldString(vname,  vposx, vposy,</span>
<span class="line" id="L1694">                          dds.REFTYP.ALPHA_UPPER,</span>
<span class="line" id="L1695">                          vwidth, vtext, vrequier, verrmsg, vhelp, vregex);</span>
<span class="line" id="L1696">  }</span>
<span class="line" id="L1697"></span>
<span class="line" id="L1698">  <span class="tok-comment">// New Field String  ---&gt; arraylist panel-lfield</span>
</span>
<span class="line" id="L1699">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L1700">  <span class="tok-comment">// .ALPHA_NUMERIC</span>
</span>
<span class="line" id="L1701">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldAlphaNumeric</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1702">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L1703">                    vwidth:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L1704">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1705">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L1706">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1707">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1708">                    vregex: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L1709"></span>
<span class="line" id="L1710">    <span class="tok-kw">return</span> initFieldString(vname,  vposx, vposy,</span>
<span class="line" id="L1711">                          dds.REFTYP.ALPHA_NUMERIC,</span>
<span class="line" id="L1712">                          vwidth, vtext, vrequier, verrmsg, vhelp, vregex);</span>
<span class="line" id="L1713">  }</span>
<span class="line" id="L1714"></span>
<span class="line" id="L1715">  <span class="tok-comment">// New Field String  ---&gt; arraylist panel-lfield</span>
</span>
<span class="line" id="L1716">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L1717">  <span class="tok-comment">// .ALPHA_NUMERIC</span>
</span>
<span class="line" id="L1718">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldAlphaNumericUpper</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1719">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L1720">                    vwidth:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L1721">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1722">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L1723">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1724">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1725">                    vregex: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L1726"></span>
<span class="line" id="L1727">    <span class="tok-kw">return</span> initFieldString(vname,  vposx, vposy,</span>
<span class="line" id="L1728">                          dds.REFTYP.ALPHA_NUMERIC_UPPER,</span>
<span class="line" id="L1729">                          vwidth, vtext, vrequier, verrmsg, vhelp, vregex);</span>
<span class="line" id="L1730">  }</span>
<span class="line" id="L1731"></span>
<span class="line" id="L1732">  <span class="tok-comment">// New Field String  ---&gt; arraylist panel-lfield</span>
</span>
<span class="line" id="L1733">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L1734">  <span class="tok-comment">// .PASSWORD</span>
</span>
<span class="line" id="L1735">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldPassword</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1736">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L1737">                    vwidth:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L1738">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1739">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L1740">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1741">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1742">                    vregex: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L1743"></span>
<span class="line" id="L1744">    <span class="tok-kw">return</span> initFieldString(vname,  vposx, vposy,</span>
<span class="line" id="L1745">                          dds.REFTYP.PASSWORD,</span>
<span class="line" id="L1746">                          vwidth, vtext, vrequier, verrmsg, vhelp, vregex);</span>
<span class="line" id="L1747">  }</span>
<span class="line" id="L1748"></span>
<span class="line" id="L1749">  <span class="tok-comment">// New Field String  ---&gt; arraylist panel-lfield</span>
</span>
<span class="line" id="L1750">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L1751">  <span class="tok-comment">// .YES_NO</span>
</span>
<span class="line" id="L1752">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldYesNo</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1753">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L1754">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1755">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L1756">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1757">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L1758"></span>
<span class="line" id="L1759"></span>
<span class="line" id="L1760">        <span class="tok-kw">var</span> xfield = FIELD {   </span>
<span class="line" id="L1761">            .name   = vname,</span>
<span class="line" id="L1762">            .posx   = vposx,</span>
<span class="line" id="L1763">            .posy   = vposy,</span>
<span class="line" id="L1764">            .reftyp = dds.REFTYP.YES_NO ,</span>
<span class="line" id="L1765">            .width  = <span class="tok-number">1</span>,</span>
<span class="line" id="L1766">            .scal   = <span class="tok-number">0</span>,</span>
<span class="line" id="L1767">            .nbrcar = <span class="tok-number">1</span>,</span>
<span class="line" id="L1768">            .requier  = vrequier,</span>
<span class="line" id="L1769">            .protect = <span class="tok-null">false</span>,</span>
<span class="line" id="L1770">            .pading  = <span class="tok-null">false</span>,</span>
<span class="line" id="L1771">            .edtcar = <span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1772">            .regex  = <span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1773">            .errmsg = verrmsg,</span>
<span class="line" id="L1774">            .help   = vhelp,</span>
<span class="line" id="L1775">            .text   = vtext,</span>
<span class="line" id="L1776">            .zwitch = <span class="tok-null">false</span>,</span>
<span class="line" id="L1777">            .procfunc  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1778">            .proctask  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1779">            .attribut  = AtrField,</span>
<span class="line" id="L1780">            .atrProtect = AtrProtect,</span>
<span class="line" id="L1781">            .actif  = <span class="tok-null">true</span></span>
<span class="line" id="L1782">          };</span>
<span class="line" id="L1783">                    </span>
<span class="line" id="L1784">    <span class="tok-kw">if</span> (xfield.help.len == <span class="tok-number">0</span> ) xfield.help = <span class="tok-str">&quot;to validate Y or N &quot;</span> ;</span>
<span class="line" id="L1785"></span>
<span class="line" id="L1786">    <span class="tok-kw">return</span> xfield;</span>
<span class="line" id="L1787">  }</span>
<span class="line" id="L1788"></span>
<span class="line" id="L1789">  <span class="tok-comment">// New Field Switch ---&gt; arraylist panel-field</span>
</span>
<span class="line" id="L1790">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L1791">  <span class="tok-comment">// SWITCH,</span>
</span>
<span class="line" id="L1792">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldSwitch</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1793">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L1794">                    vzwitch: <span class="tok-type">bool</span>,</span>
<span class="line" id="L1795">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1796">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L1797"></span>
<span class="line" id="L1798">    <span class="tok-kw">var</span> xfield = FIELD {   </span>
<span class="line" id="L1799">        .name   = vname,</span>
<span class="line" id="L1800">        .posx   = vposx,</span>
<span class="line" id="L1801">        .posy   = vposy,</span>
<span class="line" id="L1802">        .reftyp = dds.REFTYP.SWITCH ,</span>
<span class="line" id="L1803">        .width  = <span class="tok-number">1</span>,</span>
<span class="line" id="L1804">        .scal   = <span class="tok-number">0</span>,</span>
<span class="line" id="L1805">        .nbrcar = <span class="tok-number">1</span>,</span>
<span class="line" id="L1806">        .requier  = <span class="tok-null">false</span>,</span>
<span class="line" id="L1807">        .protect = <span class="tok-null">false</span>,</span>
<span class="line" id="L1808">        .pading  = <span class="tok-null">false</span>,</span>
<span class="line" id="L1809">        .edtcar = <span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1810">        .regex  = <span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1811">        .errmsg = verrmsg,</span>
<span class="line" id="L1812">        .help   = vhelp,</span>
<span class="line" id="L1813">        .text   = <span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1814">        .zwitch = vzwitch,</span>
<span class="line" id="L1815">        .procfunc  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1816">        .proctask  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1817">        .attribut  = AtrField,</span>
<span class="line" id="L1818">        .atrProtect = AtrProtect,</span>
<span class="line" id="L1819">        .actif  = <span class="tok-null">true</span></span>
<span class="line" id="L1820">    };</span>
<span class="line" id="L1821"></span>
<span class="line" id="L1822">    <span class="tok-kw">if</span> (xfield.help.len == <span class="tok-number">0</span> ) xfield.help = <span class="tok-str">&quot;check ok= ✔ not= ◉  : Select espace bar &quot;</span> ;</span>
<span class="line" id="L1823"></span>
<span class="line" id="L1824">    <span class="tok-kw">if</span> (xfield.zwitch == <span class="tok-null">true</span> ) xfield.text = dds.STRUE</span>
<span class="line" id="L1825">    <span class="tok-kw">else</span> xfield.text = dds.SFALSE;</span>
<span class="line" id="L1826"></span>
<span class="line" id="L1827">    <span class="tok-kw">return</span> xfield;</span>
<span class="line" id="L1828"></span>
<span class="line" id="L1829">  }</span>
<span class="line" id="L1830"></span>
<span class="line" id="L1831">  <span class="tok-comment">// New Field Date ---&gt; arraylist panel-field</span>
</span>
<span class="line" id="L1832">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L1833">  <span class="tok-comment">// DATE_FR,</span>
</span>
<span class="line" id="L1834">  <span class="tok-comment">// regex fixe standard</span>
</span>
<span class="line" id="L1835">  <span class="tok-comment">// Control yyyy = 0001-9999 as well as the traditional MM 02 DAY 28 or 29 values</span>
</span>
<span class="line" id="L1836">  <span class="tok-comment">// I do not take into account the offset before 1500 ... etc.</span>
</span>
<span class="line" id="L1837">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldDateFR</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1838">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L1839">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1840">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L1841">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1842">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L1843"></span>
<span class="line" id="L1844"></span>
<span class="line" id="L1845">    <span class="tok-kw">var</span> xfield = FIELD {   </span>
<span class="line" id="L1846">        .name   = vname,</span>
<span class="line" id="L1847">        .posx   = vposx,</span>
<span class="line" id="L1848">        .posy   = vposy,</span>
<span class="line" id="L1849">        .reftyp = dds.REFTYP.DATE_FR,</span>
<span class="line" id="L1850">        .width  = <span class="tok-number">10</span>,</span>
<span class="line" id="L1851">        .scal   = <span class="tok-number">0</span>,</span>
<span class="line" id="L1852">        .nbrcar = <span class="tok-number">10</span>,</span>
<span class="line" id="L1853">        .requier  = vrequier,</span>
<span class="line" id="L1854">        .protect = <span class="tok-null">false</span>,</span>
<span class="line" id="L1855">        .pading  = <span class="tok-null">false</span>,</span>
<span class="line" id="L1856">        .edtcar =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1857">        .regex  = <span class="tok-str">&quot;&quot;</span>,         </span>
<span class="line" id="L1858">        .errmsg = verrmsg,</span>
<span class="line" id="L1859">        .help   = vhelp,</span>
<span class="line" id="L1860">        .text   = vtext,</span>
<span class="line" id="L1861">        .zwitch = <span class="tok-null">false</span>,</span>
<span class="line" id="L1862">        .procfunc  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1863">        .proctask  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1864">        .attribut  = AtrField,</span>
<span class="line" id="L1865">        .atrProtect = AtrProtect,</span>
<span class="line" id="L1866">        .actif  = <span class="tok-null">true</span></span>
<span class="line" id="L1867">    };</span>
<span class="line" id="L1868"></span>
<span class="line" id="L1869"></span>
<span class="line" id="L1870">    xfield.regex = std.fmt.allocPrint(dds.allocatorPnl,<span class="tok-str">&quot;{s}&quot;</span></span>
<span class="line" id="L1871">    ,.{<span class="tok-str">&quot;^(0[1-9]|[12][0-9]|3[01])[\\/](0[1-9]|1[012])[\\/][0-9]{4,4}$&quot;</span>}) </span>
<span class="line" id="L1872">    <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L1873"></span>
<span class="line" id="L1874">    <span class="tok-kw">if</span> (xfield.help.len == <span class="tok-number">0</span> ) xfield.help = <span class="tok-str">&quot;ex: date DD/MM/YYYY&quot;</span> ;</span>
<span class="line" id="L1875"></span>
<span class="line" id="L1876">    <span class="tok-kw">return</span> xfield;</span>
<span class="line" id="L1877"></span>
<span class="line" id="L1878">  }</span>
<span class="line" id="L1879"></span>
<span class="line" id="L1880">  <span class="tok-comment">// New Field Date ---&gt; arraylist panel-field</span>
</span>
<span class="line" id="L1881">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L1882">  <span class="tok-comment">// DATE_US,</span>
</span>
<span class="line" id="L1883">  <span class="tok-comment">// regex fixe standard</span>
</span>
<span class="line" id="L1884">  <span class="tok-comment">// Control yyyy = 0001-9999 as well as the traditional MM 02 DAY 28 or 29 values</span>
</span>
<span class="line" id="L1885">  <span class="tok-comment">// I do not take into account the offset before 1500 ... etc.</span>
</span>
<span class="line" id="L1886">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldDateUS</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1887">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L1888">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1889">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L1890">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1891">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L1892"></span>
<span class="line" id="L1893"></span>
<span class="line" id="L1894">    <span class="tok-kw">var</span> xfield = FIELD {   </span>
<span class="line" id="L1895">        .name   = vname,</span>
<span class="line" id="L1896">        .posx   = vposx,</span>
<span class="line" id="L1897">        .posy   = vposy,</span>
<span class="line" id="L1898">        .reftyp = dds.REFTYP.DATE_US,</span>
<span class="line" id="L1899">        .width  = <span class="tok-number">10</span>,</span>
<span class="line" id="L1900">        .scal   = <span class="tok-number">0</span>,</span>
<span class="line" id="L1901">        .nbrcar = <span class="tok-number">10</span>,</span>
<span class="line" id="L1902">        .requier  = vrequier,</span>
<span class="line" id="L1903">        .protect = <span class="tok-null">false</span>,</span>
<span class="line" id="L1904">        .pading  = <span class="tok-null">false</span>,</span>
<span class="line" id="L1905">        .edtcar =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1906">        .regex  = <span class="tok-str">&quot;&quot;</span>,         </span>
<span class="line" id="L1907">        .errmsg = verrmsg,</span>
<span class="line" id="L1908">        .help   = vhelp,</span>
<span class="line" id="L1909">        .text   = vtext,</span>
<span class="line" id="L1910">        .zwitch = <span class="tok-null">false</span>,</span>
<span class="line" id="L1911">        .procfunc  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1912">        .proctask  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1913">        .attribut  = AtrField,</span>
<span class="line" id="L1914">        .atrProtect = AtrProtect,</span>
<span class="line" id="L1915">        .actif  = <span class="tok-null">true</span></span>
<span class="line" id="L1916">    };</span>
<span class="line" id="L1917"></span>
<span class="line" id="L1918">    xfield.regex = std.fmt.allocPrint(dds.allocatorPnl,<span class="tok-str">&quot;{s}&quot;</span></span>
<span class="line" id="L1919">    ,.{<span class="tok-str">&quot;^(0[1-9]|1[012])[\\/](0[1-9]|[12][0-9]|3[01])[\\/][0-9]{4,4}$&quot;</span> })</span>
<span class="line" id="L1920">    <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L1921"></span>
<span class="line" id="L1922">    <span class="tok-kw">if</span> (xfield.help.len == <span class="tok-number">0</span> ) xfield.help = <span class="tok-str">&quot;ex: date MM/DD/YYYY&quot;</span>;</span>
<span class="line" id="L1923"></span>
<span class="line" id="L1924">    <span class="tok-kw">return</span> xfield;</span>
<span class="line" id="L1925"></span>
<span class="line" id="L1926">  }</span>
<span class="line" id="L1927"></span>
<span class="line" id="L1928"></span>
<span class="line" id="L1929">  <span class="tok-comment">// New Field Date ---&gt; arraylist panel-field</span>
</span>
<span class="line" id="L1930">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L1931">  <span class="tok-comment">// DATE_ISO,</span>
</span>
<span class="line" id="L1932">  <span class="tok-comment">// regex fixe standard</span>
</span>
<span class="line" id="L1933">  <span class="tok-comment">// Control yyyy = 0001-9999 as well as the traditional MM 02 DAY 28 or 29 values</span>
</span>
<span class="line" id="L1934">  <span class="tok-comment">// I do not take into account the offset before 1500 ... etc.</span>
</span>
<span class="line" id="L1935">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldDateISO</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1936">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L1937">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1938">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L1939">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1940">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L1941"></span>
<span class="line" id="L1942"></span>
<span class="line" id="L1943">    <span class="tok-kw">var</span> xfield = FIELD {   </span>
<span class="line" id="L1944">        .name   = vname,</span>
<span class="line" id="L1945">        .posx   = vposx,</span>
<span class="line" id="L1946">        .posy   = vposy,</span>
<span class="line" id="L1947">        .reftyp = dds.REFTYP.DATE_ISO,</span>
<span class="line" id="L1948">        .width  = <span class="tok-number">10</span>,</span>
<span class="line" id="L1949">        .scal   = <span class="tok-number">0</span>,</span>
<span class="line" id="L1950">        .nbrcar = <span class="tok-number">10</span>,</span>
<span class="line" id="L1951">        .requier  = vrequier,</span>
<span class="line" id="L1952">        .protect = <span class="tok-null">false</span>,</span>
<span class="line" id="L1953">        .pading  = <span class="tok-null">false</span>,</span>
<span class="line" id="L1954">        .edtcar =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1955">        .regex  = <span class="tok-str">&quot;&quot;</span>,         </span>
<span class="line" id="L1956">        .errmsg = verrmsg,</span>
<span class="line" id="L1957">        .help   = vhelp,</span>
<span class="line" id="L1958">        .text   = vtext,</span>
<span class="line" id="L1959">        .zwitch = <span class="tok-null">false</span>,</span>
<span class="line" id="L1960">        .procfunc  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1961">        .proctask  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L1962">        .attribut  = AtrField,</span>
<span class="line" id="L1963">        .atrProtect = AtrProtect,</span>
<span class="line" id="L1964">        .actif  = <span class="tok-null">true</span></span>
<span class="line" id="L1965">    };</span>
<span class="line" id="L1966"></span>
<span class="line" id="L1967"></span>
<span class="line" id="L1968">    xfield.regex = std.fmt.allocPrint(dds.allocatorPnl,<span class="tok-str">&quot;{s}&quot;</span></span>
<span class="line" id="L1969">    ,.{<span class="tok-str">&quot;^([0-9]{4,4})[-](0[1-9]|1[012])[-](0[1-9]|[12][0-9]|3[01])$&quot;</span>})</span>
<span class="line" id="L1970">    <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L1971"></span>
<span class="line" id="L1972">    <span class="tok-kw">if</span> (xfield.help.len == <span class="tok-number">0</span> )  xfield.help = <span class="tok-str">&quot;ex: date YYYY-MM-DD&quot;</span> ;</span>
<span class="line" id="L1973"></span>
<span class="line" id="L1974">    <span class="tok-kw">return</span> xfield;</span>
<span class="line" id="L1975"></span>
<span class="line" id="L1976">  }</span>
<span class="line" id="L1977"></span>
<span class="line" id="L1978"></span>
<span class="line" id="L1979">  <span class="tok-comment">// New Field Mail ---&gt; arraylist panel-field</span>
</span>
<span class="line" id="L1980">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L1981">  <span class="tok-comment">// MAIL_ISO,</span>
</span>
<span class="line" id="L1982">  <span class="tok-comment">// regex fixe standard</span>
</span>
<span class="line" id="L1983">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldMail</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1984">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L1985">                    vwidth:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L1986">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1987">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L1988">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L1989">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L1990"></span>
<span class="line" id="L1991">    <span class="tok-kw">var</span> xfield = FIELD {   </span>
<span class="line" id="L1992">        .name   = vname,</span>
<span class="line" id="L1993">        .posx   = vposx,</span>
<span class="line" id="L1994">        .posy   = vposy,</span>
<span class="line" id="L1995">        .reftyp = dds.REFTYP.MAIL_ISO,</span>
<span class="line" id="L1996">        .width  = vwidth,</span>
<span class="line" id="L1997">        .scal   = <span class="tok-number">0</span>,</span>
<span class="line" id="L1998">        .nbrcar = vwidth,</span>
<span class="line" id="L1999">        .requier  = vrequier,</span>
<span class="line" id="L2000">        .protect = <span class="tok-null">false</span>,</span>
<span class="line" id="L2001">        .pading  = <span class="tok-null">true</span>,</span>
<span class="line" id="L2002">        .edtcar =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2003">        .regex  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2004">        .errmsg = verrmsg,</span>
<span class="line" id="L2005">        .help   = vhelp,</span>
<span class="line" id="L2006">        .text   = vtext,</span>
<span class="line" id="L2007">        .zwitch = <span class="tok-null">false</span>,</span>
<span class="line" id="L2008">        .procfunc  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2009">        .proctask  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2010">        .attribut  = AtrField,</span>
<span class="line" id="L2011">        .atrProtect = AtrProtect,</span>
<span class="line" id="L2012">        .actif  = <span class="tok-null">true</span></span>
<span class="line" id="L2013">    };</span>
<span class="line" id="L2014"></span>
<span class="line" id="L2015"></span>
<span class="line" id="L2016">      <span class="tok-comment">// https://stackoverflow.com/questions/201323/how-can-i-validate-an-email-address-using-a-regular-expression</span>
</span>
<span class="line" id="L2017">      <span class="tok-comment">// chapitre RFC 6532 updates 5322 to allow and include full, clean UTF-8.</span>
</span>
<span class="line" id="L2018">      xfield.regex = std.fmt.allocPrint(dds.allocatorPnl,<span class="tok-str">&quot;{s}&quot;</span></span>
<span class="line" id="L2019">      ,.{<span class="tok-str">&quot;^([-!#-\'*+\\/-9=?A-Z^-~]{1,64}(\\.[-!#-\'*+\\/-9=?A-Z^-~]{1,64})*|\&quot;([]!#-[^-~ \t]|(\\[\t -~]))+\&quot;)@[0-9A-Za-z]([0-9A-Za-z-]{0,61}[0-9A-Za-z])?(\\.[0-9A-Za-z]([0-9A-Za-z-]{0,61}[0-9A-Za-z])?)+$&quot;</span>})</span>
<span class="line" id="L2020">      <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L2021">      </span>
<span class="line" id="L2022">      <span class="tok-kw">if</span> (xfield.help.len == <span class="tok-number">0</span> ) xfield.help = <span class="tok-str">&quot;ex: myname.myfirstname@gmail.com&quot;</span> ;</span>
<span class="line" id="L2023">        </span>
<span class="line" id="L2024">    <span class="tok-kw">return</span> xfield;</span>
<span class="line" id="L2025"></span>
<span class="line" id="L2026">  }</span>
<span class="line" id="L2027"></span>
<span class="line" id="L2028"></span>
<span class="line" id="L2029">  <span class="tok-comment">// New Field telephone ---&gt; arraylist panel-field</span>
</span>
<span class="line" id="L2030">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L2031">  <span class="tok-comment">// TELEPHONE,</span>
</span>
<span class="line" id="L2032">  <span class="tok-comment">// regex fixe standard</span>
</span>
<span class="line" id="L2033">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldTelephone</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2034">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L2035">                    vwidth:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L2036">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2037">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L2038">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2039">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2040">                    vregex: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L2041"></span>
<span class="line" id="L2042">      <span class="tok-kw">var</span> xfield = FIELD {   </span>
<span class="line" id="L2043">        .name   = vname,</span>
<span class="line" id="L2044">        .posx   = vposx,</span>
<span class="line" id="L2045">        .posy   = vposy,</span>
<span class="line" id="L2046">        .reftyp = dds.REFTYP.TELEPHONE,</span>
<span class="line" id="L2047">        .width  = vwidth,</span>
<span class="line" id="L2048">        .scal   = <span class="tok-number">0</span>,</span>
<span class="line" id="L2049">        .nbrcar = vwidth,</span>
<span class="line" id="L2050">        .requier  = vrequier,</span>
<span class="line" id="L2051">        .protect = <span class="tok-null">false</span>,</span>
<span class="line" id="L2052">        .pading  = <span class="tok-null">true</span>,</span>
<span class="line" id="L2053">        .edtcar =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2054">        .regex  = <span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2055">        .errmsg = verrmsg,</span>
<span class="line" id="L2056">        .help   = vhelp,</span>
<span class="line" id="L2057">        .text   = vtext,</span>
<span class="line" id="L2058">        .zwitch = <span class="tok-null">false</span>,</span>
<span class="line" id="L2059">        .procfunc  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2060">        .proctask  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2061">        .attribut  = AtrField,</span>
<span class="line" id="L2062">        .atrProtect = AtrProtect,</span>
<span class="line" id="L2063">        .actif  = <span class="tok-null">true</span></span>
<span class="line" id="L2064">      };</span>
<span class="line" id="L2065"></span>
<span class="line" id="L2066">      <span class="tok-kw">if</span> (vregex.len &gt; <span class="tok-number">0</span> ) xfield.regex = std.fmt.allocPrint(dds.allocatorPnl,</span>
<span class="line" id="L2067">      <span class="tok-str">&quot;^{s}&quot;</span>,.{vregex}) <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L2068">      <span class="tok-comment">// regex standar</span>
</span>
<span class="line" id="L2069">      <span class="tok-kw">if</span> (vregex.len == <span class="tok-number">0</span> ) xfield.regex = std.fmt.allocPrint(dds.allocatorPnl,<span class="tok-str">&quot;{s}&quot;</span></span>
<span class="line" id="L2070">      ,.{<span class="tok-str">&quot;^[+]{1,1}[(]{0,1}[0-9]{1,3}[)]([0-9]{1,3}){1,1}([-. ]?[0-9]{2,3}){2,4}$&quot;</span>})</span>
<span class="line" id="L2071">      <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L2072"></span>
<span class="line" id="L2073">      <span class="tok-kw">if</span> (xfield.help.len == <span class="tok-number">0</span> ) xfield.help = <span class="tok-str">&quot;ex fr : +(33)6.12.131.141&quot;</span> ;</span>
<span class="line" id="L2074"></span>
<span class="line" id="L2075">    <span class="tok-kw">return</span> xfield;</span>
<span class="line" id="L2076"></span>
<span class="line" id="L2077">  }</span>
<span class="line" id="L2078"></span>
<span class="line" id="L2079">  <span class="tok-comment">// New Field Digit  ---&gt; arraylist panel-lfield</span>
</span>
<span class="line" id="L2080">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L2081">  <span class="tok-comment">// .DIGIT unsigned</span>
</span>
<span class="line" id="L2082">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldUDigit</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2083">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L2084">                    vwidth:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L2085">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2086">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L2087">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2088">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2089">                    vregex: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L2090"></span>
<span class="line" id="L2091">    <span class="tok-kw">var</span> xfield = FIELD {   </span>
<span class="line" id="L2092">        .name   = vname,</span>
<span class="line" id="L2093">        .posx   = vposx,</span>
<span class="line" id="L2094">        .posy   = vposy,</span>
<span class="line" id="L2095">        .reftyp = dds.REFTYP.UDIGIT,</span>
<span class="line" id="L2096">        .width  = vwidth,</span>
<span class="line" id="L2097">        .scal   = <span class="tok-number">0</span>,</span>
<span class="line" id="L2098">        .nbrcar = vwidth,</span>
<span class="line" id="L2099">        .requier  = vrequier,</span>
<span class="line" id="L2100">        .protect = <span class="tok-null">false</span>,</span>
<span class="line" id="L2101">        .pading  = <span class="tok-null">true</span>,</span>
<span class="line" id="L2102">        .edtcar =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2103">        .regex  = vregex,</span>
<span class="line" id="L2104">        .errmsg = verrmsg,</span>
<span class="line" id="L2105">        .help   = vhelp,</span>
<span class="line" id="L2106">        .text   = vtext,</span>
<span class="line" id="L2107">        .zwitch = <span class="tok-null">false</span>,</span>
<span class="line" id="L2108">        .procfunc  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2109">        .proctask  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2110">        .attribut  = AtrField,</span>
<span class="line" id="L2111">        .atrProtect = AtrProtect,</span>
<span class="line" id="L2112">        .actif  = <span class="tok-null">true</span></span>
<span class="line" id="L2113">    };</span>
<span class="line" id="L2114"></span>
<span class="line" id="L2115">      <span class="tok-kw">if</span> (vregex.len == <span class="tok-number">0</span> ) {</span>
<span class="line" id="L2116">        xfield.regex = std.fmt.allocPrint(dds.allocatorPnl,<span class="tok-str">&quot;^[0-9]{{1,{d}}}$&quot;</span>,.{xfield.width})</span>
<span class="line" id="L2117">        <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L2118">      }</span>
<span class="line" id="L2119">      <span class="tok-kw">if</span> (xfield.help.len == <span class="tok-number">0</span> ) xfield.help = <span class="tok-str">&quot;ex: 0..9&quot;</span> ;</span>
<span class="line" id="L2120"></span>
<span class="line" id="L2121">    <span class="tok-kw">return</span> xfield;</span>
<span class="line" id="L2122">  }</span>
<span class="line" id="L2123"></span>
<span class="line" id="L2124">  <span class="tok-comment">// New Field DIGIT  ---&gt; arraylist panel-lfield</span>
</span>
<span class="line" id="L2125">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L2126">  <span class="tok-comment">// .DIGIT SIGNED</span>
</span>
<span class="line" id="L2127">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldDigit</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2128">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L2129">                    vwidth:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L2130">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2131">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L2132">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2133">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2134">                    vregex: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L2135"></span>
<span class="line" id="L2136">    <span class="tok-kw">var</span> xfield = FIELD {   </span>
<span class="line" id="L2137">        .name   = vname,</span>
<span class="line" id="L2138">        .posx   = vposx,</span>
<span class="line" id="L2139">        .posy   = vposy,</span>
<span class="line" id="L2140">        .reftyp = dds.REFTYP.DIGIT,</span>
<span class="line" id="L2141">        .width  = vwidth,</span>
<span class="line" id="L2142">        .scal   = <span class="tok-number">0</span>,</span>
<span class="line" id="L2143">        .nbrcar = <span class="tok-number">0</span>,</span>
<span class="line" id="L2144">        .requier  = vrequier,</span>
<span class="line" id="L2145">        .protect = <span class="tok-null">false</span>,</span>
<span class="line" id="L2146">        .pading  = <span class="tok-null">true</span>,</span>
<span class="line" id="L2147">        .edtcar =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2148">        .regex  = vregex,</span>
<span class="line" id="L2149">        .errmsg = verrmsg,</span>
<span class="line" id="L2150">        .help   = vhelp,</span>
<span class="line" id="L2151">        .text   = vtext,</span>
<span class="line" id="L2152">        .zwitch = <span class="tok-null">false</span>,</span>
<span class="line" id="L2153">        .procfunc  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2154">        .proctask  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2155">        .attribut  = AtrField,</span>
<span class="line" id="L2156">        .atrProtect = AtrProtect,</span>
<span class="line" id="L2157">        .actif  = <span class="tok-null">true</span></span>
<span class="line" id="L2158">    };</span>
<span class="line" id="L2159">      xfield.nbrcar = xfield.width + xfield.scal  + <span class="tok-number">1</span> ;</span>
<span class="line" id="L2160">      <span class="tok-kw">if</span> (vregex.len == <span class="tok-number">0</span> ) {</span>
<span class="line" id="L2161">        xfield.regex = std.fmt.allocPrint(dds.allocatorPnl,<span class="tok-str">&quot;^[+-][0-9]{{1,{d}}}$&quot;</span>,.{xfield.width})</span>
<span class="line" id="L2162">        <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L2163">      }</span>
<span class="line" id="L2164">      <span class="tok-kw">if</span> (xfield.help.len == <span class="tok-number">0</span> ) xfield.help = <span class="tok-str">&quot;ex: +0..9&quot;</span> ;</span>
<span class="line" id="L2165"></span>
<span class="line" id="L2166">    <span class="tok-kw">return</span> xfield;</span>
<span class="line" id="L2167">  }</span>
<span class="line" id="L2168"></span>
<span class="line" id="L2169">  <span class="tok-comment">// New Field Decimal  ---&gt; arraylist panel-lfield</span>
</span>
<span class="line" id="L2170">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L2171">  <span class="tok-comment">// .DECIMAL UNSIGNED</span>
</span>
<span class="line" id="L2172">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldUDecimal</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2173">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L2174">                    vwidth:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L2175">                    vscal:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L2176">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2177">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L2178">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2179">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2180">                    vregex: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L2181"></span>
<span class="line" id="L2182">    <span class="tok-kw">var</span> xfield = FIELD {   </span>
<span class="line" id="L2183">        .name   = vname,</span>
<span class="line" id="L2184">        .posx   = vposx,</span>
<span class="line" id="L2185">        .posy   = vposy,</span>
<span class="line" id="L2186">        .reftyp = dds.REFTYP.UDECIMAL,</span>
<span class="line" id="L2187">        .width  = vwidth,</span>
<span class="line" id="L2188">        .scal   = vscal,</span>
<span class="line" id="L2189">        .nbrcar = <span class="tok-number">0</span>,</span>
<span class="line" id="L2190">        .requier  = vrequier,</span>
<span class="line" id="L2191">        .protect = <span class="tok-null">false</span>,</span>
<span class="line" id="L2192">        .pading  = <span class="tok-null">true</span>,</span>
<span class="line" id="L2193">        .edtcar =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2194">        .regex  = vregex,</span>
<span class="line" id="L2195">        .errmsg = verrmsg,</span>
<span class="line" id="L2196">        .help   = vhelp,</span>
<span class="line" id="L2197">        .text   = vtext,</span>
<span class="line" id="L2198">        .zwitch = <span class="tok-null">false</span>,</span>
<span class="line" id="L2199">        .procfunc  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2200">        .proctask  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2201">        .attribut  = AtrField,</span>
<span class="line" id="L2202">        .atrProtect = AtrProtect,</span>
<span class="line" id="L2203">        .actif  = <span class="tok-null">true</span></span>
<span class="line" id="L2204">    };</span>
<span class="line" id="L2205"></span>
<span class="line" id="L2206">    <span class="tok-comment">// caculate len = width add scal add .  </span>
</span>
<span class="line" id="L2207">    <span class="tok-kw">if</span> (vscal == <span class="tok-number">0</span> ) xfield.nbrcar = xfield.width </span>
<span class="line" id="L2208">    <span class="tok-kw">else</span> xfield.nbrcar = xfield.width + xfield.scal  + <span class="tok-number">1</span> ;</span>
<span class="line" id="L2209"></span>
<span class="line" id="L2210">    <span class="tok-kw">if</span> (vregex.len == <span class="tok-number">0</span> ) {</span>
<span class="line" id="L2211">      <span class="tok-kw">if</span> (vscal == <span class="tok-number">0</span> ) xfield.regex = std.fmt.allocPrint(dds.allocatorPnl,</span>
<span class="line" id="L2212">      <span class="tok-str">&quot;^[0-9]{{1,{d}}}$&quot;</span>,.{vwidth})  <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));}</span>
<span class="line" id="L2213"></span>
<span class="line" id="L2214">      <span class="tok-kw">else</span> xfield.regex = std.fmt.allocPrint(dds.allocatorPnl,</span>
<span class="line" id="L2215">      <span class="tok-str">&quot;^[0-9]{{1,{d}}}[.][0-9]{{{d}}}$&quot;</span>,.{vwidth,vscal,})</span>
<span class="line" id="L2216">      <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L2217">    }</span>
<span class="line" id="L2218">    <span class="tok-kw">if</span> (xfield.help.len == <span class="tok-number">0</span> ) xfield.help = <span class="tok-str">&quot;ex: 12301 or 123.01&quot;</span> ;</span>
<span class="line" id="L2219"></span>
<span class="line" id="L2220">    <span class="tok-kw">return</span> xfield;</span>
<span class="line" id="L2221">  }</span>
<span class="line" id="L2222"></span>
<span class="line" id="L2223">  <span class="tok-comment">// New Field Decimal  ---&gt; arraylist panel-lfield</span>
</span>
<span class="line" id="L2224">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L2225">  <span class="tok-comment">// .DECIMAL SIGNED</span>
</span>
<span class="line" id="L2226">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldDecimal</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2227">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L2228">                    vwidth: <span class="tok-type">usize</span>,</span>
<span class="line" id="L2229">                    vscal:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L2230">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2231">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L2232">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2233">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2234">                    vregex: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L2235"></span>
<span class="line" id="L2236">    <span class="tok-kw">var</span> xfield = FIELD {   </span>
<span class="line" id="L2237">        .name   = vname,</span>
<span class="line" id="L2238">        .posx   = vposx,</span>
<span class="line" id="L2239">        .posy   = vposy,</span>
<span class="line" id="L2240">        .reftyp = dds.REFTYP.DECIMAL,</span>
<span class="line" id="L2241">        .width  = vwidth,</span>
<span class="line" id="L2242">        .scal   = vscal,</span>
<span class="line" id="L2243">        .nbrcar = <span class="tok-number">0</span>,</span>
<span class="line" id="L2244">        .requier  = vrequier,</span>
<span class="line" id="L2245">        .protect = <span class="tok-null">false</span>,</span>
<span class="line" id="L2246">        .pading  = <span class="tok-null">true</span>,</span>
<span class="line" id="L2247">        .edtcar =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2248">        .regex  = vregex,</span>
<span class="line" id="L2249">        .errmsg = verrmsg,</span>
<span class="line" id="L2250">        .help   = vhelp,</span>
<span class="line" id="L2251">        .text   = vtext,</span>
<span class="line" id="L2252">        .zwitch = <span class="tok-null">false</span>,</span>
<span class="line" id="L2253">        .procfunc  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2254">        .proctask  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2255">        .attribut  = AtrField,</span>
<span class="line" id="L2256">        .atrProtect = AtrProtect,</span>
<span class="line" id="L2257">        .actif  = <span class="tok-null">true</span></span>
<span class="line" id="L2258">    };</span>
<span class="line" id="L2259"></span>
<span class="line" id="L2260">    <span class="tok-comment">// caculate len = width add scal add + . </span>
</span>
<span class="line" id="L2261">    <span class="tok-kw">if</span> (vscal == <span class="tok-number">0</span> ) xfield.nbrcar = xfield.width + <span class="tok-number">1</span></span>
<span class="line" id="L2262">    <span class="tok-kw">else</span> xfield.nbrcar = xfield.width + xfield.scal  + <span class="tok-number">2</span> ;</span>
<span class="line" id="L2263">    <span class="tok-kw">if</span> (vregex.len == <span class="tok-number">0</span> ) {</span>
<span class="line" id="L2264"></span>
<span class="line" id="L2265">      <span class="tok-kw">if</span> (vscal == <span class="tok-number">0</span> ) xfield.regex =  std.fmt.allocPrint(dds.allocatorPnl,</span>
<span class="line" id="L2266">      <span class="tok-str">&quot;^[+-][0-9]{{1,{d}}}$&quot;</span>,.{vwidth}) <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));}</span>
<span class="line" id="L2267"></span>
<span class="line" id="L2268">      <span class="tok-kw">else</span> xfield.regex = std.fmt.allocPrint(dds.allocatorPnl,</span>
<span class="line" id="L2269">      <span class="tok-str">&quot;^[+-][0-9]{{1,{d}}}[.][0-9]{{{d}}}$&quot;</span>,.{vwidth,vscal}) </span>
<span class="line" id="L2270">      <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L2271"></span>
<span class="line" id="L2272">    }</span>
<span class="line" id="L2273">    <span class="tok-kw">if</span> (xfield.help.len == <span class="tok-number">0</span> ) xfield.help = <span class="tok-str">&quot;ex: +12301 or +123.01&quot;</span> ;</span>
<span class="line" id="L2274"></span>
<span class="line" id="L2275">    <span class="tok-kw">return</span> xfield;</span>
<span class="line" id="L2276">  }</span>
<span class="line" id="L2277"></span>
<span class="line" id="L2278"></span>
<span class="line" id="L2279">  <span class="tok-comment">// New Field Switch ---&gt; arraylist panel-field</span>
</span>
<span class="line" id="L2280">  <span class="tok-comment">// refence type</span>
</span>
<span class="line" id="L2281">  <span class="tok-comment">// FUNC,</span>
</span>
<span class="line" id="L2282">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">newFieldFunc</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2283">                    vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L2284">                    vwidth: <span class="tok-type">usize</span>,</span>
<span class="line" id="L2285">                    vtext: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2286">                    vrequier: <span class="tok-type">bool</span>,</span>
<span class="line" id="L2287">                    vprocfunc:  [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2288">                    verrmsg: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L2289">                    vhelp: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) FIELD {</span>
<span class="line" id="L2290"></span>
<span class="line" id="L2291">    <span class="tok-kw">var</span> xfield = FIELD {   </span>
<span class="line" id="L2292">        .name   = vname,</span>
<span class="line" id="L2293">        .posx   = vposx,</span>
<span class="line" id="L2294">        .posy   = vposy,</span>
<span class="line" id="L2295">        .reftyp = dds.REFTYP.FUNC,</span>
<span class="line" id="L2296">        .width  = vwidth,</span>
<span class="line" id="L2297">        .scal   = <span class="tok-number">0</span>,</span>
<span class="line" id="L2298">        .nbrcar = vwidth,</span>
<span class="line" id="L2299">        .requier  = vrequier,</span>
<span class="line" id="L2300">        .protect = <span class="tok-null">false</span>,</span>
<span class="line" id="L2301">        .pading  = <span class="tok-null">false</span>,</span>
<span class="line" id="L2302">        .edtcar = <span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2303">        .regex  = <span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2304">        .errmsg = verrmsg,</span>
<span class="line" id="L2305">        .help   = vhelp,</span>
<span class="line" id="L2306">        .text   = vtext,</span>
<span class="line" id="L2307">        .zwitch = <span class="tok-null">false</span>,</span>
<span class="line" id="L2308">        .procfunc  =vprocfunc,</span>
<span class="line" id="L2309">        .proctask  =<span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L2310">        .attribut  = AtrField,</span>
<span class="line" id="L2311">        .atrProtect = AtrProtect,</span>
<span class="line" id="L2312">        .actif  = <span class="tok-null">true</span></span>
<span class="line" id="L2313">    };</span>
<span class="line" id="L2314"></span>
<span class="line" id="L2315">    <span class="tok-kw">if</span> (xfield.help.len == <span class="tok-number">0</span> ) xfield.help = <span class="tok-str">&quot; Select espace bar &quot;</span> ;</span>
<span class="line" id="L2316">    <span class="tok-kw">return</span> xfield;</span>
<span class="line" id="L2317"></span>
<span class="line" id="L2318">  }</span>
<span class="line" id="L2319">  <span class="tok-comment">//========================================================================</span>
</span>
<span class="line" id="L2320">  <span class="tok-comment">//========================================================================</span>
</span>
<span class="line" id="L2321">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getIndex</span>(vpnl: *pnl.PANEL , name: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> )  ErrForms ! <span class="tok-type">usize</span> {</span>
<span class="line" id="L2322">    <span class="tok-kw">for</span> (vpnl.field.items, <span class="tok-number">0</span>..) |f, idx | {</span>
<span class="line" id="L2323">      <span class="tok-kw">if</span> (std.mem.eql(<span class="tok-type">u8</span>, f.name, name)) <span class="tok-kw">return</span> idx;</span>
<span class="line" id="L2324">    }</span>
<span class="line" id="L2325">    <span class="tok-kw">return</span> ErrForms.fld_getIndex_Name_Field_Invalide;</span>
<span class="line" id="L2326">  }</span>
<span class="line" id="L2327"></span>
<span class="line" id="L2328">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getName</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>) ErrForms ! [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> {</span>
<span class="line" id="L2329">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].name;</span>
<span class="line" id="L2330">    <span class="tok-kw">return</span> ErrForms.fld_getName_Index_invalide ;</span>
<span class="line" id="L2331"></span>
<span class="line" id="L2332">  }</span>
<span class="line" id="L2333">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getPosx</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">usize</span> {</span>
<span class="line" id="L2334">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].posx;</span>
<span class="line" id="L2335">    <span class="tok-kw">return</span> ErrForms.fld_getPosx_Index_invalide ;</span>
<span class="line" id="L2336">  }</span>
<span class="line" id="L2337">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getPosy</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">usize</span> {</span>
<span class="line" id="L2338">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].posy;</span>
<span class="line" id="L2339">    <span class="tok-kw">return</span> ErrForms.fld_getPosy_Index_invalide ;</span>
<span class="line" id="L2340">  }</span>
<span class="line" id="L2341">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getRefType</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! dds.REFTYP {</span>
<span class="line" id="L2342">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].reftyp;</span>
<span class="line" id="L2343">    <span class="tok-kw">return</span> ErrForms.fld_getRefType_Index_invalide ;</span>
<span class="line" id="L2344">  }</span>
<span class="line" id="L2345">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getWidth</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">usize</span> {</span>
<span class="line" id="L2346">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].width;</span>
<span class="line" id="L2347">    <span class="tok-kw">return</span> ErrForms.fld_getWidth_Index_invalide ;</span>
<span class="line" id="L2348">  }</span>
<span class="line" id="L2349">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getScal</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">usize</span> {</span>
<span class="line" id="L2350">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].scal;</span>
<span class="line" id="L2351">    <span class="tok-kw">return</span> ErrForms.fld_getScal_Index_invalide ;</span>
<span class="line" id="L2352">  }</span>
<span class="line" id="L2353">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getNbrCar</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">usize</span> {</span>
<span class="line" id="L2354">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].nbrcar;</span>
<span class="line" id="L2355">    <span class="tok-kw">return</span> ErrForms.fld_getNbrCar_Index_invalide ;</span>
<span class="line" id="L2356">  }</span>
<span class="line" id="L2357">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getRequier</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">bool</span> {</span>
<span class="line" id="L2358">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].requier;</span>
<span class="line" id="L2359">    <span class="tok-kw">return</span> ErrForms.fld_getRequier_Index_invalide ;</span>
<span class="line" id="L2360">  }</span>
<span class="line" id="L2361">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getProtect</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">bool</span> {</span>
<span class="line" id="L2362">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].protect;</span>
<span class="line" id="L2363">    <span class="tok-kw">return</span> ErrForms.fld_getProtect_Index_invalide ;</span>
<span class="line" id="L2364">  }</span>
<span class="line" id="L2365">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getPading</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">bool</span> {</span>
<span class="line" id="L2366">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].pading;</span>
<span class="line" id="L2367">    <span class="tok-kw">return</span> ErrForms.fld_getPading_Index_invalide ;</span>
<span class="line" id="L2368">  }</span>
<span class="line" id="L2369">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getEdtcar</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> {</span>
<span class="line" id="L2370">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].edtcar;</span>
<span class="line" id="L2371">    <span class="tok-kw">return</span> ErrForms.fld_getEdtcar_Index_invalide ;</span>
<span class="line" id="L2372">  }</span>
<span class="line" id="L2373">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getRegex</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> {</span>
<span class="line" id="L2374">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].regex;</span>
<span class="line" id="L2375">    <span class="tok-kw">return</span> ErrForms.fld_getRegex_Index_invalide ;</span>
<span class="line" id="L2376">  }</span>
<span class="line" id="L2377">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getErrMsg</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> {</span>
<span class="line" id="L2378">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].errmsg;</span>
<span class="line" id="L2379">    <span class="tok-kw">return</span> ErrForms.fld_getErrMsg_Index_invalide ;</span>
<span class="line" id="L2380">  }</span>
<span class="line" id="L2381">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getHelp</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> {</span>
<span class="line" id="L2382">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].help;</span>
<span class="line" id="L2383">    <span class="tok-kw">return</span> ErrForms.fld_getHelp_Index_invalide ;</span>
<span class="line" id="L2384">  }</span>
<span class="line" id="L2385">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getText</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> {</span>
<span class="line" id="L2386">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].text;</span>
<span class="line" id="L2387">    <span class="tok-kw">return</span> ErrForms.fld_getText_Index_invalide ;</span>
<span class="line" id="L2388">  }</span>
<span class="line" id="L2389">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getSwitch</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">bool</span> {</span>
<span class="line" id="L2390">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].zwitch;</span>
<span class="line" id="L2391">    <span class="tok-kw">return</span> ErrForms.fld_getSwitch_Index_invalide ;</span>
<span class="line" id="L2392">  }</span>
<span class="line" id="L2393">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getErr</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">bool</span> {</span>
<span class="line" id="L2394">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].err;</span>
<span class="line" id="L2395">    <span class="tok-kw">return</span> ErrForms.fld_getErr_Index_invalide ;</span>
<span class="line" id="L2396">  }</span>
<span class="line" id="L2397">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getFunc</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> {</span>
<span class="line" id="L2398">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].procfunc;</span>
<span class="line" id="L2399">    <span class="tok-kw">return</span> ErrForms.fld_getFunc_Index_invalide ;</span>
<span class="line" id="L2400">  }</span>
<span class="line" id="L2401">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getTask</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> {</span>
<span class="line" id="L2402">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].proctask;</span>
<span class="line" id="L2403">    <span class="tok-kw">return</span> ErrForms.fld_getTask_Index_invalide ;</span>
<span class="line" id="L2404">  }</span>
<span class="line" id="L2405"></span>
<span class="line" id="L2406">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getAttribut</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! dds.ZONATRB {</span>
<span class="line" id="L2407">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].atribut;</span>
<span class="line" id="L2408">    <span class="tok-kw">return</span> ErrForms.fld_getAttribut_Index_invalide ;</span>
<span class="line" id="L2409">  }</span>
<span class="line" id="L2410">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getAtrProtect</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! dds.ZONATRB {</span>
<span class="line" id="L2411">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].atrProtect;</span>
<span class="line" id="L2412">    <span class="tok-kw">return</span> ErrForms.fld_AtrProtect_Index_invalide ;</span>
<span class="line" id="L2413">  }</span>
<span class="line" id="L2414">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getActif</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>)  ErrForms ! <span class="tok-type">bool</span> {</span>
<span class="line" id="L2415">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) <span class="tok-kw">return</span> vpnl.field.items[n].actif;</span>
<span class="line" id="L2416">    <span class="tok-kw">return</span> ErrForms.fld_getActif_Index_invalide ;</span>
<span class="line" id="L2417">  }</span>
<span class="line" id="L2418"></span>
<span class="line" id="L2419"></span>
<span class="line" id="L2420">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setText</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>, val:[] <span class="tok-kw">const</span> <span class="tok-type">u8</span>) ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L2421">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) vpnl.field.items[n].text = val</span>
<span class="line" id="L2422">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.fld_setText_Index_invalide;</span>
<span class="line" id="L2423">  }</span>
<span class="line" id="L2424"></span>
<span class="line" id="L2425">  <span class="tok-comment">//  Input Field </span>
</span>
<span class="line" id="L2426">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setSwitch</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>, val :<span class="tok-type">bool</span>)  ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L2427">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) {</span>
<span class="line" id="L2428">      vpnl.field.items[n].zwitch = val;</span>
<span class="line" id="L2429">      vpnl.field.items[n].text = utl.boolToCbool(val);</span>
<span class="line" id="L2430">    }</span>
<span class="line" id="L2431">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.fld_setSwitch_Index_invalide;</span>
<span class="line" id="L2432"></span>
<span class="line" id="L2433">  }</span>
<span class="line" id="L2434">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setProtect</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>, val :<span class="tok-type">bool</span>)  ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L2435">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len)  vpnl.field.items[n].protect = val</span>
<span class="line" id="L2436">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.fld_setProtect_Index_invalide;</span>
<span class="line" id="L2437">  }</span>
<span class="line" id="L2438"></span>
<span class="line" id="L2439">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setRequier</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>, val :<span class="tok-type">bool</span>)  ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L2440">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len)  vpnl.field.items[n].protect = val</span>
<span class="line" id="L2441">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.fld_setProtect_Index_invalide;</span>
<span class="line" id="L2442">  }</span>
<span class="line" id="L2443"></span>
<span class="line" id="L2444">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setEdtcar</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>, val:[] <span class="tok-kw">const</span> <span class="tok-type">u8</span>)  ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L2445">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) vpnl.field.items[n].edtcar = val</span>
<span class="line" id="L2446">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.fld_setEdtcar_Index_invalide;</span>
<span class="line" id="L2447">  }</span>
<span class="line" id="L2448">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setRegex</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>, val:[] <span class="tok-kw">const</span> <span class="tok-type">u8</span>)  ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L2449">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) vpnl.field.items[n].reftyp = val</span>
<span class="line" id="L2450">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.fld_setRegex_Index_invalide;</span>
<span class="line" id="L2451">  }</span>
<span class="line" id="L2452">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setTask</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>, val :[]<span class="tok-kw">const</span> <span class="tok-type">u8</span>)  ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L2453">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) vpnl.field.items[n].proctask = val</span>
<span class="line" id="L2454">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.fld_setActif_Index_invalide;</span>
<span class="line" id="L2455">  }</span>
<span class="line" id="L2456">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setActif</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>, val :<span class="tok-type">bool</span>)  ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L2457">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len) vpnl.field.items[n].actif = val</span>
<span class="line" id="L2458">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.fld_setActif_Index_invalide;</span>
<span class="line" id="L2459">  }</span>
<span class="line" id="L2460"></span>
<span class="line" id="L2461">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">dltRows</span>(vpnl: *pnl.PANEL,  n :<span class="tok-type">usize</span> ) ErrForms ! <span class="tok-type">void</span> {</span>
<span class="line" id="L2462">    <span class="tok-kw">if</span> ( n &lt; vpnl.field.items.len)  _= vpnl.field.orderedRemove(n)</span>
<span class="line" id="L2463">    <span class="tok-kw">else</span> <span class="tok-kw">return</span> ErrForms.fld_dltRows_Index_invalide;</span>
<span class="line" id="L2464">  }</span>
<span class="line" id="L2465"></span>
<span class="line" id="L2466"></span>
<span class="line" id="L2467">  <span class="tok-comment">// clear value ALL FIELD</span>
</span>
<span class="line" id="L2468">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">clearAll</span>(vpnl: *pnl.PANEL) <span class="tok-type">void</span> {</span>
<span class="line" id="L2469">    <span class="tok-kw">var</span> n : <span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L2470">    <span class="tok-kw">for</span> (vpnl.field.items) |_ | {</span>
<span class="line" id="L2471">      vpnl.field.items[n].text = <span class="tok-str">&quot;&quot;</span>;</span>
<span class="line" id="L2472">      vpnl.field.items[n].zwitch = <span class="tok-null">false</span>;</span>
<span class="line" id="L2473">      n += <span class="tok-number">1</span> ;</span>
<span class="line" id="L2474">    }</span>
<span class="line" id="L2475">  }</span>
<span class="line" id="L2476">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">clearField</span>(vpnl: *pnl.PANEL , n: <span class="tok-type">usize</span>,)  <span class="tok-type">void</span> {</span>
<span class="line" id="L2477">    <span class="tok-kw">if</span> ( n &gt; vpnl.field.items.len) <span class="tok-kw">return</span>;</span>
<span class="line" id="L2478">    vpnl.field.items[n].text = <span class="tok-str">&quot;&quot;</span>;</span>
<span class="line" id="L2479">    vpnl.field.items[n].zwitch = <span class="tok-null">false</span>;</span>
<span class="line" id="L2480">  }</span>
<span class="line" id="L2481"></span>
<span class="line" id="L2482"></span>
<span class="line" id="L2483">  <span class="tok-comment">// matrix cleaning from Field</span>
</span>
<span class="line" id="L2484">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">clsField</span>(vpnl: *pnl.PANEL, vfld : FIELD )  <span class="tok-type">void</span> {</span>
<span class="line" id="L2485">    <span class="tok-comment">// display matrice PANEL</span>
</span>
<span class="line" id="L2486">    <span class="tok-kw">if</span> (vpnl.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span> ;</span>
<span class="line" id="L2487">    <span class="tok-kw">if</span> (vfld.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span> ;</span>
<span class="line" id="L2488">      <span class="tok-kw">var</span> x :<span class="tok-type">usize</span> = vfld.posx - <span class="tok-number">1</span>;</span>
<span class="line" id="L2489">      <span class="tok-kw">var</span> y :<span class="tok-type">usize</span> = vfld.posy - <span class="tok-number">1</span>;</span>
<span class="line" id="L2490">      <span class="tok-kw">var</span> n :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L2491">      <span class="tok-kw">var</span> npos :<span class="tok-type">usize</span> = (vpnl.cols * vfld.posx) + vfld.posy - <span class="tok-number">1</span> ;</span>
<span class="line" id="L2492">      <span class="tok-kw">while</span> (n &lt; vfld.nbrcar) : (n += <span class="tok-number">1</span>) {</span>
<span class="line" id="L2493">        vpnl.buf.items[npos].ch = <span class="tok-str">&quot; &quot;</span>;</span>
<span class="line" id="L2494">        vpnl.buf.items[npos].attribut  = vpnl.attribut;</span>
<span class="line" id="L2495">        vpnl.buf.items[npos].on = <span class="tok-null">false</span>;</span>
<span class="line" id="L2496">        term.gotoXY(x + vpnl.posx   , y + vpnl.posy - n  );</span>
<span class="line" id="L2497">        term.writeStyled(vpnl.buf.items[npos].ch,vpnl.buf.items[npos].attribut);</span>
<span class="line" id="L2498">        npos += <span class="tok-number">1</span>;</span>
<span class="line" id="L2499">      }</span>
<span class="line" id="L2500">  }</span>
<span class="line" id="L2501"></span>
<span class="line" id="L2502"></span>
<span class="line" id="L2503">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">printField</span>(vpnl: *pnl.PANEL, vfld : FIELD) <span class="tok-type">void</span> {</span>
<span class="line" id="L2504">    <span class="tok-kw">if</span> ( vpnl.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span> ; </span>
<span class="line" id="L2505">    <span class="tok-comment">// assigne FIELD to matrice for display</span>
</span>
<span class="line" id="L2506">    <span class="tok-kw">var</span> n = (vpnl.cols * (vfld.posx - <span class="tok-number">1</span>)) + vfld.posy - <span class="tok-number">1</span>;</span>
<span class="line" id="L2507">    <span class="tok-kw">var</span> nn: <span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L2508"></span>
<span class="line" id="L2509">    <span class="tok-kw">while</span> (nn &lt; vfld.nbrcar) : (nn += <span class="tok-number">1</span> ) {</span>
<span class="line" id="L2510">      <span class="tok-kw">if</span> (vfld.actif == <span class="tok-null">true</span>) {</span>
<span class="line" id="L2511">        vpnl.buf.items[n].ch = <span class="tok-str">&quot; &quot;</span> ;</span>
<span class="line" id="L2512">        <span class="tok-kw">if</span> (vfld.protect == <span class="tok-null">false</span>) vpnl.buf.items[n].attribut = vfld.attribut</span>
<span class="line" id="L2513">        <span class="tok-kw">else</span> vpnl.buf.items[n].attribut  = vpnl.attribut;</span>
<span class="line" id="L2514">        vpnl.buf.items[n].on = <span class="tok-null">true</span>;</span>
<span class="line" id="L2515">      }</span>
<span class="line" id="L2516">      <span class="tok-kw">else</span> {</span>
<span class="line" id="L2517">        vpnl.buf.items[n].ch = <span class="tok-str">&quot;&quot;</span>;</span>
<span class="line" id="L2518">        vpnl.buf.items[n].attribut  = vpnl.attribut;</span>
<span class="line" id="L2519">        vpnl.buf.items[n].on = <span class="tok-null">false</span>;</span>
<span class="line" id="L2520">      }</span>
<span class="line" id="L2521">      n += <span class="tok-number">1</span>;</span>
<span class="line" id="L2522">    }</span>
<span class="line" id="L2523"></span>
<span class="line" id="L2524">    <span class="tok-comment">// The err field takes precedence, followed by protection, followed by the base attribute</span>
</span>
<span class="line" id="L2525">    n = (vpnl.cols * (vfld.posx - <span class="tok-number">1</span>)) + vfld.posy - <span class="tok-number">1</span>  ;</span>
<span class="line" id="L2526"></span>
<span class="line" id="L2527">    <span class="tok-kw">var</span> nfld = vfld.text;</span>
<span class="line" id="L2528">    <span class="tok-kw">var</span> nile = <span class="tok-null">false</span> ;</span>
<span class="line" id="L2529">    <span class="tok-kw">if</span> (nfld.len == <span class="tok-number">0</span> <span class="tok-kw">and</span> !vfld.protect ) {</span>
<span class="line" id="L2530">      nfld =<span class="tok-str">&quot;_&quot;</span>;</span>
<span class="line" id="L2531">      nile = <span class="tok-null">true</span>;</span>
<span class="line" id="L2532">    }</span>
<span class="line" id="L2533">    <span class="tok-kw">if</span> (vfld.reftyp == dds.REFTYP.SWITCH) {</span>
<span class="line" id="L2534">            nile = <span class="tok-null">false</span>;</span>
<span class="line" id="L2535">            <span class="tok-kw">if</span> ( vfld.zwitch ) nfld = dds.STRUE</span>
<span class="line" id="L2536">            <span class="tok-kw">else</span> nfld= dds.SFALSE;</span>
<span class="line" id="L2537">    } </span>
<span class="line" id="L2538">    <span class="tok-kw">var</span> iter = utl.iteratStr.iterator(nfld);</span>
<span class="line" id="L2539">    <span class="tok-kw">defer</span> iter.deinit();</span>
<span class="line" id="L2540">    <span class="tok-kw">while</span> (iter.next()) |ch| {</span>
<span class="line" id="L2541">      <span class="tok-kw">if</span> (vfld.actif == <span class="tok-null">true</span> ) {</span>
<span class="line" id="L2542">        <span class="tok-kw">if</span> (vfld.reftyp == dds.REFTYP.PASSWORD) vpnl.buf.items[n].ch = <span class="tok-str">&quot;*&quot;</span> </span>
<span class="line" id="L2543">        <span class="tok-kw">else</span> vpnl.buf.items[n].ch = ch ;</span>
<span class="line" id="L2544"></span>
<span class="line" id="L2545">        vpnl.buf.items[n].on = <span class="tok-null">true</span>;</span>
<span class="line" id="L2546"></span>
<span class="line" id="L2547">        <span class="tok-kw">if</span> (vfld.protect) vpnl.buf.items[n].attribut  = vfld.atrProtect</span>
<span class="line" id="L2548">        <span class="tok-kw">else</span> {</span>
<span class="line" id="L2549">            <span class="tok-kw">if</span> (nile)vpnl.buf.items[n].attribut  = AtrNil</span>
<span class="line" id="L2550">            <span class="tok-kw">else</span> vpnl.buf.items[n].attribut = vfld.attribut;</span>
<span class="line" id="L2551">        }</span>
<span class="line" id="L2552"></span>
<span class="line" id="L2553">      }</span>
<span class="line" id="L2554">      n += <span class="tok-number">1</span>;</span>
<span class="line" id="L2555">    }</span>
<span class="line" id="L2556">  }</span>
<span class="line" id="L2557"></span>
<span class="line" id="L2558">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">displayField</span>(vpnl: *pnl.PANEL, vfld : FIELD )  <span class="tok-type">void</span> {</span>
<span class="line" id="L2559">    <span class="tok-comment">// display matrice PANEL</span>
</span>
<span class="line" id="L2560">    <span class="tok-kw">if</span> (vpnl.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span> ;</span>
<span class="line" id="L2561">    <span class="tok-kw">if</span> (vfld.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span> ;</span>
<span class="line" id="L2562">      <span class="tok-kw">var</span> x :<span class="tok-type">usize</span> = vfld.posx - <span class="tok-number">1</span>;</span>
<span class="line" id="L2563">      <span class="tok-kw">var</span> y :<span class="tok-type">usize</span> = vfld.posy - <span class="tok-number">1</span>;</span>
<span class="line" id="L2564">      <span class="tok-kw">var</span> n :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L2565">      <span class="tok-kw">var</span> npos :<span class="tok-type">usize</span> = (vpnl.cols * (vfld.posx - <span class="tok-number">1</span>)) + vfld.posy - <span class="tok-number">1</span> ;</span>
<span class="line" id="L2566">      <span class="tok-kw">while</span> (n &lt; vfld.nbrcar) : (n += <span class="tok-number">1</span>) {</span>
<span class="line" id="L2567">        term.gotoXY(x + vpnl.posx   , y + vpnl.posy + n  );</span>
<span class="line" id="L2568">        term.writeStyled(vpnl.buf.items[npos].ch,vpnl.buf.items[npos].attribut);</span>
<span class="line" id="L2569">        npos += <span class="tok-number">1</span>;</span>
<span class="line" id="L2570">      }</span>
<span class="line" id="L2571">  }</span>
<span class="line" id="L2572"></span>
<span class="line" id="L2573"></span>
<span class="line" id="L2574">  <span class="tok-comment">//----------------------------------------------------==</span>
</span>
<span class="line" id="L2575">  <span class="tok-comment">// Input buffer management modeled on 5250/3270</span>
</span>
<span class="line" id="L2576">  <span class="tok-comment">// inspiration ncurse</span>
</span>
<span class="line" id="L2577">  <span class="tok-comment">// application hold principe and new langage</span>
</span>
<span class="line" id="L2578">  <span class="tok-comment">//----------------------------------------------------==</span>
</span>
<span class="line" id="L2579"></span>
<span class="line" id="L2580">  <span class="tok-kw">var</span> e_FIELD : std.ArrayList([] <span class="tok-kw">const</span> <span class="tok-type">u8</span>) = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L2581"></span>
<span class="line" id="L2582">  <span class="tok-kw">var</span> e_switch: <span class="tok-type">bool</span> = <span class="tok-null">false</span>;</span>
<span class="line" id="L2583"></span>
<span class="line" id="L2584">  <span class="tok-kw">fn</span> <span class="tok-fn">nbrCarField</span>() <span class="tok-type">usize</span> {</span>
<span class="line" id="L2585">    <span class="tok-kw">var</span> wl : <span class="tok-type">usize</span> =<span class="tok-number">0</span>;</span>
<span class="line" id="L2586">    <span class="tok-kw">var</span> iter = utl.iteratStr.iterator(utl.listToStr(e_FIELD));</span>
<span class="line" id="L2587">    <span class="tok-kw">defer</span> iter.deinit();</span>
<span class="line" id="L2588">    <span class="tok-kw">while</span> (iter.next()) |_|  { wl += <span class="tok-number">1</span> ;}</span>
<span class="line" id="L2589">    <span class="tok-kw">return</span> wl;</span>
<span class="line" id="L2590">  }</span>
<span class="line" id="L2591"></span>
<span class="line" id="L2592">  <span class="tok-kw">fn</span> <span class="tok-fn">delete</span>(n : <span class="tok-type">usize</span>) <span class="tok-type">void</span> {</span>
<span class="line" id="L2593">    _=e_FIELD.orderedRemove(n);</span>
<span class="line" id="L2594">    e_FIELD.append(<span class="tok-str">&quot; &quot;</span>) <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L2595">  }</span>
<span class="line" id="L2596"></span>
<span class="line" id="L2597">  <span class="tok-kw">fn</span> <span class="tok-fn">insert</span>(c: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> , n : <span class="tok-type">usize</span>) <span class="tok-type">void</span> {</span>
<span class="line" id="L2598">    _=e_FIELD.orderedRemove(nbrCarField() - <span class="tok-number">1</span>);</span>
<span class="line" id="L2599"></span>
<span class="line" id="L2600">    <span class="tok-kw">const</span> allocator = std.heap.page_allocator;</span>
<span class="line" id="L2601">    <span class="tok-kw">var</span> x_FIELD = std.ArrayList([] <span class="tok-kw">const</span> <span class="tok-type">u8</span>).init(allocator);</span>
<span class="line" id="L2602">    <span class="tok-kw">defer</span> x_FIELD.deinit();</span>
<span class="line" id="L2603"></span>
<span class="line" id="L2604">    <span class="tok-kw">for</span> ( e_FIELD.items) |ch | {</span>
<span class="line" id="L2605">      x_FIELD.append(ch) <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L2606">    }</span>
<span class="line" id="L2607">    e_FIELD.clearRetainingCapacity();</span>
<span class="line" id="L2608"></span>
<span class="line" id="L2609"></span>
<span class="line" id="L2610">    <span class="tok-kw">for</span> ( x_FIELD.items ,<span class="tok-number">0</span>..) |ch , idx | {</span>
<span class="line" id="L2611">      <span class="tok-kw">if</span> ( n != idx) e_FIELD.append(ch) <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L2612">      <span class="tok-kw">if</span> ( n == idx) { </span>
<span class="line" id="L2613">        e_FIELD.append(c)  <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L2614">        e_FIELD.append(ch) <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L2615">      } </span>
<span class="line" id="L2616">    }</span>
<span class="line" id="L2617">  }</span>
<span class="line" id="L2618"></span>
<span class="line" id="L2619"></span>
<span class="line" id="L2620"></span>
<span class="line" id="L2621">  <span class="tok-kw">fn</span> <span class="tok-fn">isrequier</span>() <span class="tok-type">bool</span> {</span>
<span class="line" id="L2622">    <span class="tok-kw">var</span> text = utl.listToStr(e_FIELD);</span>
<span class="line" id="L2623">    text = utl.trimStr(text);</span>
<span class="line" id="L2624"></span>
<span class="line" id="L2625">    <span class="tok-kw">if</span> (text.len == <span class="tok-number">0</span> ) <span class="tok-kw">return</span> <span class="tok-null">true</span> ;</span>
<span class="line" id="L2626">    <span class="tok-kw">return</span> <span class="tok-null">false</span> ;</span>
<span class="line" id="L2627">  }</span>
<span class="line" id="L2628">  </span>
<span class="line" id="L2629">  <span class="tok-comment">/// Check if it is a space</span></span>
<span class="line" id="L2630">  <span class="tok-kw">fn</span> <span class="tok-fn">isSpace</span>(c: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>) <span class="tok-type">bool</span> { </span>
<span class="line" id="L2631">    <span class="tok-kw">if</span> ( std.mem.eql(<span class="tok-type">u8</span>, c, <span class="tok-str">&quot; &quot;</span>) ) <span class="tok-kw">return</span> <span class="tok-null">true</span>;</span>
<span class="line" id="L2632">    <span class="tok-kw">return</span> <span class="tok-null">false</span> ;</span>
<span class="line" id="L2633">  }</span>
<span class="line" id="L2634"></span>
<span class="line" id="L2635">  <span class="tok-comment">/// if it is a KEY function</span></span>
<span class="line" id="L2636">  <span class="tok-kw">fn</span> <span class="tok-fn">isfuncKey</span>(vpnl: *pnl.PANEL, e_key: term.Keyboard) <span class="tok-type">bool</span> {</span>
<span class="line" id="L2637">    <span class="tok-kw">for</span> ( vpnl.button.items) |xbtn| {</span>
<span class="line" id="L2638">      <span class="tok-kw">if</span> (xbtn.key == e_key.Key ) <span class="tok-kw">return</span> <span class="tok-null">true</span>;</span>
<span class="line" id="L2639">    }</span>
<span class="line" id="L2640">    <span class="tok-kw">return</span> <span class="tok-null">false</span>;</span>
<span class="line" id="L2641">  }</span>
<span class="line" id="L2642">  </span>
<span class="line" id="L2643">  <span class="tok-comment">/// if it is a KEY function Check</span></span>
<span class="line" id="L2644">  <span class="tok-kw">fn</span> <span class="tok-fn">ischeckKey</span>(vpnl: *pnl.PANEL, e_key: term.Keyboard) <span class="tok-type">bool</span> {</span>
<span class="line" id="L2645">    <span class="tok-kw">for</span> ( vpnl.button.items) |xbtn| {</span>
<span class="line" id="L2646">      <span class="tok-kw">if</span> (xbtn.key == e_key.Key <span class="tok-kw">and</span> xbtn.check ) <span class="tok-kw">return</span> <span class="tok-null">true</span>;</span>
<span class="line" id="L2647">    }</span>
<span class="line" id="L2648">    <span class="tok-kw">return</span> <span class="tok-null">false</span>;</span>
<span class="line" id="L2649">  }</span>
<span class="line" id="L2650">  </span>
<span class="line" id="L2651">  <span class="tok-comment">/// Hides the area entered with *</span></span>
<span class="line" id="L2652">  <span class="tok-kw">fn</span> <span class="tok-fn">password</span>(s: std.ArrayList([] <span class="tok-kw">const</span> <span class="tok-type">u8</span>)) [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> {</span>
<span class="line" id="L2653">    <span class="tok-kw">var</span> i: <span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L2654">    <span class="tok-kw">var</span> buf : [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;&quot;</span>;</span>
<span class="line" id="L2655">    <span class="tok-kw">while</span> ( i &lt; s.items.len ) : (i += <span class="tok-number">1</span>) {</span>
<span class="line" id="L2656">        <span class="tok-kw">if</span> ( std.mem.eql(<span class="tok-type">u8</span>,s.items[i],<span class="tok-str">&quot; &quot;</span> )) buf = utl.concatStr(buf,<span class="tok-str">&quot; &quot;</span>) </span>
<span class="line" id="L2657">        <span class="tok-kw">else</span>  buf = utl.concatStr(buf,<span class="tok-str">&quot;*&quot;</span>);</span>
<span class="line" id="L2658">    }</span>
<span class="line" id="L2659">    <span class="tok-kw">return</span> buf;</span>
<span class="line" id="L2660">  }</span>
<span class="line" id="L2661"></span>
<span class="line" id="L2662">  <span class="tok-comment">/// initialize the input field e_FIELD</span></span>
<span class="line" id="L2663">  <span class="tok-comment">/// switch convert bool CTRUE /CFALSE</span></span>
<span class="line" id="L2664">  <span class="tok-comment">/// the buffer displays field the text and completes with blanks</span></span>
<span class="line" id="L2665">  <span class="tok-kw">fn</span> <span class="tok-fn">initData</span>(f:FIELD) <span class="tok-type">void</span> {</span>
<span class="line" id="L2666">    e_FIELD.clearRetainingCapacity();</span>
<span class="line" id="L2667">    <span class="tok-kw">if</span> ( f.reftyp == dds.REFTYP.SWITCH) {</span>
<span class="line" id="L2668">      <span class="tok-kw">if</span> (e_switch == <span class="tok-null">true</span> ) </span>
<span class="line" id="L2669">        utl.addListStr(&amp;e_FIELD  , dds.STRUE) </span>
<span class="line" id="L2670">      <span class="tok-kw">else</span></span>
<span class="line" id="L2671">        utl.addListStr(&amp;e_FIELD  , dds.SFALSE);</span>
<span class="line" id="L2672">    }</span>
<span class="line" id="L2673">    <span class="tok-kw">else</span> {</span>
<span class="line" id="L2674">        utl.addListStr(&amp;e_FIELD  , f.text);</span>
<span class="line" id="L2675">      <span class="tok-kw">var</span> i:<span class="tok-type">usize</span> = <span class="tok-number">0</span> ;</span>
<span class="line" id="L2676">      <span class="tok-kw">while</span> (i &lt; f.nbrcar - f.text.len) : ( i += <span class="tok-number">1</span>) {</span>
<span class="line" id="L2677">        e_FIELD.append(<span class="tok-str">&quot; &quot;</span>) <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L2678">      }</span>
<span class="line" id="L2679">    }</span>
<span class="line" id="L2680">  }</span>
<span class="line" id="L2681"></span>
<span class="line" id="L2682"></span>
<span class="line" id="L2683">  <span class="tok-kw">fn</span> <span class="tok-fn">msgHelp</span>(vpnl: *pnl.PANEL, f : FIELD ) <span class="tok-type">void</span> {</span>
<span class="line" id="L2684"></span>
<span class="line" id="L2685">    <span class="tok-comment">// define attribut default MSG Error</span>
</span>
<span class="line" id="L2686">    <span class="tok-kw">const</span> MsgHelp : dds.ZONATRB = .{</span>
<span class="line" id="L2687">        .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L2688">                      <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L2689">                      <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L2690">                      <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L2691">        .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L2692">        .foregr = dds.ForegroundColor.fgRed</span>
<span class="line" id="L2693">    };</span>
<span class="line" id="L2694"></span>
<span class="line" id="L2695"></span>
<span class="line" id="L2696">    <span class="tok-kw">var</span> x: <span class="tok-type">usize</span>  = vpnl.lines;</span>
<span class="line" id="L2697">    <span class="tok-kw">var</span> n: <span class="tok-type">usize</span>  = vpnl.cols * (x - <span class="tok-number">2</span>) ;</span>
<span class="line" id="L2698">    <span class="tok-kw">var</span> y: <span class="tok-type">usize</span>  = <span class="tok-number">1</span> ;</span>
<span class="line" id="L2699"></span>
<span class="line" id="L2700">    <span class="tok-kw">var</span> msghlp:[]<span class="tok-kw">const</span> <span class="tok-type">u8</span> = utl.concatStr(<span class="tok-str">&quot;Help : &quot;</span>, f.help) ;</span>
<span class="line" id="L2701">    <span class="tok-kw">var</span> boucle : <span class="tok-type">bool</span>= <span class="tok-null">true</span> ;</span>
<span class="line" id="L2702"></span>
<span class="line" id="L2703">    <span class="tok-kw">if</span> (vpnl.cols &lt; (msghlp.len) )  msghlp = subStr(vpnl, msghlp,<span class="tok-number">0</span>,  vpnl.cols - <span class="tok-number">2</span>);</span>
<span class="line" id="L2704"></span>
<span class="line" id="L2705">    <span class="tok-comment">// clear line button </span>
</span>
<span class="line" id="L2706">    <span class="tok-kw">while</span> (y &lt;= (vpnl.cols - <span class="tok-number">2</span>) ) : (y += <span class="tok-number">1</span>) {</span>
<span class="line" id="L2707">      term.gotoXY(vpnl.posx + x  - <span class="tok-number">2</span>   , y + vpnl.posy );</span>
<span class="line" id="L2708">      term.writeStyled(<span class="tok-str">&quot; &quot;</span>,vpnl.attribut);</span>
<span class="line" id="L2709">    }</span>
<span class="line" id="L2710">    <span class="tok-comment">// display msgerr</span>
</span>
<span class="line" id="L2711">    y = <span class="tok-number">1</span> ;</span>
<span class="line" id="L2712">    term.gotoXY(vpnl.posx + x  - <span class="tok-number">2</span>, y + vpnl.posy );</span>
<span class="line" id="L2713">    term.writeStyled(msghlp,MsgHelp);</span>
<span class="line" id="L2714"></span>
<span class="line" id="L2715">    <span class="tok-kw">while</span> (boucle) {</span>
<span class="line" id="L2716">      <span class="tok-kw">var</span> e_key = kbd.getKEY();</span>
<span class="line" id="L2717"></span>
<span class="line" id="L2718">      <span class="tok-kw">switch</span> ( e_key.Key ) {</span>
<span class="line" id="L2719">        .esc=&gt;boucle = <span class="tok-null">false</span>,</span>
<span class="line" id="L2720">      <span class="tok-kw">else</span> =&gt;  {},</span>
<span class="line" id="L2721">      }</span>
<span class="line" id="L2722">    }</span>
<span class="line" id="L2723"></span>
<span class="line" id="L2724">    <span class="tok-comment">// restore line panel</span>
</span>
<span class="line" id="L2725">    y = <span class="tok-number">1</span> ;</span>
<span class="line" id="L2726">    <span class="tok-kw">while</span> (y &lt;= (vpnl.cols - <span class="tok-number">2</span>)) : (y += <span class="tok-number">1</span>) {</span>
<span class="line" id="L2727">      n += <span class="tok-number">1</span>;</span>
<span class="line" id="L2728">      term.gotoXY( vpnl.posx + x  - <span class="tok-number">2</span>, y + vpnl.posy);</span>
<span class="line" id="L2729">      term.writeStyled(vpnl.buf.items[n].ch,vpnl.buf.items[n].attribut);</span>
<span class="line" id="L2730">    }</span>
<span class="line" id="L2731">  }</span>
<span class="line" id="L2732"></span>
<span class="line" id="L2733">  <span class="tok-comment">///------------------------------------------------</span></span>
<span class="line" id="L2734">  <span class="tok-comment">/// Definition of the panel (window) on a lines</span></span>
<span class="line" id="L2735">  <span class="tok-comment">/// Message display</span></span>
<span class="line" id="L2736">  <span class="tok-comment">/// to exit press the Escape key</span></span>
<span class="line" id="L2737">  <span class="tok-comment">/// restoration of the original panel lines</span></span>
<span class="line" id="L2738">  <span class="tok-comment">///------------------------------------------------</span></span>
<span class="line" id="L2739"></span>
<span class="line" id="L2740">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">msgErr</span>(vpnl: *pnl.PANEL, f : FIELD,  info: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> ) <span class="tok-type">void</span> {</span>
<span class="line" id="L2741"></span>
<span class="line" id="L2742">    term.gotoXY(vpnl.posx + f.posx - <span class="tok-number">1</span> , vpnl.posy + f.posy - <span class="tok-number">1</span>);</span>
<span class="line" id="L2743">    term.writeStyled(utl.listToStr(e_FIELD),MsgErr);</span>
<span class="line" id="L2744"></span>
<span class="line" id="L2745"></span>
<span class="line" id="L2746">    <span class="tok-kw">var</span> x: <span class="tok-type">usize</span>  = vpnl.lines;</span>
<span class="line" id="L2747">    <span class="tok-kw">var</span> n: <span class="tok-type">usize</span>  = vpnl.cols * (x - <span class="tok-number">2</span>) ;</span>
<span class="line" id="L2748">    <span class="tok-kw">var</span> y: <span class="tok-type">usize</span>  = <span class="tok-number">1</span> ;</span>
<span class="line" id="L2749"></span>
<span class="line" id="L2750">    <span class="tok-kw">var</span> msgerr:[]<span class="tok-kw">const</span> <span class="tok-type">u8</span> = utl.concatStr(<span class="tok-str">&quot;Info : &quot;</span>, info) ;</span>
<span class="line" id="L2751">    <span class="tok-kw">var</span> boucle : <span class="tok-type">bool</span>= <span class="tok-null">true</span> ;</span>
<span class="line" id="L2752"></span>
<span class="line" id="L2753">    <span class="tok-kw">if</span> (vpnl.cols &lt; (msgerr.len) )  msgerr = subStr(vpnl, msgerr, <span class="tok-number">0</span>,  vpnl.cols - <span class="tok-number">2</span>);</span>
<span class="line" id="L2754"></span>
<span class="line" id="L2755">    <span class="tok-comment">// clear line button </span>
</span>
<span class="line" id="L2756">    <span class="tok-kw">while</span> (y &lt;= (vpnl.cols - <span class="tok-number">2</span>) ) : (y += <span class="tok-number">1</span>) {</span>
<span class="line" id="L2757">      term.gotoXY(vpnl.posx + x  - <span class="tok-number">2</span>   , y + vpnl.posy  );</span>
<span class="line" id="L2758">      term.writeStyled(<span class="tok-str">&quot; &quot;</span>,vpnl.attribut);</span>
<span class="line" id="L2759">    }</span>
<span class="line" id="L2760">    <span class="tok-comment">// display msgerr</span>
</span>
<span class="line" id="L2761">    y = <span class="tok-number">1</span> ;</span>
<span class="line" id="L2762">    term.gotoXY(vpnl.posx + x  - <span class="tok-number">2</span>, y + vpnl.posy   );</span>
<span class="line" id="L2763">    term.writeStyled(msgerr,MsgErr);</span>
<span class="line" id="L2764"></span>
<span class="line" id="L2765">    <span class="tok-kw">while</span> (boucle) {</span>
<span class="line" id="L2766">      <span class="tok-kw">var</span> e_key = kbd.getKEY();</span>
<span class="line" id="L2767"></span>
<span class="line" id="L2768">      <span class="tok-kw">switch</span> ( e_key.Key ) {</span>
<span class="line" id="L2769">        .esc=&gt;boucle = <span class="tok-null">false</span>,</span>
<span class="line" id="L2770">      <span class="tok-kw">else</span> =&gt;  {},</span>
<span class="line" id="L2771">      }</span>
<span class="line" id="L2772">    }</span>
<span class="line" id="L2773"></span>
<span class="line" id="L2774">    <span class="tok-comment">// restore line panel</span>
</span>
<span class="line" id="L2775">    <span class="tok-kw">while</span> (y &lt;= (vpnl.cols - <span class="tok-number">2</span>)) : (y += <span class="tok-number">1</span>) {</span>
<span class="line" id="L2776">      n += <span class="tok-number">1</span>;</span>
<span class="line" id="L2777">      term.gotoXY( vpnl.posx + x  - <span class="tok-number">2</span>, y + vpnl.posy  );</span>
<span class="line" id="L2778">      term.writeStyled(vpnl.buf.items[n].ch,vpnl.buf.items[n].attribut);</span>
<span class="line" id="L2779">    }</span>
<span class="line" id="L2780">  }</span>
<span class="line" id="L2781"></span>
<span class="line" id="L2782"></span>
<span class="line" id="L2783">  <span class="tok-comment">//====================================================</span>
</span>
<span class="line" id="L2784">  <span class="tok-comment">// ioFIELD</span>
</span>
<span class="line" id="L2785">  <span class="tok-comment">//====================================================</span>
</span>
<span class="line" id="L2786">  </span>
<span class="line" id="L2787">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">ioField</span>(vpnl: *pnl.PANEL, vfld : FIELD ) kbd  {</span>
<span class="line" id="L2788">    <span class="tok-kw">if</span> (vfld.protect <span class="tok-kw">or</span> !vfld.actif)  <span class="tok-kw">return</span> kbd.none;</span>
<span class="line" id="L2789"></span>
<span class="line" id="L2790">    <span class="tok-kw">var</span> e_posx :<span class="tok-type">usize</span> = vpnl.posx + vfld.posx - <span class="tok-number">1</span>;</span>
<span class="line" id="L2791">    <span class="tok-kw">var</span> e_posy :<span class="tok-type">usize</span> = vpnl.posy + vfld.posy - <span class="tok-number">1</span>;</span>
<span class="line" id="L2792">    <span class="tok-kw">var</span> e_curs :<span class="tok-type">usize</span> = e_posy ;</span>
<span class="line" id="L2793">    <span class="tok-kw">var</span> e_count :<span class="tok-type">usize</span>  = <span class="tok-number">0</span>;</span>
<span class="line" id="L2794">    <span class="tok-kw">const</span> e_nbrcar:<span class="tok-type">usize</span>  = vfld.nbrcar;</span>
<span class="line" id="L2795">    <span class="tok-kw">var</span> statusCursInsert : <span class="tok-type">bool</span> = <span class="tok-null">false</span> ;</span>
<span class="line" id="L2796">    <span class="tok-kw">var</span> nfield :<span class="tok-type">usize</span> = <span class="tok-number">0</span> ;</span>
<span class="line" id="L2797"></span>
<span class="line" id="L2798">    <span class="tok-kw">const</span> allocator = std.heap.page_allocator;</span>
<span class="line" id="L2799">    e_FIELD = std.ArrayList([] <span class="tok-kw">const</span> <span class="tok-type">u8</span>).init(allocator);</span>
<span class="line" id="L2800">    <span class="tok-kw">defer</span> e_FIELD.deinit();</span>
<span class="line" id="L2801">    </span>
<span class="line" id="L2802">    e_switch = vfld.zwitch;</span>
<span class="line" id="L2803">    <span class="tok-kw">const</span> e_reftyp = vfld.reftyp;</span>
<span class="line" id="L2804"></span>
<span class="line" id="L2805">    <span class="tok-kw">var</span> tampon: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L2806"></span>
<span class="line" id="L2807">    <span class="tok-kw">if</span> ( e_posx == <span class="tok-number">0</span>) <span class="tok-kw">return</span> kbd.enter;</span>
<span class="line" id="L2808">    </span>
<span class="line" id="L2809">    vpnl.keyField = kbd.none;</span>
<span class="line" id="L2810">    </span>
<span class="line" id="L2811">    <span class="tok-comment">// prepare the switch edition</span>
</span>
<span class="line" id="L2812">    initData(vfld);</span>
<span class="line" id="L2813"></span>
<span class="line" id="L2814">    <span class="tok-kw">var</span> Fkey : term.Keyboard = <span class="tok-null">undefined</span> ;</span>
<span class="line" id="L2815">    <span class="tok-kw">var</span> boucle : <span class="tok-type">bool</span>= <span class="tok-null">true</span> ;</span>
<span class="line" id="L2816"></span>
<span class="line" id="L2817">    term.defCursor(dds.typeCursor.cBlink);</span>
<span class="line" id="L2818"></span>
<span class="line" id="L2819">    term.onMouse();</span>
<span class="line" id="L2820"></span>
<span class="line" id="L2821"></span>
<span class="line" id="L2822">    <span class="tok-comment">//===========================</span>
</span>
<span class="line" id="L2823">    <span class="tok-comment">// boucle saisie</span>
</span>
<span class="line" id="L2824">    <span class="tok-comment">//===========================</span>
</span>
<span class="line" id="L2825">    <span class="tok-kw">while</span>( boucle == <span class="tok-null">true</span>) {</span>
<span class="line" id="L2826">      </span>
<span class="line" id="L2827"></span>
<span class="line" id="L2828">      term.gotoXY(e_posx ,e_posy);</span>
<span class="line" id="L2829">      <span class="tok-kw">switch</span>(e_reftyp) {</span>
<span class="line" id="L2830">        .PASSWORD =&gt;  term.writeStyled(password(e_FIELD),AtrIO) ,</span>
<span class="line" id="L2831">        .SWITCH   =&gt;  <span class="tok-kw">if</span> (e_switch) term.writeStyled(dds.STRUE,AtrIO)</span>
<span class="line" id="L2832">                      <span class="tok-kw">else</span> term.writeStyled(dds.SFALSE,AtrIO),</span>
<span class="line" id="L2833">        <span class="tok-kw">else</span> =&gt; term.writeStyled(utl.listToStr(e_FIELD),AtrIO)</span>
<span class="line" id="L2834">      }</span>
<span class="line" id="L2835"></span>
<span class="line" id="L2836">      term.gotoXY(e_posx,e_curs);</span>
<span class="line" id="L2837"></span>
<span class="line" id="L2838">      <span class="tok-kw">if</span> (statusCursInsert) term.defCursor(dds.typeCursor.cSteadyBar)  </span>
<span class="line" id="L2839">      <span class="tok-kw">else</span> term.defCursor(dds.typeCursor.cBlink); <span class="tok-comment">// CHANGE CURSOR FORM BAR/BLOCK</span>
</span>
<span class="line" id="L2840"></span>
<span class="line" id="L2841">      <span class="tok-kw">switch</span>(e_reftyp) {</span>
<span class="line" id="L2842">        .PASSWORD =&gt; { </span>
<span class="line" id="L2843">                      <span class="tok-kw">if</span> ( std.mem.eql(<span class="tok-type">u8</span>,e_FIELD.items[e_count] , <span class="tok-str">&quot; &quot;</span>)  ) term.writeStyled(<span class="tok-str">&quot; &quot;</span>, AtrCursor)</span>
<span class="line" id="L2844">                      <span class="tok-kw">else</span> term.writeStyled(<span class="tok-str">&quot;*&quot;</span>, AtrCursor);</span>
<span class="line" id="L2845">        },</span>
<span class="line" id="L2846">        <span class="tok-kw">else</span> =&gt;term.writeStyled(e_FIELD.items[e_count], AtrCursor),</span>
<span class="line" id="L2847">      }</span>
<span class="line" id="L2848">      term.gotoXY(e_posx,e_curs);</span>
<span class="line" id="L2849">      term.cursShow();</span>
<span class="line" id="L2850"></span>
<span class="line" id="L2851">      Fkey = kbd.getKEY();</span>
<span class="line" id="L2852"></span>
<span class="line" id="L2853">      term.resetStyle();</span>
<span class="line" id="L2854"></span>
<span class="line" id="L2855">      <span class="tok-kw">if</span> (isfuncKey(vpnl,Fkey)) boucle = <span class="tok-null">false</span></span>
<span class="line" id="L2856">      <span class="tok-kw">else</span> {</span>
<span class="line" id="L2857">        <span class="tok-kw">if</span> (Fkey.Key == kbd.mouse ) {</span>
<span class="line" id="L2858">          Fkey.Key = kbd.none;</span>
<span class="line" id="L2859"></span>
<span class="line" id="L2860">          <span class="tok-kw">if</span> (term.MouseInfo.scroll ) {</span>
<span class="line" id="L2861">              <span class="tok-kw">switch</span> (term.MouseInfo.scrollDir) {</span>
<span class="line" id="L2862">              term.ScrollDirection.msUp =&gt;    Fkey.Key = kbd.up,</span>
<span class="line" id="L2863">              term.ScrollDirection.msDown =&gt;  Fkey.Key = kbd.down,</span>
<span class="line" id="L2864">              <span class="tok-kw">else</span> =&gt; {}</span>
<span class="line" id="L2865">              }</span>
<span class="line" id="L2866">          }</span>
<span class="line" id="L2867">          <span class="tok-kw">else</span> {</span>
<span class="line" id="L2868">        </span>
<span class="line" id="L2869">            <span class="tok-kw">if</span> (term.MouseInfo.action == term.MouseAction.maReleased ) <span class="tok-kw">continue</span>;</span>
<span class="line" id="L2870">            </span>
<span class="line" id="L2871">            <span class="tok-kw">if</span> (MouseDsp) dspMouse(vpnl);  <span class="tok-comment">// active display Cursor x/y mouse</span>
</span>
<span class="line" id="L2872"></span>
<span class="line" id="L2873">            <span class="tok-kw">switch</span> (term.MouseInfo.button) {</span>
<span class="line" id="L2874">              term.MouseButton.mbLeft    =&gt;  Fkey.Key = kbd.left,</span>
<span class="line" id="L2875"></span>
<span class="line" id="L2876">              term.MouseButton.mbMiddle  =&gt;  Fkey.Key = kbd.enter,</span>
<span class="line" id="L2877"></span>
<span class="line" id="L2878">              term.MouseButton.mbRight   =&gt;  Fkey.Key = kbd.right,</span>
<span class="line" id="L2879">              <span class="tok-kw">else</span> =&gt; {}</span>
<span class="line" id="L2880">            }</span>
<span class="line" id="L2881">          }</span>
<span class="line" id="L2882">        }</span>
<span class="line" id="L2883"></span>
<span class="line" id="L2884"></span>
<span class="line" id="L2885"></span>
<span class="line" id="L2886">        <span class="tok-kw">switch</span>(Fkey.Key) {</span>
<span class="line" id="L2887">          .none =&gt; {</span>
<span class="line" id="L2888">                  term.gotoXY(e_posx,e_curs);</span>
<span class="line" id="L2889">          },</span>
<span class="line" id="L2890">          .esc =&gt; {</span>
<span class="line" id="L2891">                  initData(vfld) ;</span>
<span class="line" id="L2892">          }, </span>
<span class="line" id="L2893">          .ctrlH =&gt; {</span>
<span class="line" id="L2894">            <span class="tok-kw">if</span> (  vfld.help.len &gt; <span class="tok-number">0</span> ) msgHelp(vpnl,vfld);</span>
<span class="line" id="L2895">          },</span>
<span class="line" id="L2896">          .home =&gt; {</span>
<span class="line" id="L2897">            e_count = <span class="tok-number">0</span>;</span>
<span class="line" id="L2898">            e_curs = e_posy;</span>
<span class="line" id="L2899">          },</span>
<span class="line" id="L2900">          .end =&gt; {</span>
<span class="line" id="L2901">            tampon  = utl.listToStr(e_FIELD);</span>
<span class="line" id="L2902">            <span class="tok-kw">if</span> ( utl.trimStr(tampon).len &gt; <span class="tok-number">0</span>) {</span>
<span class="line" id="L2903">              e_count = utl.trimStr(tampon).len - <span class="tok-number">1</span>;</span>
<span class="line" id="L2904">              e_curs  = e_posy + utl.trimStr(tampon).len - <span class="tok-number">1</span>;</span>
<span class="line" id="L2905">            }</span>
<span class="line" id="L2906">            <span class="tok-kw">else</span> {</span>
<span class="line" id="L2907">              e_count = <span class="tok-number">0</span> ;</span>
<span class="line" id="L2908">              e_curs  = e_posy;</span>
<span class="line" id="L2909">            }</span>
<span class="line" id="L2910">          },</span>
<span class="line" id="L2911">          .right , .tab  =&gt; {</span>
<span class="line" id="L2912">            <span class="tok-kw">if</span> ( e_count &lt; e_nbrcar - <span class="tok-number">1</span> <span class="tok-kw">and</span> !isSpace(e_FIELD.items[<span class="tok-number">0</span>])) {</span>
<span class="line" id="L2913">                e_count += <span class="tok-number">1</span>;</span>
<span class="line" id="L2914">                e_curs  += <span class="tok-number">1</span>;</span>
<span class="line" id="L2915">            }</span>
<span class="line" id="L2916">          },</span>
<span class="line" id="L2917">          .left , .stab=&gt; {</span>
<span class="line" id="L2918">            <span class="tok-kw">if</span>( e_curs &gt; e_posy) {</span>
<span class="line" id="L2919">            e_count -= <span class="tok-number">1</span>;</span>
<span class="line" id="L2920">            e_curs  -= <span class="tok-number">1</span>;</span>
<span class="line" id="L2921">            }</span>
<span class="line" id="L2922">          },</span>
<span class="line" id="L2923">          .backspace =&gt; {</span>
<span class="line" id="L2924">            <span class="tok-kw">if</span>( e_reftyp != dds.REFTYP.SWITCH) {</span>
<span class="line" id="L2925">              delete(e_count);</span>
<span class="line" id="L2926">              tampon  = utl.listToStr(e_FIELD);</span>
<span class="line" id="L2927">              <span class="tok-kw">if</span>( e_count &gt; <span class="tok-number">0</span> ) {</span>
<span class="line" id="L2928">                e_count = utl.trimStr(tampon).len - <span class="tok-number">1</span> ;</span>
<span class="line" id="L2929">                e_curs  = e_posy + e_count;</span>
<span class="line" id="L2930">              }</span>
<span class="line" id="L2931">              <span class="tok-kw">else</span> {e_count = <span class="tok-number">0</span>; e_curs  = e_posy ;}</span>
<span class="line" id="L2932">            }</span>
<span class="line" id="L2933">          },</span>
<span class="line" id="L2934">          .delete=&gt; {</span>
<span class="line" id="L2935">            <span class="tok-kw">if</span>( e_reftyp != dds.REFTYP.SWITCH) {</span>
<span class="line" id="L2936">              <span class="tok-kw">if</span>( e_count &gt;= <span class="tok-number">0</span>) {</span>
<span class="line" id="L2937">                <span class="tok-kw">if</span> (e_reftyp == dds.REFTYP.DIGIT  <span class="tok-kw">and</span> e_count &gt;= <span class="tok-number">0</span> <span class="tok-kw">or</span>  e_reftyp == dds.REFTYP.DECIMAL <span class="tok-kw">and</span> e_count &gt;= <span class="tok-number">0</span> ) {</span>
<span class="line" id="L2938">                    delete(e_count);</span>
<span class="line" id="L2939">                  }</span>
<span class="line" id="L2940">                  <span class="tok-kw">else</span> <span class="tok-kw">if</span> (e_reftyp != dds.REFTYP.DIGIT   <span class="tok-kw">and</span>  e_reftyp != dds.REFTYP.DECIMAL)  {</span>
<span class="line" id="L2941">                          delete(e_count);</span>
<span class="line" id="L2942">                        }</span>
<span class="line" id="L2943">              }</span>
<span class="line" id="L2944">            }</span>
<span class="line" id="L2945">          },</span>
<span class="line" id="L2946">          .ins=&gt; {</span>
<span class="line" id="L2947">            <span class="tok-kw">if</span>( statusCursInsert )  statusCursInsert = <span class="tok-null">false</span></span>
<span class="line" id="L2948">            <span class="tok-kw">else</span> statusCursInsert = <span class="tok-null">true</span>;</span>
<span class="line" id="L2949">          },</span>
<span class="line" id="L2950">          .enter , .up , .down =&gt; {  <span class="tok-comment">// enrg to Field</span>
</span>
<span class="line" id="L2951"></span>
<span class="line" id="L2952">            <span class="tok-comment">//check requier and field.len &gt; 0</span>
</span>
<span class="line" id="L2953">            <span class="tok-kw">if</span> (vfld.requier <span class="tok-kw">and</span> utl.trimStr(utl.listToStr(e_FIELD)).len == <span class="tok-number">0</span> ) {</span>
<span class="line" id="L2954">              msgErr(vpnl,vfld,vfld.errmsg);</span>
<span class="line" id="L2955">              e_curs = e_posy;</span>
<span class="line" id="L2956">              e_count = <span class="tok-number">0</span>;</span>
<span class="line" id="L2957">              <span class="tok-kw">continue</span>;</span>
<span class="line" id="L2958">            }</span>
<span class="line" id="L2959"></span>
<span class="line" id="L2960">            <span class="tok-comment">//check requier and field.len &gt; 0 and regexLen &gt; 0 execute regex</span>
</span>
<span class="line" id="L2961">            <span class="tok-kw">if</span> ( vfld.regex.len &gt; <span class="tok-number">0</span> <span class="tok-kw">and</span> vfld.requier <span class="tok-kw">and</span> utl.trimStr(utl.listToStr(e_FIELD)).len &gt; <span class="tok-number">0</span>) {</span>
<span class="line" id="L2962">                <span class="tok-kw">if</span> ( ! reg.isMatch(utl.trimStr(utl.listToStr(e_FIELD)) ,vfld.regex) ) {</span>
<span class="line" id="L2963">                  msgErr(vpnl,vfld,vfld.errmsg);</span>
<span class="line" id="L2964">                  e_curs = e_posy;</span>
<span class="line" id="L2965">                  e_count = <span class="tok-number">0</span> ;</span>
<span class="line" id="L2966">                  <span class="tok-kw">continue</span>;</span>
<span class="line" id="L2967">                }</span>
<span class="line" id="L2968">            }</span>
<span class="line" id="L2969"></span>
<span class="line" id="L2970"></span>
<span class="line" id="L2971">            <span class="tok-comment">//write value keyboard to field.text return key</span>
</span>
<span class="line" id="L2972">            nfield = getIndex(vpnl,vfld.name) <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L2973"></span>
<span class="line" id="L2974">            <span class="tok-kw">if</span> (vfld.reftyp == dds.REFTYP.SWITCH) setSwitch(vpnl, nfield, e_switch ) </span>
<span class="line" id="L2975">              <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));}</span>
<span class="line" id="L2976">            </span>
<span class="line" id="L2977">            <span class="tok-kw">else</span> {</span>
<span class="line" id="L2978">              </span>
<span class="line" id="L2979">              setText(vpnl, nfield, ToStr(utl.trimStr(utl.listToStr(e_FIELD)))) </span>
<span class="line" id="L2980">              <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L2981">            }</span>
<span class="line" id="L2982">            vpnl.keyField = Fkey.Key; </span>
<span class="line" id="L2983">            <span class="tok-comment">// control is task </span>
</span>
<span class="line" id="L2984">            <span class="tok-kw">if</span> ( vfld.proctask.len &gt; <span class="tok-number">0</span>) {</span>
<span class="line" id="L2985">              Fkey.Key = kbd.task;</span>
<span class="line" id="L2986">              <span class="tok-kw">break</span>; </span>
<span class="line" id="L2987">            }</span>
<span class="line" id="L2988">            </span>
<span class="line" id="L2989"></span>
<span class="line" id="L2990">            <span class="tok-kw">break</span>;          </span>
<span class="line" id="L2991">          },</span>
<span class="line" id="L2992">          .char=&gt; {</span>
<span class="line" id="L2993">            <span class="tok-kw">if</span> (utl.isCarOmit(Fkey.Char) == <span class="tok-null">false</span> ) </span>
<span class="line" id="L2994">              <span class="tok-kw">switch</span>(e_reftyp) {</span>
<span class="line" id="L2995">                .TEXT_FREE=&gt; {</span>
<span class="line" id="L2996">                  <span class="tok-kw">if</span> ( (e_count &lt; e_nbrcar <span class="tok-kw">and</span> isSpace(Fkey.Char) == <span class="tok-null">false</span> ) <span class="tok-kw">or</span></span>
<span class="line" id="L2997">                    (isSpace(Fkey.Char) == <span class="tok-null">true</span> <span class="tok-kw">and</span> e_count &gt; <span class="tok-number">0</span> <span class="tok-kw">and</span> e_count &lt; e_nbrcar) ) {</span>
<span class="line" id="L2998">                    </span>
<span class="line" id="L2999">                    <span class="tok-kw">if</span> (statusCursInsert <span class="tok-kw">and</span> e_count &lt; e_nbrcar - <span class="tok-number">1</span>) insert(Fkey.Char,e_count)</span>
<span class="line" id="L3000">                    <span class="tok-kw">else</span>  e_FIELD.items[e_count] = Fkey.Char;</span>
<span class="line" id="L3001"></span>
<span class="line" id="L3002">                    e_count += <span class="tok-number">1</span>;</span>
<span class="line" id="L3003">                    e_curs  += <span class="tok-number">1</span>;</span>
<span class="line" id="L3004">                    <span class="tok-kw">if</span> (e_count == e_nbrcar) {</span>
<span class="line" id="L3005">                      e_count -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3006">                      e_curs  -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3007">                    }</span>
<span class="line" id="L3008">                    </span>
<span class="line" id="L3009"></span>
<span class="line" id="L3010">                  }</span>
<span class="line" id="L3011">                },</span>
<span class="line" id="L3012">                .TEXT_FULL=&gt; {</span>
<span class="line" id="L3013">                  <span class="tok-kw">if</span> ( (e_count &lt; e_nbrcar <span class="tok-kw">and</span> isSpace(Fkey.Char) == <span class="tok-null">false</span> ) <span class="tok-kw">or</span></span>
<span class="line" id="L3014">                    (utl.isLetterStr(Fkey.Char) <span class="tok-kw">or</span> utl.isDigitStr(Fkey.Char) <span class="tok-kw">or</span> utl.isSpecialStr(Fkey.Char)) <span class="tok-kw">or</span></span>
<span class="line" id="L3015">                    (isSpace(Fkey.Char) == <span class="tok-null">true</span> <span class="tok-kw">and</span> e_count &gt; <span class="tok-number">0</span> <span class="tok-kw">and</span> e_count &lt; e_nbrcar) ) {</span>
<span class="line" id="L3016">                    </span>
<span class="line" id="L3017">                    <span class="tok-kw">if</span> (statusCursInsert <span class="tok-kw">and</span> e_count &lt; e_nbrcar - <span class="tok-number">1</span>) insert(Fkey.Char,e_count)</span>
<span class="line" id="L3018">                    <span class="tok-kw">else</span>  e_FIELD.items[e_count] = Fkey.Char;</span>
<span class="line" id="L3019"></span>
<span class="line" id="L3020">                    e_count += <span class="tok-number">1</span>;</span>
<span class="line" id="L3021">                    e_curs  += <span class="tok-number">1</span>;</span>
<span class="line" id="L3022">                    <span class="tok-kw">if</span> (e_count == e_nbrcar) {</span>
<span class="line" id="L3023">                      e_count -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3024">                      e_curs  -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3025">                    }</span>
<span class="line" id="L3026">                    </span>
<span class="line" id="L3027"></span>
<span class="line" id="L3028">                  }</span>
<span class="line" id="L3029">                },</span>
<span class="line" id="L3030">                .ALPHA, .ALPHA_UPPER =&gt; {</span>
<span class="line" id="L3031">                  <span class="tok-kw">if</span> ( (e_count &lt; e_nbrcar <span class="tok-kw">and</span> isSpace(Fkey.Char) == <span class="tok-null">false</span> ) <span class="tok-kw">and</span></span>
<span class="line" id="L3032">                  (utl.isLetterStr(Fkey.Char) <span class="tok-kw">or</span> std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;-&quot;</span>)) <span class="tok-kw">or</span></span>
<span class="line" id="L3033">                  (isSpace(Fkey.Char) == <span class="tok-null">true</span> <span class="tok-kw">and</span> e_count &gt; <span class="tok-number">0</span> <span class="tok-kw">and</span> e_count &lt; e_nbrcar) ) {</span>
<span class="line" id="L3034">                    </span>
<span class="line" id="L3035">                    <span class="tok-kw">if</span> (vfld.reftyp == .ALPHA_UPPER) Fkey.Char = utl.upperStr(Fkey.Char);</span>
<span class="line" id="L3036"></span>
<span class="line" id="L3037">                    <span class="tok-kw">if</span> (statusCursInsert <span class="tok-kw">and</span> e_count &lt; e_nbrcar - <span class="tok-number">1</span>) insert(Fkey.Char,e_count)</span>
<span class="line" id="L3038">                    <span class="tok-kw">else</span>  e_FIELD.items[e_count] = Fkey.Char;</span>
<span class="line" id="L3039"></span>
<span class="line" id="L3040">                    e_count += <span class="tok-number">1</span>;</span>
<span class="line" id="L3041">                    e_curs  += <span class="tok-number">1</span>;</span>
<span class="line" id="L3042">                    <span class="tok-kw">if</span> (e_count == e_nbrcar) {</span>
<span class="line" id="L3043">                      e_count -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3044">                      e_curs  -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3045">                    }</span>
<span class="line" id="L3046">                  }</span>
<span class="line" id="L3047">                },</span>
<span class="line" id="L3048">                .ALPHA_NUMERIC, .ALPHA_NUMERIC_UPPER =&gt; {</span>
<span class="line" id="L3049">                  <span class="tok-kw">if</span> ( (e_count &lt; e_nbrcar <span class="tok-kw">and</span> isSpace(Fkey.Char) == <span class="tok-null">false</span> ) <span class="tok-kw">and</span></span>
<span class="line" id="L3050">                  (utl.isLetterStr(Fkey.Char) <span class="tok-kw">or</span> utl.isDigitStr(Fkey.Char) <span class="tok-kw">or</span> std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;-&quot;</span>)) <span class="tok-kw">or</span></span>
<span class="line" id="L3051">                  (isSpace(Fkey.Char) == <span class="tok-null">true</span> <span class="tok-kw">and</span> e_count &gt; <span class="tok-number">0</span> <span class="tok-kw">and</span> e_count &lt; e_nbrcar) ) {</span>
<span class="line" id="L3052"></span>
<span class="line" id="L3053">                    <span class="tok-kw">if</span> (vfld.reftyp == .ALPHA_NUMERIC_UPPER) Fkey.Char = utl.upperStr(Fkey.Char);</span>
<span class="line" id="L3054"></span>
<span class="line" id="L3055">                    <span class="tok-kw">if</span> (statusCursInsert <span class="tok-kw">and</span> e_count &lt; e_nbrcar - <span class="tok-number">1</span>) insert(Fkey.Char,e_count)</span>
<span class="line" id="L3056">                    <span class="tok-kw">else</span>  e_FIELD.items[e_count] = Fkey.Char;</span>
<span class="line" id="L3057"></span>
<span class="line" id="L3058">                    e_count += <span class="tok-number">1</span>;</span>
<span class="line" id="L3059">                    e_curs  += <span class="tok-number">1</span>;</span>
<span class="line" id="L3060">                    <span class="tok-kw">if</span> (e_count == e_nbrcar) {</span>
<span class="line" id="L3061">                      e_count -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3062">                      e_curs  -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3063">                    }</span>
<span class="line" id="L3064">                  }</span>
<span class="line" id="L3065">                },</span>
<span class="line" id="L3066">                .PASSWORD =&gt; {</span>
<span class="line" id="L3067">                  <span class="tok-kw">if</span> ( (e_count &lt; e_nbrcar <span class="tok-kw">and</span> isSpace(Fkey.Char) == <span class="tok-null">false</span> ) <span class="tok-kw">and</span></span>
<span class="line" id="L3068">                  (utl.isPassword(Fkey.Char) ) ) {</span>
<span class="line" id="L3069"></span>
<span class="line" id="L3070">                    <span class="tok-kw">if</span> (statusCursInsert <span class="tok-kw">and</span> e_count &lt; e_nbrcar - <span class="tok-number">1</span>) insert(Fkey.Char,e_count)</span>
<span class="line" id="L3071">                    <span class="tok-kw">else</span>  e_FIELD.items[e_count] = Fkey.Char;</span>
<span class="line" id="L3072"></span>
<span class="line" id="L3073">                    e_count += <span class="tok-number">1</span>;</span>
<span class="line" id="L3074">                    e_curs  += <span class="tok-number">1</span>;</span>
<span class="line" id="L3075">                    <span class="tok-kw">if</span> (e_count == e_nbrcar) {</span>
<span class="line" id="L3076">                      e_count -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3077">                      e_curs  -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3078">                    }</span>
<span class="line" id="L3079">                  }</span>
<span class="line" id="L3080">                },</span>
<span class="line" id="L3081">                .YES_NO =&gt; {</span>
<span class="line" id="L3082">                  <span class="tok-kw">if</span> (std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;Y&quot;</span>)  <span class="tok-kw">or</span></span>
<span class="line" id="L3083">                      std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;y&quot;</span>)  <span class="tok-kw">or</span> </span>
<span class="line" id="L3084">                      std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;N&quot;</span>)  <span class="tok-kw">or</span> </span>
<span class="line" id="L3085">                      std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;n&quot;</span>)  ) {</span>
<span class="line" id="L3086">                    </span>
<span class="line" id="L3087">                    Fkey.Char = utl.upperStr(Fkey.Char);</span>
<span class="line" id="L3088"></span>
<span class="line" id="L3089">                    <span class="tok-kw">if</span> (statusCursInsert <span class="tok-kw">and</span> e_count &lt; e_nbrcar - <span class="tok-number">1</span>) insert(Fkey.Char,e_count)</span>
<span class="line" id="L3090">                    <span class="tok-kw">else</span>  e_FIELD.items[e_count] = Fkey.Char;</span>
<span class="line" id="L3091">                    }</span>
<span class="line" id="L3092">                },</span>
<span class="line" id="L3093">                .UDIGIT =&gt; {</span>
<span class="line" id="L3094">                  <span class="tok-kw">if</span> (e_count &lt; e_nbrcar <span class="tok-kw">and</span> utl.isDigitStr(Fkey.Char)  <span class="tok-kw">and</span> </span>
<span class="line" id="L3095">                    ! std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;-&quot;</span>) <span class="tok-kw">and</span></span>
<span class="line" id="L3096">                    ! std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;+&quot;</span>)  ) {</span>
<span class="line" id="L3097">                    </span>
<span class="line" id="L3098">                    <span class="tok-kw">if</span> (statusCursInsert <span class="tok-kw">and</span> e_count &lt; e_nbrcar - <span class="tok-number">1</span>) insert(Fkey.Char,e_count)</span>
<span class="line" id="L3099">                    <span class="tok-kw">else</span>  e_FIELD.items[e_count] = Fkey.Char;</span>
<span class="line" id="L3100"></span>
<span class="line" id="L3101">                    e_count += <span class="tok-number">1</span>;</span>
<span class="line" id="L3102">                    e_curs  += <span class="tok-number">1</span>;</span>
<span class="line" id="L3103">                    <span class="tok-kw">if</span> (e_count == e_nbrcar) {</span>
<span class="line" id="L3104">                      e_count -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3105">                      e_curs  -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3106">                    }</span>
<span class="line" id="L3107">                  }</span>
<span class="line" id="L3108">                },</span>
<span class="line" id="L3109">                .DIGIT =&gt; {</span>
<span class="line" id="L3110">                  <span class="tok-kw">if</span> (e_count &lt; e_nbrcar <span class="tok-kw">and</span> utl.isDigitStr(Fkey.Char) <span class="tok-kw">and</span> e_count &gt; <span class="tok-number">0</span> <span class="tok-kw">or</span></span>
<span class="line" id="L3111">                    (std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;-&quot;</span>) <span class="tok-kw">and</span> e_count == <span class="tok-number">0</span>) <span class="tok-kw">or</span></span>
<span class="line" id="L3112">                    (std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;+&quot;</span>) <span class="tok-kw">and</span> e_count == <span class="tok-number">0</span>)) {</span>
<span class="line" id="L3113">                    </span>
<span class="line" id="L3114">                    <span class="tok-kw">if</span> (statusCursInsert <span class="tok-kw">and</span> e_count &lt; e_nbrcar - <span class="tok-number">1</span>) insert(Fkey.Char,e_count)</span>
<span class="line" id="L3115">                    <span class="tok-kw">else</span>  e_FIELD.items[e_count] = Fkey.Char;</span>
<span class="line" id="L3116"></span>
<span class="line" id="L3117">                    e_count += <span class="tok-number">1</span>;</span>
<span class="line" id="L3118">                    e_curs  += <span class="tok-number">1</span>;</span>
<span class="line" id="L3119">                    <span class="tok-kw">if</span> (e_count == e_nbrcar) {</span>
<span class="line" id="L3120">                      e_count -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3121">                      e_curs  -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3122">                    }</span>
<span class="line" id="L3123">                  }</span>
<span class="line" id="L3124">                },</span>
<span class="line" id="L3125">                .UDECIMAL =&gt; {</span>
<span class="line" id="L3126">                  <span class="tok-kw">if</span> (e_count &lt; e_nbrcar <span class="tok-kw">and</span> utl.isDigitStr(Fkey.Char) <span class="tok-kw">or</span> </span>
<span class="line" id="L3127">                    (std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;.&quot;</span>) <span class="tok-kw">and</span> e_count &gt; <span class="tok-number">1</span>) <span class="tok-kw">or</span></span>
<span class="line" id="L3128">                    !std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;-&quot;</span>) <span class="tok-kw">and</span> ! std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;+&quot;</span>) ) {</span>
<span class="line" id="L3129"></span>
<span class="line" id="L3130">                    <span class="tok-kw">if</span> (vfld.scal == <span class="tok-number">0</span> <span class="tok-kw">and</span> std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;.&quot;</span>) ) <span class="tok-kw">continue</span> ;</span>
<span class="line" id="L3131">                    </span>
<span class="line" id="L3132"></span>
<span class="line" id="L3133">                    <span class="tok-kw">if</span> (statusCursInsert <span class="tok-kw">and</span> e_count &lt; e_nbrcar - <span class="tok-number">1</span>) insert(Fkey.Char,e_count)</span>
<span class="line" id="L3134">                    <span class="tok-kw">else</span>  e_FIELD.items[e_count] = Fkey.Char;</span>
<span class="line" id="L3135"></span>
<span class="line" id="L3136">                    e_count += <span class="tok-number">1</span>;</span>
<span class="line" id="L3137">                    e_curs  += <span class="tok-number">1</span>;</span>
<span class="line" id="L3138">                    <span class="tok-kw">if</span> (e_count == e_nbrcar) {</span>
<span class="line" id="L3139">                      e_count -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3140">                      e_curs  -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3141">                    }</span>
<span class="line" id="L3142">                    </span>
<span class="line" id="L3143">                  }</span>
<span class="line" id="L3144">                },</span>
<span class="line" id="L3145">                .DECIMAL =&gt; {</span>
<span class="line" id="L3146">                  <span class="tok-kw">if</span> (e_count &lt; e_nbrcar <span class="tok-kw">and</span> utl.isDigitStr(Fkey.Char) <span class="tok-kw">and</span> e_count &gt; <span class="tok-number">0</span> <span class="tok-kw">or</span> </span>
<span class="line" id="L3147">                    (std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;.&quot;</span>) <span class="tok-kw">and</span> e_count &gt; <span class="tok-number">1</span>) <span class="tok-kw">or</span></span>
<span class="line" id="L3148">                    (std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;-&quot;</span>) <span class="tok-kw">and</span> e_count == <span class="tok-number">0</span>) <span class="tok-kw">or</span></span>
<span class="line" id="L3149">                    (std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;+&quot;</span>) <span class="tok-kw">and</span> e_count == <span class="tok-number">0</span>)) {</span>
<span class="line" id="L3150"></span>
<span class="line" id="L3151">                    <span class="tok-kw">if</span> (vfld.scal == <span class="tok-number">0</span> <span class="tok-kw">and</span> std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;.&quot;</span>) ) <span class="tok-kw">continue</span>;                 </span>
<span class="line" id="L3152"></span>
<span class="line" id="L3153">                    <span class="tok-kw">if</span> (statusCursInsert <span class="tok-kw">and</span> e_count &lt; e_nbrcar - <span class="tok-number">1</span>) insert(Fkey.Char,e_count)</span>
<span class="line" id="L3154">                    <span class="tok-kw">else</span>  e_FIELD.items[e_count] = Fkey.Char;</span>
<span class="line" id="L3155"></span>
<span class="line" id="L3156">                    e_count += <span class="tok-number">1</span>;</span>
<span class="line" id="L3157">                    e_curs  += <span class="tok-number">1</span>;</span>
<span class="line" id="L3158">                    <span class="tok-kw">if</span> (e_count == e_nbrcar) {</span>
<span class="line" id="L3159">                      e_count -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3160">                      e_curs  -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3161">                    }</span>
<span class="line" id="L3162">                    </span>
<span class="line" id="L3163">                  }</span>
<span class="line" id="L3164">                },</span>
<span class="line" id="L3165">                .DATE_ISO =&gt; {</span>
<span class="line" id="L3166">                  <span class="tok-kw">if</span> (e_count &lt; e_nbrcar) {</span>
<span class="line" id="L3167">                    <span class="tok-kw">if</span> (( utl.isDigitStr(Fkey.Char) <span class="tok-kw">and</span> e_count &lt;= <span class="tok-number">3</span>) <span class="tok-kw">or</span></span>
<span class="line" id="L3168">                        ( utl.isDigitStr(Fkey.Char) <span class="tok-kw">and</span> e_count == <span class="tok-number">5</span> ) <span class="tok-kw">or</span></span>
<span class="line" id="L3169">                        ( utl.isDigitStr(Fkey.Char) <span class="tok-kw">and</span> e_count == <span class="tok-number">6</span> ) <span class="tok-kw">or</span></span>
<span class="line" id="L3170">                        ( utl.isDigitStr(Fkey.Char) <span class="tok-kw">and</span> e_count == <span class="tok-number">8</span> ) <span class="tok-kw">or</span></span>
<span class="line" id="L3171">                        ( utl.isDigitStr(Fkey.Char) <span class="tok-kw">and</span> e_count == <span class="tok-number">9</span> ) <span class="tok-kw">or</span></span>
<span class="line" id="L3172">                        (std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;-&quot;</span>) <span class="tok-kw">and</span> e_count == <span class="tok-number">4</span>) <span class="tok-kw">or</span></span>
<span class="line" id="L3173">                        (std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;-&quot;</span>) <span class="tok-kw">and</span> e_count == <span class="tok-number">7</span>) ) {</span>
<span class="line" id="L3174">                    </span>
<span class="line" id="L3175">                      <span class="tok-kw">if</span> (statusCursInsert <span class="tok-kw">and</span> e_count &lt; e_nbrcar - <span class="tok-number">1</span>) insert(Fkey.Char,e_count)</span>
<span class="line" id="L3176">                      <span class="tok-kw">else</span>  e_FIELD.items[e_count] = Fkey.Char;</span>
<span class="line" id="L3177"></span>
<span class="line" id="L3178">                      e_count += <span class="tok-number">1</span>;</span>
<span class="line" id="L3179">                      e_curs  += <span class="tok-number">1</span>;</span>
<span class="line" id="L3180">                      <span class="tok-kw">if</span> (e_count == e_nbrcar) {</span>
<span class="line" id="L3181">                        e_count -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3182">                        e_curs  -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3183">                      }</span>
<span class="line" id="L3184">                    }</span>
<span class="line" id="L3185">                  }</span>
<span class="line" id="L3186">                },</span>
<span class="line" id="L3187">                .DATE_FR , .DATE_US  =&gt; {</span>
<span class="line" id="L3188">                  <span class="tok-kw">if</span> (e_count &lt; e_nbrcar ) {</span>
<span class="line" id="L3189">                    <span class="tok-kw">if</span> (( utl.isDigitStr(Fkey.Char) <span class="tok-kw">and</span> e_count &lt;= <span class="tok-number">1</span>) <span class="tok-kw">or</span></span>
<span class="line" id="L3190">                        ( utl.isDigitStr(Fkey.Char) <span class="tok-kw">and</span> e_count == <span class="tok-number">3</span> ) <span class="tok-kw">or</span></span>
<span class="line" id="L3191">                        ( utl.isDigitStr(Fkey.Char) <span class="tok-kw">and</span> e_count == <span class="tok-number">4</span> ) <span class="tok-kw">or</span></span>
<span class="line" id="L3192">                        ( utl.isDigitStr(Fkey.Char) <span class="tok-kw">and</span> e_count &gt;= <span class="tok-number">6</span> ) <span class="tok-kw">or</span></span>
<span class="line" id="L3193">                        (std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;/&quot;</span>) <span class="tok-kw">and</span> e_count == <span class="tok-number">2</span>) <span class="tok-kw">or</span></span>
<span class="line" id="L3194">                        (std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;/&quot;</span>) <span class="tok-kw">and</span> e_count == <span class="tok-number">5</span>) ) {</span>
<span class="line" id="L3195">                      </span>
<span class="line" id="L3196">                      <span class="tok-kw">if</span> (statusCursInsert <span class="tok-kw">and</span> e_count &lt; e_nbrcar - <span class="tok-number">1</span>) insert(Fkey.Char,e_count)</span>
<span class="line" id="L3197">                      <span class="tok-kw">else</span>  e_FIELD.items[e_count] = Fkey.Char;</span>
<span class="line" id="L3198"></span>
<span class="line" id="L3199">                      e_count += <span class="tok-number">1</span>;</span>
<span class="line" id="L3200">                      e_curs  += <span class="tok-number">1</span>;</span>
<span class="line" id="L3201">                      <span class="tok-kw">if</span> (e_count == e_nbrcar) {</span>
<span class="line" id="L3202">                        e_count -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3203">                        e_curs  -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3204">                      }</span>
<span class="line" id="L3205">                    }</span>
<span class="line" id="L3206">                  }</span>
<span class="line" id="L3207">                },</span>
<span class="line" id="L3208">                .TELEPHONE=&gt; {</span>
<span class="line" id="L3209">                  <span class="tok-kw">if</span> ((e_count &lt; e_nbrcar ) <span class="tok-kw">and</span></span>
<span class="line" id="L3210">                      (utl.isDigitStr(Fkey.Char) <span class="tok-kw">or</span> </span>
<span class="line" id="L3211">                      std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;(&quot;</span>) <span class="tok-kw">or</span></span>
<span class="line" id="L3212">                      std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;)&quot;</span>) <span class="tok-kw">or</span></span>
<span class="line" id="L3213">                      std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot; &quot;</span>) <span class="tok-kw">or</span></span>
<span class="line" id="L3214">                      std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;+&quot;</span>) <span class="tok-kw">or</span></span>
<span class="line" id="L3215">                      std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;-&quot;</span>) <span class="tok-kw">or</span></span>
<span class="line" id="L3216">                      std.mem.eql(<span class="tok-type">u8</span>, Fkey.Char, <span class="tok-str">&quot;.&quot;</span>) ) ){</span>
<span class="line" id="L3217">                    </span>
<span class="line" id="L3218">                    <span class="tok-kw">if</span> (statusCursInsert) insert(Fkey.Char,e_count)</span>
<span class="line" id="L3219">                    <span class="tok-kw">else</span>  e_FIELD.items[e_count] = Fkey.Char;</span>
<span class="line" id="L3220"></span>
<span class="line" id="L3221">                    e_count += <span class="tok-number">1</span>;</span>
<span class="line" id="L3222">                    e_curs  += <span class="tok-number">1</span>;</span>
<span class="line" id="L3223">                    <span class="tok-kw">if</span> (e_count == e_nbrcar) {</span>
<span class="line" id="L3224">                      e_count -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3225">                      e_curs  -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3226">                    }</span>
<span class="line" id="L3227">                  }</span>
<span class="line" id="L3228">                },</span>
<span class="line" id="L3229">                .MAIL_ISO =&gt; {</span>
<span class="line" id="L3230">                  <span class="tok-kw">if</span> (e_count &lt; e_nbrcar <span class="tok-kw">and</span> isSpace(Fkey.Char) == <span class="tok-null">false</span> <span class="tok-kw">and</span> </span>
<span class="line" id="L3231">                    utl.isMailStr(Fkey.Char)) {</span>
<span class="line" id="L3232">                    </span>
<span class="line" id="L3233">                    <span class="tok-kw">if</span> (statusCursInsert <span class="tok-kw">and</span> e_count &lt; e_nbrcar - <span class="tok-number">1</span>) insert(Fkey.Char,e_count)</span>
<span class="line" id="L3234">                    <span class="tok-kw">else</span>  e_FIELD.items[e_count] = Fkey.Char;</span>
<span class="line" id="L3235"></span>
<span class="line" id="L3236">                    e_count += <span class="tok-number">1</span>;</span>
<span class="line" id="L3237">                    e_curs  += <span class="tok-number">1</span>;</span>
<span class="line" id="L3238">                    <span class="tok-kw">if</span> (e_count == e_nbrcar) {</span>
<span class="line" id="L3239">                      e_count -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3240">                      e_curs  -= <span class="tok-number">1</span>;</span>
<span class="line" id="L3241">                    }</span>
<span class="line" id="L3242">                    </span>
<span class="line" id="L3243"></span>
<span class="line" id="L3244">                  }</span>
<span class="line" id="L3245">                },</span>
<span class="line" id="L3246">                .SWITCH =&gt; {</span>
<span class="line" id="L3247">                  <span class="tok-kw">if</span> (isSpace(Fkey.Char)) {</span>
<span class="line" id="L3248">                    </span>
<span class="line" id="L3249">                    <span class="tok-kw">if</span> (e_switch == <span class="tok-null">false</span>) {</span>
<span class="line" id="L3250">                      e_FIELD.items[e_count] = dds.STRUE;</span>
<span class="line" id="L3251">                      e_switch = <span class="tok-null">true</span>;</span>
<span class="line" id="L3252">                    }</span>
<span class="line" id="L3253">                    <span class="tok-kw">else</span> {</span>
<span class="line" id="L3254">                      e_FIELD.items[e_count] = dds.SFALSE;</span>
<span class="line" id="L3255">                      e_switch = <span class="tok-null">false</span>;</span>
<span class="line" id="L3256">                    }</span>
<span class="line" id="L3257">                  }</span>
<span class="line" id="L3258">                },</span>
<span class="line" id="L3259">                .FUNC =&gt; {</span>
<span class="line" id="L3260">                  Fkey.Key =kbd.func;</span>
<span class="line" id="L3261">                  <span class="tok-kw">break</span>;},</span>
<span class="line" id="L3262">                <span class="tok-kw">else</span> =&gt; {},</span>
<span class="line" id="L3263">              };</span>
<span class="line" id="L3264">              </span>
<span class="line" id="L3265">          },</span>
<span class="line" id="L3266">          <span class="tok-kw">else</span> =&gt; {},</span>
<span class="line" id="L3267">          </span>
<span class="line" id="L3268">        }</span>
<span class="line" id="L3269">      }</span>
<span class="line" id="L3270">    }</span>
<span class="line" id="L3271"></span>
<span class="line" id="L3272"></span>
<span class="line" id="L3273">    <span class="tok-kw">return</span> Fkey.Key;</span>
<span class="line" id="L3274">  }</span>
<span class="line" id="L3275"></span>
<span class="line" id="L3276">};</span>
<span class="line" id="L3277"></span>
<span class="line" id="L3278"></span>
<span class="line" id="L3279"><span class="tok-comment">// defined Panel</span>
</span>
<span class="line" id="L3280"><span class="tok-kw">pub</span> <span class="tok-kw">const</span>  pnl = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L3281"></span>
<span class="line" id="L3282">  <span class="tok-comment">// define attribut default PANELallocatorPnl</span>
</span>
<span class="line" id="L3283">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> AtrPanel : dds.ZONATRB = .{</span>
<span class="line" id="L3284">      .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.styleDim),</span>
<span class="line" id="L3285">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L3286">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L3287">                    <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L3288">      .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L3289">      .foregr = dds.ForegroundColor.fgWhite</span>
<span class="line" id="L3290">  };</span>
<span class="line" id="L3291"></span>
<span class="line" id="L3292"></span>
<span class="line" id="L3293">  <span class="tok-kw">pub</span> <span class="tok-kw">var</span> MsgErr : dds.ZONATRB = .{</span>
<span class="line" id="L3294">        .styled=[_]<span class="tok-type">u32</span>{<span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L3295">                      <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L3296">                      <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle),</span>
<span class="line" id="L3297">                      <span class="tok-builtin">@intFromEnum</span>(dds.Style.notStyle)},</span>
<span class="line" id="L3298">        .backgr = dds.BackgroundColor.bgBlack,</span>
<span class="line" id="L3299">        .foregr = dds.ForegroundColor.fgRed</span>
<span class="line" id="L3300">    };</span>
<span class="line" id="L3301"></span>
<span class="line" id="L3302"></span>
<span class="line" id="L3303"></span>
<span class="line" id="L3304"></span>
<span class="line" id="L3305"></span>
<span class="line" id="L3306">  <span class="tok-comment">/// define PANEL</span></span>
<span class="line" id="L3307">  <span class="tok-kw">pub</span> <span class="tok-kw">const</span> PANEL = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L3308">    name:   [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L3309">    posx:   <span class="tok-type">usize</span>,</span>
<span class="line" id="L3310">    posy:   <span class="tok-type">usize</span>,</span>
<span class="line" id="L3311"></span>
<span class="line" id="L3312">    lines:  <span class="tok-type">usize</span>,</span>
<span class="line" id="L3313">    cols:   <span class="tok-type">usize</span>,</span>
<span class="line" id="L3314"></span>
<span class="line" id="L3315">    attribut: dds.ZONATRB,</span>
<span class="line" id="L3316"></span>
<span class="line" id="L3317">    frame: frm.FRAME ,</span>
<span class="line" id="L3318"></span>
<span class="line" id="L3319">    label: std.ArrayList(lbl.LABEL),</span>
<span class="line" id="L3320"></span>
<span class="line" id="L3321">    button: std.ArrayList(btn.BUTTON),</span>
<span class="line" id="L3322"></span>
<span class="line" id="L3323">    menu: std.ArrayList(mnu.MENU),</span>
<span class="line" id="L3324"></span>
<span class="line" id="L3325">    field: std.ArrayList(fld.FIELD),</span>
<span class="line" id="L3326"></span>
<span class="line" id="L3327">    linev: std.ArrayList(lnv.LINE),</span>
<span class="line" id="L3328"></span>
<span class="line" id="L3329">    lineh: std.ArrayList(lnh.LINE),</span>
<span class="line" id="L3330"></span>
<span class="line" id="L3331">    <span class="tok-comment">// double buffer screen</span>
</span>
<span class="line" id="L3332">    buf:std.ArrayList(TERMINAL_CHAR),</span>
<span class="line" id="L3333"></span>
<span class="line" id="L3334">    idxfld: <span class="tok-type">usize</span>,</span>
<span class="line" id="L3335"></span>
<span class="line" id="L3336">    key   : kbd ,     <span class="tok-comment">// Func task</span>
</span>
<span class="line" id="L3337"></span>
<span class="line" id="L3338">    keyField : kbd ,  <span class="tok-comment">// enter up down</span>
</span>
<span class="line" id="L3339"></span>
<span class="line" id="L3340">    actif: <span class="tok-type">bool</span></span>
<span class="line" id="L3341">  };</span>
<span class="line" id="L3342"></span>
<span class="line" id="L3343"></span>
<span class="line" id="L3344">  <span class="tok-comment">// Init Panel for arrayList exemple Gencurs modlPanel</span>
</span>
<span class="line" id="L3345">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">initPanel</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L3346">                  vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L3347">                  vlines: <span class="tok-type">usize</span>,</span>
<span class="line" id="L3348">                  vcols: <span class="tok-type">usize</span>,</span>
<span class="line" id="L3349">                  vcadre : dds.CADRE,</span>
<span class="line" id="L3350">                  vtitle: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> ) PANEL {</span>
<span class="line" id="L3351"></span>
<span class="line" id="L3352">    <span class="tok-kw">var</span> xpanel = PANEL {</span>
<span class="line" id="L3353">          .name   = vname,</span>
<span class="line" id="L3354">          .posx   = vposx,</span>
<span class="line" id="L3355">          .posy   = vposy,</span>
<span class="line" id="L3356">          .lines  = vlines,</span>
<span class="line" id="L3357">          .cols   = vcols,</span>
<span class="line" id="L3358">          .attribut = AtrPanel,</span>
<span class="line" id="L3359">          .frame = <span class="tok-null">undefined</span>,</span>
<span class="line" id="L3360">          .label  = std.ArrayList(lbl.LABEL).init(dds.allocatorPnl),</span>
<span class="line" id="L3361">          .button = std.ArrayList(btn.BUTTON).init(dds.allocatorPnl),</span>
<span class="line" id="L3362">          .menu   = std.ArrayList(mnu.MENU).init(dds.allocatorPnl),</span>
<span class="line" id="L3363">          .field  = std.ArrayList(fld.FIELD).init(dds.allocatorPnl),</span>
<span class="line" id="L3364">          .linev  = std.ArrayList(lnv.LINE).init(dds.allocatorPnl),</span>
<span class="line" id="L3365">          .lineh  = std.ArrayList(lnh.LINE).init(dds.allocatorPnl),</span>
<span class="line" id="L3366">          .buf    = std.ArrayList(TERMINAL_CHAR).init(dds.allocatorPnl),</span>
<span class="line" id="L3367">          .idxfld = <span class="tok-number">9999</span>,</span>
<span class="line" id="L3368">          .key    =  kbd.none,</span>
<span class="line" id="L3369">          .keyField = kbd.none,</span>
<span class="line" id="L3370">          .actif  = <span class="tok-null">true</span>,</span>
<span class="line" id="L3371">    };</span>
<span class="line" id="L3372">    <span class="tok-comment">// INIT doublebuffer</span>
</span>
<span class="line" id="L3373">    <span class="tok-kw">var</span> i:<span class="tok-type">usize</span> = (xpanel.lines+<span class="tok-number">1</span>) * (xpanel.cols+<span class="tok-number">1</span>);</span>
<span class="line" id="L3374">    <span class="tok-kw">var</span> doublebuffer = TERMINAL_CHAR  { .ch =  <span class="tok-str">&quot; &quot;</span>,</span>
<span class="line" id="L3375">                                        .attribut = xpanel.attribut,</span>
<span class="line" id="L3376">                                        .on = <span class="tok-null">false</span>};</span>
<span class="line" id="L3377"></span>
<span class="line" id="L3378">    <span class="tok-comment">// init matrix</span>
</span>
<span class="line" id="L3379">    <span class="tok-kw">while</span> (<span class="tok-null">true</span>) {</span>
<span class="line" id="L3380">        <span class="tok-kw">if</span> (i == <span class="tok-number">0</span>) <span class="tok-kw">break</span> ;</span>
<span class="line" id="L3381">        xpanel.buf.append(doublebuffer) <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L3382">        i -=<span class="tok-number">1</span> ;</span>
<span class="line" id="L3383">    }</span>
<span class="line" id="L3384"></span>
<span class="line" id="L3385"></span>
<span class="line" id="L3386">    <span class="tok-comment">// init frame Panel</span>
</span>
<span class="line" id="L3387">    xpanel.frame = frm.newFrame(xpanel.name,</span>
<span class="line" id="L3388">                              <span class="tok-number">1</span> , <span class="tok-number">1</span>,  <span class="tok-comment">// border panel</span>
</span>
<span class="line" id="L3389">                              xpanel.lines, xpanel.cols,</span>
<span class="line" id="L3390">                              vcadre, frm.AtrFrame,</span>
<span class="line" id="L3391">                              vtitle, frm.AtrTitle );</span>
<span class="line" id="L3392"></span>
<span class="line" id="L3393">    <span class="tok-kw">return</span> xpanel;</span>
<span class="line" id="L3394"></span>
<span class="line" id="L3395">  }</span>
<span class="line" id="L3396"></span>
<span class="line" id="L3397"></span>
<span class="line" id="L3398">  <span class="tok-comment">// decl New Panel use programe style C commun allocator</span>
</span>
<span class="line" id="L3399">  <span class="tok-kw">pub</span>  <span class="tok-kw">fn</span> <span class="tok-fn">newPanelC</span>(vname: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L3400">                  vposx: <span class="tok-type">usize</span>, vposy: <span class="tok-type">usize</span>,</span>
<span class="line" id="L3401">                  vlines: <span class="tok-type">usize</span>,</span>
<span class="line" id="L3402">                  vcols: <span class="tok-type">usize</span>,</span>
<span class="line" id="L3403">                  vcadre : dds.CADRE,</span>
<span class="line" id="L3404">                  vtitle: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> ) *PANEL {</span>
<span class="line" id="L3405"></span>
<span class="line" id="L3406">    <span class="tok-kw">var</span> device = dds.allocatorPnl.create(PANEL) </span>
<span class="line" id="L3407">                  <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err)) ; };</span>
<span class="line" id="L3408"></span>
<span class="line" id="L3409">    device.name   = vname;</span>
<span class="line" id="L3410">    device.posx   = vposx;</span>
<span class="line" id="L3411">    device.posy   = vposy;</span>
<span class="line" id="L3412">    device.lines  = vlines;</span>
<span class="line" id="L3413">    device.cols   = vcols;</span>
<span class="line" id="L3414">    device.attribut = AtrPanel;</span>
<span class="line" id="L3415">    device.frame = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L3416">    device.label  = std.ArrayList(lbl.LABEL).init(dds.allocatorPnl);</span>
<span class="line" id="L3417">    device.button = std.ArrayList(btn.BUTTON).init(dds.allocatorPnl);</span>
<span class="line" id="L3418">    device.menu   = std.ArrayList(mnu.MENU).init(dds.allocatorPnl);</span>
<span class="line" id="L3419">    device.field  = std.ArrayList(fld.FIELD).init(dds.allocatorPnl);</span>
<span class="line" id="L3420">    device.linev  = std.ArrayList(lnv.LINE).init(dds.allocatorPnl);</span>
<span class="line" id="L3421">    device.lineh  = std.ArrayList(lnh.LINE).init(dds.allocatorPnl);</span>
<span class="line" id="L3422">    device.buf    = std.ArrayList(TERMINAL_CHAR).init(dds.allocatorPnl);</span>
<span class="line" id="L3423">    device.idxfld = <span class="tok-number">9999</span>;</span>
<span class="line" id="L3424">    device.key    =  kbd.none;</span>
<span class="line" id="L3425">    device.keyField = kbd.none;</span>
<span class="line" id="L3426">    device.actif  = <span class="tok-null">true</span>;</span>
<span class="line" id="L3427"></span>
<span class="line" id="L3428"></span>
<span class="line" id="L3429">    <span class="tok-comment">// INIT doublebuffer</span>
</span>
<span class="line" id="L3430">    <span class="tok-kw">var</span> i:<span class="tok-type">usize</span> = (device.lines+<span class="tok-number">1</span>) * (device.cols+<span class="tok-number">1</span>);</span>
<span class="line" id="L3431">    <span class="tok-kw">var</span> doublebuffer = TERMINAL_CHAR  { .ch =  <span class="tok-str">&quot; &quot;</span>,</span>
<span class="line" id="L3432">                                        .attribut = device.attribut,</span>
<span class="line" id="L3433">                                        .on = <span class="tok-null">false</span>};</span>
<span class="line" id="L3434"></span>
<span class="line" id="L3435">    <span class="tok-comment">// init matrix</span>
</span>
<span class="line" id="L3436">    <span class="tok-kw">while</span> (<span class="tok-null">true</span>) {</span>
<span class="line" id="L3437">        <span class="tok-kw">if</span> (i == <span class="tok-number">0</span>) <span class="tok-kw">break</span> ;</span>
<span class="line" id="L3438">        device.buf.append(doublebuffer) <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L3439">        i -=<span class="tok-number">1</span> ;</span>
<span class="line" id="L3440">    }</span>
<span class="line" id="L3441"></span>
<span class="line" id="L3442"></span>
<span class="line" id="L3443">    <span class="tok-comment">// init frame Panel</span>
</span>
<span class="line" id="L3444">    device.frame = frm.newFrame(device.name,</span>
<span class="line" id="L3445">                              <span class="tok-number">1</span> , <span class="tok-number">1</span>,  <span class="tok-comment">// border panel</span>
</span>
<span class="line" id="L3446">                              device.lines, device.cols,</span>
<span class="line" id="L3447">                              vcadre, frm.AtrFrame,</span>
<span class="line" id="L3448">                              vtitle, frm.AtrTitle );</span>
<span class="line" id="L3449"></span>
<span class="line" id="L3450">    <span class="tok-kw">return</span> device;</span>
<span class="line" id="L3451"></span>
<span class="line" id="L3452">  }</span>
<span class="line" id="L3453"></span>
<span class="line" id="L3454">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">initMatrix</span>(vpnl: *PANEL) <span class="tok-type">void</span> {</span>
<span class="line" id="L3455">    vpnl.buf.deinit();</span>
<span class="line" id="L3456">    vpnl.buf    = std.ArrayList(TERMINAL_CHAR).init(dds.allocatorPnl);</span>
<span class="line" id="L3457"></span>
<span class="line" id="L3458">        <span class="tok-comment">// INIT doublebuffer</span>
</span>
<span class="line" id="L3459">    <span class="tok-kw">var</span> i:<span class="tok-type">usize</span> = (vpnl.lines+<span class="tok-number">1</span>) * (vpnl.cols+<span class="tok-number">1</span>);</span>
<span class="line" id="L3460">    <span class="tok-kw">var</span> doublebuffer = TERMINAL_CHAR  { .ch =  <span class="tok-str">&quot; &quot;</span>,</span>
<span class="line" id="L3461">                                        .attribut = vpnl.attribut,</span>
<span class="line" id="L3462">                                        .on = <span class="tok-null">false</span>};</span>
<span class="line" id="L3463"></span>
<span class="line" id="L3464">    <span class="tok-comment">// init matrix</span>
</span>
<span class="line" id="L3465">    <span class="tok-kw">while</span> (<span class="tok-null">true</span>) {</span>
<span class="line" id="L3466">        <span class="tok-kw">if</span> (i == <span class="tok-number">0</span>) <span class="tok-kw">break</span> ;</span>
<span class="line" id="L3467">        vpnl.buf.append(doublebuffer) <span class="tok-kw">catch</span> |err| { <span class="tok-builtin">@panic</span>(<span class="tok-builtin">@errorName</span>(err));};</span>
<span class="line" id="L3468">        i -=<span class="tok-number">1</span> ;</span>
<span class="line" id="L3469">    }</span>
<span class="line" id="L3470">  }</span>
<span class="line" id="L3471"></span>
<span class="line" id="L3472"></span>
<span class="line" id="L3473">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">freePanel</span>(vpnl: *PANEL) <span class="tok-type">void</span> {</span>
<span class="line" id="L3474">    vpnl.label.clearAndFree();</span>
<span class="line" id="L3475">    vpnl.button.clearAndFree();</span>
<span class="line" id="L3476">    vpnl.field.clearAndFree();</span>
<span class="line" id="L3477">    vpnl.menu.clearAndFree();</span>
<span class="line" id="L3478">    vpnl.lineh.clearAndFree();</span>
<span class="line" id="L3479">    vpnl.linev.clearAndFree();</span>
<span class="line" id="L3480">    vpnl.buf.clearAndFree();</span>
<span class="line" id="L3481">    vpnl.label.deinit();</span>
<span class="line" id="L3482">    vpnl.button.deinit();</span>
<span class="line" id="L3483">    vpnl.field.deinit();</span>
<span class="line" id="L3484">    vpnl.menu.deinit();</span>
<span class="line" id="L3485">    vpnl.lineh.deinit();</span>
<span class="line" id="L3486">    vpnl.linev.deinit();</span>
<span class="line" id="L3487">    vpnl.buf.deinit();</span>
<span class="line" id="L3488">  }</span>
<span class="line" id="L3489"></span>
<span class="line" id="L3490"></span>
<span class="line" id="L3491">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getName</span>(vpnl: *PANEL)  [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> {</span>
<span class="line" id="L3492">    <span class="tok-kw">return</span> vpnl.name;</span>
<span class="line" id="L3493">  }</span>
<span class="line" id="L3494">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getPosx</span>(vpnl: *PANEL) <span class="tok-type">usize</span> {</span>
<span class="line" id="L3495">    <span class="tok-kw">return</span> vpnl.posx;</span>
<span class="line" id="L3496">  }</span>
<span class="line" id="L3497">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getPosy</span>(vpnl: *PANEL) <span class="tok-type">usize</span> {</span>
<span class="line" id="L3498">    <span class="tok-kw">return</span> vpnl.posy;</span>
<span class="line" id="L3499">  }</span>
<span class="line" id="L3500">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getCols</span>(vpnl: *PANEL) <span class="tok-type">usize</span> {</span>
<span class="line" id="L3501">    <span class="tok-kw">return</span> vpnl.cols;</span>
<span class="line" id="L3502">  }</span>
<span class="line" id="L3503">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getLines</span>(vpnl: *PANEL) <span class="tok-type">usize</span> {</span>
<span class="line" id="L3504">    <span class="tok-kw">return</span> vpnl.lines;</span>
<span class="line" id="L3505">  }</span>
<span class="line" id="L3506">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getTitle</span>(vpnl: *PANEL)  [] <span class="tok-kw">const</span> <span class="tok-type">u8</span> {</span>
<span class="line" id="L3507">    <span class="tok-kw">return</span> vpnl.frame.title;</span>
<span class="line" id="L3508">  }</span>
<span class="line" id="L3509">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getIdxfld</span>(vpnl: *PANEL) <span class="tok-type">usize</span> {</span>
<span class="line" id="L3510">    <span class="tok-kw">return</span> vpnl.idxfld;</span>
<span class="line" id="L3511">  }</span>
<span class="line" id="L3512">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getActif</span>(vpnl: *PANEL) <span class="tok-type">bool</span> {</span>
<span class="line" id="L3513">    <span class="tok-kw">return</span> vpnl.actif;</span>
<span class="line" id="L3514">  }</span>
<span class="line" id="L3515"></span>
<span class="line" id="L3516">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setIdxfld</span>(vpnl: *PANEL , n :<span class="tok-type">usize</span>) <span class="tok-type">void</span> {</span>
<span class="line" id="L3517">    vpnl.idxfld = n ;</span>
<span class="line" id="L3518">  }</span>
<span class="line" id="L3519">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setActif</span>(vpnl: *PANEL , b :<span class="tok-type">bool</span>) <span class="tok-type">void</span> {</span>
<span class="line" id="L3520">    vpnl.items.actif = b ;</span>
<span class="line" id="L3521">  }</span>
<span class="line" id="L3522"></span>
<span class="line" id="L3523"></span>
<span class="line" id="L3524">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">displayPanel</span>(vpnl: *PANEL)  <span class="tok-type">void</span> {</span>
<span class="line" id="L3525">    <span class="tok-comment">// display matrice PANEL</span>
</span>
<span class="line" id="L3526">    <span class="tok-kw">if</span> (vpnl.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span> ;</span>
<span class="line" id="L3527">      <span class="tok-kw">var</span> x :<span class="tok-type">usize</span> = <span class="tok-number">1</span>;</span>
<span class="line" id="L3528">      <span class="tok-kw">var</span> y :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L3529">      <span class="tok-kw">var</span> n :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L3530"></span>
<span class="line" id="L3531">      <span class="tok-kw">while</span> (x &lt;= vpnl.lines) : (x += <span class="tok-number">1</span>) {</span>
<span class="line" id="L3532">        y = <span class="tok-number">1</span>;</span>
<span class="line" id="L3533">        <span class="tok-kw">while</span> (y &lt;= vpnl.cols) : (y += <span class="tok-number">1</span>) {</span>
<span class="line" id="L3534">          term.gotoXY(x + vpnl.posx - <span class="tok-number">1</span>  , y + vpnl.posy - <span class="tok-number">1</span> );</span>
<span class="line" id="L3535">          term.writeStyled(vpnl.buf.items[n].ch,vpnl.buf.items[n].attribut);</span>
<span class="line" id="L3536">          n += <span class="tok-number">1</span>;</span>
<span class="line" id="L3537">        }</span>
<span class="line" id="L3538">      }</span>
<span class="line" id="L3539">  }</span>
<span class="line" id="L3540"></span>
<span class="line" id="L3541"></span>
<span class="line" id="L3542">  <span class="tok-comment">// clear matrix</span>
</span>
<span class="line" id="L3543">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">clsPanel</span>( vpnl : *PANEL) <span class="tok-type">void</span> {</span>
<span class="line" id="L3544">    <span class="tok-kw">var</span> x :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L3545">    <span class="tok-kw">var</span> y :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L3546">    <span class="tok-kw">var</span> n :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L3547"></span>
<span class="line" id="L3548">    <span class="tok-kw">while</span> (x &lt; vpnl.lines) : (x += <span class="tok-number">1</span>) {</span>
<span class="line" id="L3549">        y = <span class="tok-number">1</span>;</span>
<span class="line" id="L3550">        <span class="tok-kw">while</span> (y &lt;= vpnl.cols) : (y += <span class="tok-number">1</span>) {</span>
<span class="line" id="L3551">          vpnl.buf.items[n].ch = <span class="tok-str">&quot; &quot;</span>;</span>
<span class="line" id="L3552">          vpnl.buf.items[n].attribut  = vpnl.attribut;</span>
<span class="line" id="L3553">          vpnl.buf.items[n].on = <span class="tok-null">false</span>;</span>
<span class="line" id="L3554">          n += <span class="tok-number">1</span>;</span>
<span class="line" id="L3555">        }</span>
<span class="line" id="L3556">      }</span>
<span class="line" id="L3557">    displayPanel(vpnl);</span>
<span class="line" id="L3558">  }</span>
<span class="line" id="L3559">  </span>
<span class="line" id="L3560">  <span class="tok-comment">// clear Panel</span>
</span>
<span class="line" id="L3561">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">clearPanel</span>( vpnl : *PANEL) <span class="tok-type">void</span> {</span>
<span class="line" id="L3562"></span>
<span class="line" id="L3563">    vpnl.idxfld =<span class="tok-number">9999</span>;</span>
<span class="line" id="L3564"></span>
<span class="line" id="L3565">    vpnl.keyField =kbd.none;</span>
<span class="line" id="L3566"></span>
<span class="line" id="L3567">    <span class="tok-kw">for</span> (vpnl.field.items, <span class="tok-number">0</span>..) |_, idx| {</span>
<span class="line" id="L3568">      vpnl.field.items[idx].text =<span class="tok-str">&quot; &quot;</span>;</span>
<span class="line" id="L3569">      vpnl.field.items[idx].zwitch =<span class="tok-null">false</span>;</span>
<span class="line" id="L3570"></span>
<span class="line" id="L3571">    }</span>
<span class="line" id="L3572">  }</span>
<span class="line" id="L3573">  <span class="tok-comment">// restor -panel  MATRIX to terminal ---&gt; arraylist panel</span>
</span>
<span class="line" id="L3574">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">rstPanel</span>( vsrc : *PANEL , vdst : *PANEL) <span class="tok-type">void</span> {</span>
<span class="line" id="L3575">    <span class="tok-kw">if</span> (vdst.actif == <span class="tok-null">false</span>)  <span class="tok-kw">return</span> ;</span>
<span class="line" id="L3576">    <span class="tok-kw">if</span> (vsrc.posx + vsrc.lines &gt; vdst.posx + vdst.lines  )  <span class="tok-kw">return</span> ;</span>
<span class="line" id="L3577">    <span class="tok-kw">if</span> (vsrc.posy + vsrc.cols  &gt; vdst.posy + vdst.cols  )  <span class="tok-kw">return</span> ;</span>
<span class="line" id="L3578">    <span class="tok-kw">var</span> x :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L3579">    <span class="tok-kw">var</span> y :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L3580">    <span class="tok-kw">var</span> n :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L3581">    <span class="tok-kw">var</span> npos : <span class="tok-type">usize</span> =  vdst.posx - vsrc.posx;</span>
<span class="line" id="L3582">    </span>
<span class="line" id="L3583">    <span class="tok-kw">while</span> (x &lt; vsrc.lines) : (x += <span class="tok-number">1</span>) {</span>
<span class="line" id="L3584">        n = (vdst.cols * npos) + (vdst.posy - vsrc.posy) ;</span>
<span class="line" id="L3585">        y = <span class="tok-number">0</span>;</span>
<span class="line" id="L3586">        <span class="tok-kw">while</span> (y &lt; vsrc.cols) : (y += <span class="tok-number">1</span>) {</span>
<span class="line" id="L3587">          term.gotoXY(x + vsrc.posx   , (y + vsrc.posy) );</span>
<span class="line" id="L3588">          term.writeStyled(vdst.buf.items[n].ch,vdst.buf.items[n].attribut);</span>
<span class="line" id="L3589">          n += <span class="tok-number">1</span>;</span>
<span class="line" id="L3590">        }</span>
<span class="line" id="L3591">      npos += <span class="tok-number">1</span>;</span>
<span class="line" id="L3592">    }</span>
<span class="line" id="L3593">  }</span>
<span class="line" id="L3594"></span>
<span class="line" id="L3595">  <span class="tok-comment">/// print PANEL</span></span>
<span class="line" id="L3596">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">printPanel</span>  (vpnl: *PANEL) <span class="tok-type">void</span> {</span>
<span class="line" id="L3597">    <span class="tok-kw">if</span> ( vpnl.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span>; </span>
<span class="line" id="L3598"></span>
<span class="line" id="L3599">    <span class="tok-comment">// assigne PANEL and all OBJECT to matrix for display</span>
</span>
<span class="line" id="L3600"></span>
<span class="line" id="L3601">    <span class="tok-comment">// cursor HIDE par défault</span>
</span>
<span class="line" id="L3602">    term.cursHide();</span>
<span class="line" id="L3603"></span>
<span class="line" id="L3604">    <span class="tok-comment">// clear matrix</span>
</span>
<span class="line" id="L3605">    clsPanel(vpnl);</span>
<span class="line" id="L3606"></span>
<span class="line" id="L3607">    <span class="tok-comment">// FRAME (window panel)</span>
</span>
<span class="line" id="L3608">    frm.printFrame(vpnl,vpnl.frame);</span>
<span class="line" id="L3609"></span>
<span class="line" id="L3610">    <span class="tok-comment">// LABEL</span>
</span>
<span class="line" id="L3611">    <span class="tok-kw">for</span> (vpnl.label.items) |lblprt| {</span>
<span class="line" id="L3612">      <span class="tok-kw">if</span> (lblprt.actif) lbl.printLabel(vpnl, lblprt);</span>
<span class="line" id="L3613">    }</span>
<span class="line" id="L3614"></span>
<span class="line" id="L3615">    <span class="tok-comment">// FIELD</span>
</span>
<span class="line" id="L3616">    <span class="tok-kw">for</span> (vpnl.field.items) |fldprt| {</span>
<span class="line" id="L3617">      <span class="tok-kw">if</span> (fldprt.actif) fld.printField(vpnl, fldprt);</span>
<span class="line" id="L3618">    }</span>
<span class="line" id="L3619"></span>
<span class="line" id="L3620">    <span class="tok-comment">// BUTTON</span>
</span>
<span class="line" id="L3621">    <span class="tok-kw">if</span> (vpnl.button.items.len &gt; <span class="tok-number">0</span>) {</span>
<span class="line" id="L3622"></span>
<span class="line" id="L3623">      btn.printButton(vpnl);</span>
<span class="line" id="L3624">    }</span>
<span class="line" id="L3625">    </span>
<span class="line" id="L3626">    <span class="tok-comment">// LINE Vertical</span>
</span>
<span class="line" id="L3627">    <span class="tok-kw">for</span> (vpnl.linev.items) |lnvprt| {</span>
<span class="line" id="L3628">      <span class="tok-kw">if</span> (lnvprt.actif) lnv.printLine(vpnl, lnvprt);</span>
<span class="line" id="L3629">    }</span>
<span class="line" id="L3630">        </span>
<span class="line" id="L3631">    <span class="tok-comment">// LINE Horizontal</span>
</span>
<span class="line" id="L3632">    <span class="tok-kw">for</span> (vpnl.lineh.items) |lnhprt| {</span>
<span class="line" id="L3633">      <span class="tok-kw">if</span> (lnhprt.actif) lnh.printLine(vpnl, lnhprt);</span>
<span class="line" id="L3634">    }</span>
<span class="line" id="L3635"></span>
<span class="line" id="L3636"></span>
<span class="line" id="L3637"></span>
<span class="line" id="L3638">    displayPanel(vpnl);</span>
<span class="line" id="L3639">  }</span>
<span class="line" id="L3640"></span>
<span class="line" id="L3641">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">msgErr</span>(vpnl: *PANEL, info: [] <span class="tok-kw">const</span> <span class="tok-type">u8</span>) <span class="tok-type">void</span> {</span>
<span class="line" id="L3642"></span>
<span class="line" id="L3643">    <span class="tok-kw">var</span> x: <span class="tok-type">usize</span>  = vpnl.lines;</span>
<span class="line" id="L3644">    <span class="tok-kw">var</span> n: <span class="tok-type">usize</span>  = vpnl.cols * (x - <span class="tok-number">2</span>) ;</span>
<span class="line" id="L3645">    <span class="tok-kw">var</span> y: <span class="tok-type">usize</span>  = <span class="tok-number">1</span> ;</span>
<span class="line" id="L3646"></span>
<span class="line" id="L3647"></span>
<span class="line" id="L3648">    <span class="tok-kw">var</span> msgerr:[]<span class="tok-kw">const</span> <span class="tok-type">u8</span> = utl.concatStr(<span class="tok-str">&quot;Info : &quot;</span>, info);</span>
<span class="line" id="L3649"></span>
<span class="line" id="L3650">    <span class="tok-kw">if</span> (vpnl.cols &lt; (msgerr.len) )  msgerr = subStr(vpnl, msgerr, <span class="tok-number">0</span>, vpnl.cols - <span class="tok-number">2</span>) ;</span>
<span class="line" id="L3651"></span>
<span class="line" id="L3652"></span>
<span class="line" id="L3653">    <span class="tok-kw">while</span> (y &lt;= (vpnl.cols - <span class="tok-number">2</span>) ) : (y += <span class="tok-number">1</span>) {</span>
<span class="line" id="L3654">      term.gotoXY(vpnl.posx + x  - <span class="tok-number">2</span>  , y + vpnl.posy  );</span>
<span class="line" id="L3655">      term.writeStyled(<span class="tok-str">&quot; &quot;</span>,vpnl.attribut);</span>
<span class="line" id="L3656">    }</span>
<span class="line" id="L3657">    y = <span class="tok-number">1</span> ;</span>
<span class="line" id="L3658">    term.gotoXY(vpnl.posx + x  - <span class="tok-number">2</span> , y + vpnl.posy   );</span>
<span class="line" id="L3659">    term.writeStyled(msgerr,MsgErr);</span>
<span class="line" id="L3660"></span>
<span class="line" id="L3661">    <span class="tok-kw">while</span> (<span class="tok-null">true</span>) {</span>
<span class="line" id="L3662">      <span class="tok-kw">var</span> e_key = kbd.getKEY();</span>
<span class="line" id="L3663">      <span class="tok-kw">switch</span> ( e_key.Key ) {</span>
<span class="line" id="L3664">        .esc =&gt; <span class="tok-kw">break</span>,</span>
<span class="line" id="L3665">      <span class="tok-kw">else</span> =&gt;  {},</span>
<span class="line" id="L3666">      }</span>
<span class="line" id="L3667">    }</span>
<span class="line" id="L3668"></span>
<span class="line" id="L3669"></span>
<span class="line" id="L3670">    <span class="tok-kw">while</span> (y &lt;= (vpnl.cols - <span class="tok-number">2</span>)) : (y += <span class="tok-number">1</span>) {</span>
<span class="line" id="L3671">      n += <span class="tok-number">1</span>;</span>
<span class="line" id="L3672">      term.gotoXY(vpnl.posx + x  - <span class="tok-number">2</span>, y + vpnl.posy  );</span>
<span class="line" id="L3673">      term.writeStyled(vpnl.buf.items[n].ch,vpnl.buf.items[n].attribut);</span>
<span class="line" id="L3674">    }</span>
<span class="line" id="L3675">    </span>
<span class="line" id="L3676">  }</span>
<span class="line" id="L3677"></span>
<span class="line" id="L3678">  <span class="tok-comment">/// Check if it is a KEY function</span></span>
<span class="line" id="L3679">  <span class="tok-kw">fn</span> <span class="tok-fn">isPanelKey</span>(vpnl:  *PANEL, e_key: kbd) <span class="tok-type">bool</span> {</span>
<span class="line" id="L3680">    <span class="tok-kw">for</span> ( vpnl.button.items) |xbtn| {</span>
<span class="line" id="L3681">    <span class="tok-kw">if</span> (xbtn.key == e_key ) <span class="tok-kw">return</span> <span class="tok-null">true</span>;</span>
<span class="line" id="L3682">    }</span>
<span class="line" id="L3683">    <span class="tok-kw">return</span> <span class="tok-null">false</span>;</span>
<span class="line" id="L3684">  }</span>
<span class="line" id="L3685"></span>
<span class="line" id="L3686">  <span class="tok-comment">/// if it is a KEY function Check</span></span>
<span class="line" id="L3687">  <span class="tok-kw">fn</span> <span class="tok-fn">isPanelCtrl</span>( vpnl: *PANEL, e_key: kbd)  <span class="tok-type">bool</span> {</span>
<span class="line" id="L3688">    <span class="tok-kw">for</span> ( vpnl.button.items) |xbtn| {</span>
<span class="line" id="L3689">    <span class="tok-kw">if</span> ( xbtn.check <span class="tok-kw">and</span> xbtn.key == e_key ) <span class="tok-kw">return</span> <span class="tok-null">true</span>;</span>
<span class="line" id="L3690">    }</span>
<span class="line" id="L3691">    <span class="tok-kw">return</span> <span class="tok-null">false</span>;</span>
<span class="line" id="L3692">  }</span>
<span class="line" id="L3693"></span>
<span class="line" id="L3694">  <span class="tok-comment">///search there available field</span></span>
<span class="line" id="L3695">  <span class="tok-kw">fn</span> <span class="tok-fn">isNextIO</span>(vpnl: *PANEL, idx : <span class="tok-type">usize</span> ) <span class="tok-type">usize</span> {</span>
<span class="line" id="L3696">    <span class="tok-kw">var</span> i : <span class="tok-type">usize</span> = idx + <span class="tok-number">1</span>;</span>
<span class="line" id="L3697">    <span class="tok-kw">while</span> ( i &lt; vpnl.field.items.len) : (i += <span class="tok-number">1</span>) {</span>
<span class="line" id="L3698">      <span class="tok-kw">if</span> (vpnl.field.items[i].actif)</span>
<span class="line" id="L3699">        <span class="tok-kw">if</span> (!vpnl.field.items[i].protect ) <span class="tok-kw">break</span> ;</span>
<span class="line" id="L3700">    }</span>
<span class="line" id="L3701">    <span class="tok-kw">return</span> i;</span>
<span class="line" id="L3702">  }</span>
<span class="line" id="L3703"></span>
<span class="line" id="L3704">  <span class="tok-comment">///search there available field</span></span>
<span class="line" id="L3705">  <span class="tok-kw">fn</span> <span class="tok-fn">isPriorIO</span>(vpnl: *PANEL, idx : <span class="tok-type">usize</span>) <span class="tok-type">usize</span> {</span>
<span class="line" id="L3706">    <span class="tok-kw">var</span> i : <span class="tok-type">usize</span> = idx - <span class="tok-number">1</span>;</span>
<span class="line" id="L3707">    <span class="tok-kw">if</span> ( i &lt; <span class="tok-number">0</span>) i = <span class="tok-number">0</span>;</span>
<span class="line" id="L3708">    <span class="tok-kw">while</span> ( i &gt; <span class="tok-number">0</span> ) : (i -= <span class="tok-number">1</span>) {</span>
<span class="line" id="L3709">      <span class="tok-kw">if</span> (vpnl.field.items[i].actif)</span>
<span class="line" id="L3710">        <span class="tok-kw">if</span> (!vpnl.field.items[i].protect ) <span class="tok-kw">break</span> ;</span>
<span class="line" id="L3711">    }</span>
<span class="line" id="L3712">    <span class="tok-kw">return</span> i;</span>
<span class="line" id="L3713">  }</span>
<span class="line" id="L3714"></span>
<span class="line" id="L3715"></span>
<span class="line" id="L3716">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">isValide</span>(vpnl: *PANEL) <span class="tok-type">bool</span> {</span>
<span class="line" id="L3717">    <span class="tok-kw">if</span> (vpnl.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span>  <span class="tok-null">false</span> ;</span>
<span class="line" id="L3718"></span>
<span class="line" id="L3719"></span>
<span class="line" id="L3720">    <span class="tok-kw">for</span> (vpnl.field.items, <span class="tok-number">0</span>..) |f, idx| {</span>
<span class="line" id="L3721">      <span class="tok-kw">if</span> ( !f.protect <span class="tok-kw">and</span> f.actif) {</span>
<span class="line" id="L3722">        <span class="tok-comment">//check requier and field.len &gt; 0</span>
</span>
<span class="line" id="L3723">        <span class="tok-kw">if</span> (f.requier <span class="tok-kw">and</span> utl.trimStr(f.text).len == <span class="tok-number">0</span> ) {</span>
<span class="line" id="L3724">            vpnl.idxfld = idx;</span>
<span class="line" id="L3725">            <span class="tok-kw">return</span> <span class="tok-null">false</span>;</span>
<span class="line" id="L3726">        }</span>
<span class="line" id="L3727">        <span class="tok-comment">//check requier and field.len &gt; 0 and regexLen &gt; 0 execute regex</span>
</span>
<span class="line" id="L3728">        <span class="tok-kw">if</span> ( f.regex.len &gt; <span class="tok-number">0</span> <span class="tok-kw">and</span> f.requier <span class="tok-kw">and</span> utl.trimStr(f.text).len &gt; <span class="tok-number">0</span>) {</span>
<span class="line" id="L3729">            <span class="tok-kw">if</span> ( !reg.isMatch(utl.trimStr(f.text) ,f.regex)) {</span>
<span class="line" id="L3730">              vpnl.idxfld = idx;</span>
<span class="line" id="L3731">              <span class="tok-kw">return</span> <span class="tok-null">false</span>;</span>
<span class="line" id="L3732">            }</span>
<span class="line" id="L3733">        }</span>
<span class="line" id="L3734">        <span class="tok-comment">// function call proctask            </span>
</span>
<span class="line" id="L3735">      }</span>
<span class="line" id="L3736">    }</span>
<span class="line" id="L3737">    vpnl.idxfld = <span class="tok-number">0</span>;</span>
<span class="line" id="L3738">    <span class="tok-kw">return</span> <span class="tok-null">true</span>;</span>
<span class="line" id="L3739"></span>
<span class="line" id="L3740">  }</span>
<span class="line" id="L3741"></span>
<span class="line" id="L3742">  <span class="tok-comment">///------------------------------------------------------</span></span>
<span class="line" id="L3743">  <span class="tok-comment">/// Format management including zones</span></span>
<span class="line" id="L3744">  <span class="tok-comment">/// idxfld == 9999 print panel else position field</span></span>
<span class="line" id="L3745">  <span class="tok-comment">/// keyboard proction keys are returned to the calling procedure</span></span>
<span class="line" id="L3746">  <span class="tok-comment">///</span></span>
<span class="line" id="L3747">  <span class="tok-comment">/// only the key CtrlH = Aide / Help for field</span></span>
<span class="line" id="L3748">  <span class="tok-comment">///</span></span>
<span class="line" id="L3749">  <span class="tok-comment">/// Reserved keys for FIELD management</span></span>
<span class="line" id="L3750">  <span class="tok-comment">/// traditionally  UP, DOWN, TAB, STAB, CtrlA,</span></span>
<span class="line" id="L3751">  <span class="tok-comment">/// ENTER, HOME, END, RIGTH, LEFt, BACKSPACE, DELETE, INSERT</span></span>
<span class="line" id="L3752">  <span class="tok-comment">/// FUNC Triggered by ioField function</span></span>
<span class="line" id="L3753">  <span class="tok-comment">/// predefined and customizable REGEX control</span></span>
<span class="line" id="L3754">  <span class="tok-comment">/// CALL to be planned in the future with  call execve job</span></span>
<span class="line" id="L3755">  <span class="tok-comment">/// ATTN to be planned in the future with thread job</span></span>
<span class="line" id="L3756">  <span class="tok-comment">///------------------------------------------------------</span></span>
<span class="line" id="L3757">  <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">ioPanel</span>(vpnl: *PANEL) kbd {</span>
<span class="line" id="L3758">    <span class="tok-kw">if</span> (vpnl.actif == <span class="tok-null">false</span> ) <span class="tok-kw">return</span>  kbd.none;</span>
<span class="line" id="L3759"></span>
<span class="line" id="L3760">    <span class="tok-kw">var</span> nField :<span class="tok-type">usize</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L3761">    <span class="tok-kw">var</span> fld_key : kbd =  kbd.enter;</span>
<span class="line" id="L3762">    <span class="tok-kw">var</span> nbrFieldIO : <span class="tok-type">usize</span> = vpnl.field.items.len;</span>
<span class="line" id="L3763"></span>
<span class="line" id="L3764"></span>
<span class="line" id="L3765">    <span class="tok-kw">if</span> ( vpnl.idxfld == <span class="tok-number">9999</span>) {</span>
<span class="line" id="L3766">        printPanel(vpnl); </span>
<span class="line" id="L3767">        nField = <span class="tok-number">0</span>;</span>
<span class="line" id="L3768">    } <span class="tok-kw">else</span> {</span>
<span class="line" id="L3769"></span>
<span class="line" id="L3770">      <span class="tok-kw">switch</span>(vpnl.key ) { </span>
<span class="line" id="L3771">        .func =&gt; nField = vpnl.idxfld,</span>
<span class="line" id="L3772">        .task =&gt; {</span>
<span class="line" id="L3773">              nField = vpnl.idxfld;</span>
<span class="line" id="L3774">              <span class="tok-kw">switch</span>(vpnl.keyField) {</span>
<span class="line" id="L3775">                .enter =&gt; {</span>
<span class="line" id="L3776">                  <span class="tok-kw">if</span> ( nField + <span class="tok-number">1</span> &gt; nbrFieldIO - <span class="tok-number">1</span> ) nField = <span class="tok-number">0</span></span>
<span class="line" id="L3777">                  <span class="tok-kw">else</span> nField= isNextIO(vpnl,nField);</span>
<span class="line" id="L3778">                  vpnl.idxfld = nField;</span>
<span class="line" id="L3779">                },</span>
<span class="line" id="L3780">                .up  =&gt; {</span>
<span class="line" id="L3781">                  <span class="tok-kw">if</span> (nField == <span class="tok-number">0</span>) nField = nbrFieldIO - <span class="tok-number">1</span></span>
<span class="line" id="L3782">                  <span class="tok-kw">else</span> nField= isPriorIO(vpnl,nField);</span>
<span class="line" id="L3783">                  vpnl.idxfld = nField;</span>
<span class="line" id="L3784">                },</span>
<span class="line" id="L3785">                .down  =&gt; {</span>
<span class="line" id="L3786">                  <span class="tok-kw">if</span> (nField  + <span class="tok-number">1</span> &gt; nbrFieldIO - <span class="tok-number">1</span>) nField = <span class="tok-number">0</span></span>
<span class="line" id="L3787">                  <span class="tok-kw">else</span> nField= isNextIO(vpnl,nField);</span>
<span class="line" id="L3788">                  vpnl.idxfld = nField;</span>
<span class="line" id="L3789">                },</span>
<span class="line" id="L3790">                <span class="tok-kw">else</span> =&gt; nField = vpnl.idxfld,</span>
<span class="line" id="L3791">              }</span>
<span class="line" id="L3792">            },</span>
<span class="line" id="L3793">        <span class="tok-kw">else</span> =&gt; nField = vpnl.idxfld,    </span>
<span class="line" id="L3794">      }</span>
<span class="line" id="L3795">    }</span>
<span class="line" id="L3796"></span>
<span class="line" id="L3797">    vpnl.keyField = kbd.none; </span>
<span class="line" id="L3798">    </span>
<span class="line" id="L3799"></span>
<span class="line" id="L3800">    <span class="tok-kw">while</span> (<span class="tok-null">true</span>) {</span>
<span class="line" id="L3801"></span>
<span class="line" id="L3802">      <span class="tok-kw">if</span> (nbrFieldIO == <span class="tok-number">0</span>)  {</span>
<span class="line" id="L3803">        <span class="tok-kw">var</span> vKey= kbd.getKEY();</span>
<span class="line" id="L3804"></span>
<span class="line" id="L3805">        <span class="tok-kw">if</span> (isPanelKey(vpnl,vKey.Key)) {</span>
<span class="line" id="L3806">          vpnl.idxfld = <span class="tok-number">9999</span>;</span>
<span class="line" id="L3807">          <span class="tok-kw">return</span> vKey.Key;</span>
<span class="line" id="L3808">        }</span>
<span class="line" id="L3809">        <span class="tok-kw">continue</span> ;</span>
<span class="line" id="L3810">      }</span>
<span class="line" id="L3811">      <span class="tok-kw">else</span> </span>
<span class="line" id="L3812">        <span class="tok-kw">if</span> ( !vpnl.field.items[nField ].protect <span class="tok-kw">and</span> vpnl.field.items[nField ].actif) {</span>
<span class="line" id="L3813"></span>
<span class="line" id="L3814">          fld.printField(vpnl,vpnl.field.items[nField ]);</span>
<span class="line" id="L3815">          fld.displayField(vpnl,vpnl.field.items[nField ]);</span>
<span class="line" id="L3816"></span>
<span class="line" id="L3817">          fld_key = fld.ioField(vpnl,vpnl.field.items[nField ]);</span>
<span class="line" id="L3818"></span>
<span class="line" id="L3819">          fld.printField(vpnl,vpnl.field.items[nField ]);</span>
<span class="line" id="L3820">          fld.displayField(vpnl,vpnl.field.items[nField ]);</span>
<span class="line" id="L3821">        </span>
<span class="line" id="L3822">          vpnl.key = kbd.none;</span>
<span class="line" id="L3823"></span>
<span class="line" id="L3824">          <span class="tok-comment">// function call procfunc            </span>
</span>
<span class="line" id="L3825">          <span class="tok-kw">if</span> (fld_key == kbd.func ) {</span>
<span class="line" id="L3826">            vpnl.idxfld = nField;</span>
<span class="line" id="L3827">            vpnl.key = kbd.func;</span>
<span class="line" id="L3828">            <span class="tok-kw">return</span> fld_key;</span>
<span class="line" id="L3829">          }</span>
<span class="line" id="L3830">          <span class="tok-comment">// function call proctask            </span>
</span>
<span class="line" id="L3831">          <span class="tok-kw">if</span> (fld_key == kbd.task) {</span>
<span class="line" id="L3832">            vpnl.idxfld = nField;</span>
<span class="line" id="L3833">            vpnl.key = kbd.task;</span>
<span class="line" id="L3834">            <span class="tok-kw">return</span> fld_key;</span>
<span class="line" id="L3835">          }</span>
<span class="line" id="L3836"></span>
<span class="line" id="L3837"></span>
<span class="line" id="L3838">          </span>
<span class="line" id="L3839"></span>
<span class="line" id="L3840">          </span>
<span class="line" id="L3841">          <span class="tok-comment">// control validity</span>
</span>
<span class="line" id="L3842">          <span class="tok-kw">if</span> (isPanelKey(vpnl,fld_key )) {</span>
<span class="line" id="L3843">            <span class="tok-kw">if</span> (!isPanelCtrl(vpnl,fld_key)){</span>
<span class="line" id="L3844">                vpnl.idxfld = nField ;</span>
<span class="line" id="L3845">                <span class="tok-kw">return</span> fld_key;</span>
<span class="line" id="L3846">              }</span>
<span class="line" id="L3847">            <span class="tok-kw">else</span> {</span>
<span class="line" id="L3848">              <span class="tok-kw">if</span> (isValide(vpnl)) {</span>
<span class="line" id="L3849">                <span class="tok-kw">return</span> fld_key;</span>
<span class="line" id="L3850">              }</span>
<span class="line" id="L3851">              <span class="tok-kw">else</span> { </span>
<span class="line" id="L3852">                msgErr(vpnl,<span class="tok-str">&quot;Format invalide&quot;</span>);</span>
<span class="line" id="L3853">                nField = vpnl.idxfld ;</span>
<span class="line" id="L3854">                fld_key = kbd.none ;</span>
<span class="line" id="L3855">              }</span>
<span class="line" id="L3856">            }</span>
<span class="line" id="L3857"></span>
<span class="line" id="L3858">          }</span>
<span class="line" id="L3859">        }</span>
<span class="line" id="L3860"></span>
<span class="line" id="L3861">      <span class="tok-kw">switch</span>(fld_key) {</span>
<span class="line" id="L3862">        .enter  =&gt; {</span>
<span class="line" id="L3863">          <span class="tok-kw">if</span> ( nField + <span class="tok-number">1</span> &gt; nbrFieldIO - <span class="tok-number">1</span> ) nField = <span class="tok-number">0</span></span>
<span class="line" id="L3864">          <span class="tok-kw">else</span> nField= isNextIO(vpnl,nField);</span>
<span class="line" id="L3865">          vpnl.idxfld = nField;</span>
<span class="line" id="L3866">        },</span>
<span class="line" id="L3867">        .up  =&gt; {</span>
<span class="line" id="L3868">          <span class="tok-kw">if</span> (nField == <span class="tok-number">0</span>) nField = nbrFieldIO - <span class="tok-number">1</span></span>
<span class="line" id="L3869">          <span class="tok-kw">else</span> nField= isPriorIO(vpnl,nField);</span>
<span class="line" id="L3870">          vpnl.idxfld = nField;</span>
<span class="line" id="L3871">        },</span>
<span class="line" id="L3872">        .down  =&gt; {</span>
<span class="line" id="L3873">          <span class="tok-kw">if</span> (nField  + <span class="tok-number">1</span> &gt; nbrFieldIO - <span class="tok-number">1</span>) nField = <span class="tok-number">0</span></span>
<span class="line" id="L3874">          <span class="tok-kw">else</span> nField= isNextIO(vpnl,nField);</span>
<span class="line" id="L3875">          vpnl.idxfld = nField;</span>
<span class="line" id="L3876">        },</span>
<span class="line" id="L3877">        <span class="tok-kw">else</span> =&gt; {}</span>
<span class="line" id="L3878"></span>
<span class="line" id="L3879">      }</span>
<span class="line" id="L3880">    }</span>
<span class="line" id="L3881">  }                  </span>
<span class="line" id="L3882"></span>
<span class="line" id="L3883">};</span>
<span class="line" id="L3884"></span>
</code></pre></body>
</html>